"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const atom_1 = require("atom");
const etch = require("etch");
const utils_1 = require("../utils");
class ParamControl {
    constructor(props) {
        this.props = props;
        this.tooltipTitle = () => {
            const displayName = this.props.spec.displayName !== undefined
                ? this.props.spec.displayName
                : 'Undefined name';
            if (this.hiddenValue) {
                return `${displayName}: ${this.props.spec.displayTemplate(this.value)}`;
            }
            else {
                return displayName;
            }
        };
        this.disposables = new atom_1.CompositeDisposable();
        this.hiddenValue = atom.config.get('ide-haskell.hideParameterValues');
        this.initStore();
        this.initSpec();
        etch.initialize(this);
        this.disposables.add(atom.config.onDidChange('ide-haskell.hideParameterValues', ({ newValue }) => {
            this.hiddenValue = newValue;
            utils_1.handlePromise(this.update());
        }));
        this.disposables.add(atom.tooltips.add(this.element, { title: this.tooltipTitle }));
    }
    render() {
        const classList = [
            `ide-haskell--${this.props.pluginName}`,
            `ide-haskell-param--${this.props.name}`,
        ];
        if (this.hiddenValue) {
            classList.push('hidden-value');
        }
        return (etch.dom("ide-haskell-param", { class: classList.join(' '), on: { click: async () => this.setValue() } },
            etch.dom("ide-haskell-param-value", null, this.props.spec.displayTemplate(this.value))));
    }
    async update(props) {
        if (props) {
            const { pluginName, name, spec, store } = props;
            if (pluginName !== undefined) {
                this.props.pluginName = pluginName;
            }
            if (name !== undefined) {
                this.props.name = name;
            }
            if (spec && this.props.spec !== spec) {
                this.props.spec = spec;
                this.initSpec();
            }
            if (store && this.props.store !== store) {
                this.props.store = store;
                this.initStore();
            }
        }
        return etch.update(this);
    }
    async setValue(e) {
        await this.props.store.setValue(this.props.pluginName, this.props.name, e);
        utils_1.handlePromise(this.update());
    }
    async destroy() {
        await etch.destroy(this);
        this.disposables.dispose();
    }
    initStore() {
        if (this.storeDisposable) {
            this.disposables.remove(this.storeDisposable);
        }
        this.storeDisposable = this.props.store.onDidUpdate(this.props.pluginName, this.props.name, ({ value }) => {
            this.value = value;
            utils_1.handlePromise(this.update());
        });
        this.disposables.add(this.storeDisposable);
        utils_1.handlePromise(this.setValueInitial());
    }
    async setValueInitial() {
        this.value = await this.props.store.getValueRaw(this.props.pluginName, this.props.name);
        return this.update();
    }
    initSpec() {
        if (this.props.spec.displayName === undefined) {
            this.props.spec.displayName =
                this.props.name.charAt(0).toUpperCase() + this.props.name.slice(1);
        }
    }
}
exports.ParamControl = ParamControl;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyYW0tY29udHJvbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb25maWctcGFyYW1zL3BhcmFtLWNvbnRyb2wudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsK0JBQXNEO0FBQ3RELDZCQUE0QjtBQUk1QixvQ0FBd0M7QUFTeEMsTUFBYSxZQUFZO0lBTXZCLFlBQW1CLEtBQWdCO1FBQWhCLFVBQUssR0FBTCxLQUFLLENBQVc7UUE0RzNCLGlCQUFZLEdBQUcsR0FBVyxFQUFFO1lBQ2xDLE1BQU0sV0FBVyxHQUNmLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFdBQVcsS0FBSyxTQUFTO2dCQUN2QyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsV0FBVztnQkFDN0IsQ0FBQyxDQUFDLGdCQUFnQixDQUFBO1lBQ3RCLElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRTtnQkFDcEIsT0FBTyxHQUFHLFdBQVcsS0FBSyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUE7YUFDeEU7aUJBQU07Z0JBQ0wsT0FBTyxXQUFXLENBQUE7YUFDbkI7UUFDSCxDQUFDLENBQUE7UUFySEMsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLDBCQUFtQixFQUFFLENBQUE7UUFFNUMsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFBO1FBRXJFLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQTtRQUVoQixJQUFJLENBQUMsUUFBUSxFQUFFLENBQUE7UUFFZixJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFBO1FBRXJCLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUNsQixJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FDckIsaUNBQWlDLEVBQ2pDLENBQUMs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dGVEaXNwb3NhYmxlLCBEaXNwb3NhYmxlIH0gZnJvbSAnYXRvbSdcbmltcG9ydCAqIGFzIGV0Y2ggZnJvbSAnZXRjaCdcbmltcG9ydCAqIGFzIFVQSSBmcm9tICdhdG9tLWhhc2tlbGwtdXBpJ1xuXG5pbXBvcnQgeyBDb25maWdQYXJhbVN0b3JlIH0gZnJvbSAnLi9wYXJhbS1zdG9yZSdcbmltcG9ydCB7IGhhbmRsZVByb21pc2UgfSBmcm9tICcuLi91dGlscydcblxuZXhwb3J0IGludGVyZmFjZSBJUHJvcHM8VD4ge1xuICBwbHVnaW5OYW1lOiBzdHJpbmdcbiAgbmFtZTogc3RyaW5nXG4gIHNwZWM6IFVQSS5JUGFyYW1TcGVjPFQ+XG4gIHN0b3JlOiBDb25maWdQYXJhbVN0b3JlXG59XG5cbmV4cG9ydCBjbGFzcyBQYXJhbUNvbnRyb2w8VD4gaW1wbGVtZW50cyBVUEkuSUVsZW1lbnRPYmplY3Q8SVByb3BzPFQ+PiB7XG4gIHB1YmxpYyBlbGVtZW50ITogSFRNTEVsZW1lbnRcbiAgcHJpdmF0ZSBkaXNwb3NhYmxlczogQ29tcG9zaXRlRGlzcG9zYWJsZVxuICBwcml2YXRlIGhpZGRlblZhbHVlOiBib29sZWFuXG4gIHByaXZhdGUgdmFsdWU/OiBUXG4gIHByaXZhdGUgc3RvcmVEaXNwb3NhYmxlPzogRGlzcG9zYWJsZVxuICBjb25zdHJ1Y3RvcihwdWJsaWMgcHJvcHM6IElQcm9wczxUPikge1xuICAgIHRoaXMuZGlzcG9zYWJsZXMgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpXG5cbiAgICB0aGlzLmhpZGRlblZhbHVlID0gYXRvbS5jb25maWcuZ2V0KCdpZGUtaGFza2VsbC5oaWRlUGFyYW1ldGVyVmFsdWVzJylcblxuICAgIHRoaXMuaW5pdFN0b3JlKClcblxuICAgIHRoaXMuaW5pdFNwZWMoKVxuXG4gICAgZXRjaC5pbml0aWFsaXplKHRoaXMpXG5cbiAgICB0aGlzLmRpc3Bvc2FibGVzLmFkZChcbiAgICAgIGF0b20uY29uZmlnLm9uRGlkQ2hhbmdlKFxuICAgICAgICAnaWRlLWhhc2tlbGwuaGlkZVBhcmFtZXRlclZhbHVlcycsXG4gICAgICAgICh7IG5ld1ZhbHVlIH0pID0+IHtcbiAgICAgICAgICB0aGlzLmhpZGRlblZhbHVlID0gbmV3VmFsdWVcbiAgICAgICAgICBoYW5kbGVQcm9taXNlKHRoaXMudXBkYXRlKCkpXG4gICAgICAgIH0sXG4gICAgICApLFxuICAgIClcblxuICAgIHRoaXMuZGlzcG9zYWJsZXMuYWRkKFxuICAgICAgYXRvbS50b29sdGlwcy5hZGQodGhpcy5lbGVtZW50LCB7IHRpdGxlOiB0aGlzLnRvb2x0aXBUaXRsZSB9KSxcbiAgICApXG4gIH1cblxuICBwdWJsaWMgcmVuZGVyKCkge1xuICAgIGNvbnN0IGNsYXNzTGlzdCA9IFtcbiAgICAgIGBpZGUtaGFza2VsbC0tJHt0aGlzLnByb3BzLnBsdWdpbk5hbWV9YCxcbiAgICAgIGBpZGUtaGFza2VsbC1wYXJhbS0tJHt0aGlzLnByb3BzLm5hbWV9YCxcbiAgICBdXG4gICAgaWYgKHRoaXMuaGlkZGVuVmFsdWUpIHtcbiAgICAgIGNsYXNzTGlzdC5wdXNoKCdoaWRkZW4tdmFsdWUnKVxuICAgIH1cbiAgICByZXR1cm4gKFxuICAgICAgPGlkZS1oYXNrZWxsLXBhcmFtXG4gICAgICAgIGNsYXNzPXtjbGFzc0xpc3Quam9pbignICcpfVxuICAgICAgICBvbj17eyBjbGljazogYXN5bmMgKCkgPT4gdGhpcy5zZXRWYWx1ZSgpIH19XG4gICAgICA+XG4gICAgICAgIDxpZGUtaGFza2VsbC1wYXJhbS12YWx1ZT5cbiAgICAgICAgICB7dGhpcy5wcm9wcy5zcGVjLmRpc3BsYXlUZW1wbGF0ZSh0aGlzLnZhbHVlKX1cbiAgICAgICAgPC9pZGUtaGFza2VsbC1wYXJhbS12YWx1ZT5cbiAgICAgIDwvaWRlLWhhc2tlbGwtcGFyYW0+XG4gICAgKVxuICB9XG5cbiAgcHVibGljIGFzeW5jIHVwZGF0ZShwcm9wcz86IFBhcnRpYWw8SVByb3BzPFQ+Pikge1xuICAgIGlmIChwcm9wcykge1xuICAgICAgY29uc3QgeyBwbHVnaW5OYW1lLCBuYW1lLCBzcGVjLCBzdG9yZSB9ID0gcHJvcHNcbiAgICAgIGlmIChwbHVnaW5OYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5wbHVnaW5OYW1lID0gcGx1Z2luTmFtZVxuICAgICAgfVxuICAgICAgaWYgKG5hbWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLnByb3BzLm5hbWUgPSBuYW1lXG4gICAgICB9XG4gICAgICBpZiAoc3BlYyAmJiB0aGlzLnByb3BzLnNwZWMgIT09IHNwZWMpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5zcGVjID0gc3BlY1xuICAgICAgICB0aGlzLmluaXRTcGVjKClcbiAgICAgIH1cbiAgICAgIGlmIChzdG9yZSAmJiB0aGlzLnByb3BzLnN0b3JlICE9PSBzdG9yZSkge1xuICAgICAgICB0aGlzLnByb3BzLnN0b3JlID0gc3RvcmVcbiAgICAgICAgdGhpcy5pbml0U3RvcmUoKVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZXRjaC51cGRhdGUodGhpcylcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBzZXRWYWx1ZShlPzogVCkge1xuICAgIGF3YWl0IHRoaXMucHJvcHMuc3RvcmUuc2V0VmFsdWUodGhpcy5wcm9wcy5wbHVnaW5OYW1lLCB0aGlzLnByb3BzLm5hbWUsIGUpXG4gICAgaGFuZGxlUHJvbWlzZSh0aGlzLnVwZGF0ZSgpKVxuICB9XG5cbiAgcHVibGljIGFzeW5jIGRlc3Ryb3koKSB7XG4gICAgYXdhaXQgZXRjaC5kZXN0cm95KHRoaXMpXG4gICAgdGhpcy5kaXNwb3NhYmxlcy5kaXNwb3NlKClcbiAgfVxuXG4gIHByaXZhdGUgaW5pdFN0b3JlKCkge1xuICAgIGlmICh0aGlzLnN0b3JlRGlzcG9zYWJsZSkge1xuICAgICAgdGhpcy5kaXNwb3NhYmxlcy5yZW1vdmUodGhpcy5zdG9yZURpc3Bvc2FibGUpXG4gICAgfVxuICAgIHRoaXMuc3RvcmVEaXNwb3NhYmxlID0gdGhpcy5wcm9wcy5zdG9yZS5vbkRpZFVwZGF0ZTxUPihcbiAgICAgIHRoaXMucHJvcHMucGx1Z2luTmFtZSxcbiAgICAgIHRoaXMucHJvcHMubmFtZSxcbiAgICAgICh7IHZhbHVlIH0pID0+IHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlXG4gICAgICAgIGhhbmRsZVByb21pc2UodGhpcy51cGRhdGUoKSlcbiAgICAgIH0sXG4gICAgKVxuICAgIHRoaXMuZGlzcG9zYWJsZXMuYWRkKHRoaXMuc3RvcmVEaXNwb3NhYmxlKVxuICAgIGhhbmRsZVByb21pc2UodGhpcy5zZXRWYWx1ZUluaXRpYWwoKSlcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgc2V0VmFsdWVJbml0aWFsKCkge1xuICAgIHRoaXMudmFsdWUgPSBhd2FpdCB0aGlzLnByb3BzLnN0b3JlLmdldFZhbHVlUmF3PFQ+KFxuICAgICAgdGhpcy5wcm9wcy5wbHVnaW5OYW1lLFxuICAgICAgdGhpcy5wcm9wcy5uYW1lLFxuICAgIClcbiAgICByZXR1cm4gdGhpcy51cGRhdGUoKVxuICB9XG5cbiAgcHJpdmF0ZSBpbml0U3BlYygpIHtcbiAgICBpZiAodGhpcy5wcm9wcy5zcGVjLmRpc3BsYXlOYW1lID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMucHJvcHMuc3BlYy5kaXNwbGF5TmFtZSA9XG4gICAgICAgIHRoaXMucHJvcHMubmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHRoaXMucHJvcHMubmFtZS5zbGljZSgxKVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgdG9vbHRpcFRpdGxlID0gKCk6IHN0cmluZyA9PiB7XG4gICAgY29uc3QgZGlzcGxheU5hbWUgPVxuICAgICAgdGhpcy5wcm9wcy5zcGVjLmRpc3BsYXlOYW1lICE9PSB1bmRlZmluZWRcbiAgICAgICAgPyB0aGlzLnByb3BzLnNwZWMuZGlzcGxheU5hbWVcbiAgICAgICAgOiAnVW5kZWZpbmVkIG5hbWUnXG4gICAgaWYgKHRoaXMuaGlkZGVuVmFsdWUpIHtcbiAgICAgIHJldHVybiBgJHtkaXNwbGF5TmFtZX06ICR7dGhpcy5wcm9wcy5zcGVjLmRpc3BsYXlUZW1wbGF0ZSh0aGlzLnZhbHVlKX1gXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBkaXNwbGF5TmFtZVxuICAgIH1cbiAgfVxufVxuIl19