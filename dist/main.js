var e=require("child_process"),t=require("os"),r=(require("util"),require("events")),n=require("assert"),i=require("constants"),o=require("fs"),s=require("atom-haskell-utils"),a=require("path"),l=require("crypto"),u=require("atom");var c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};Object.defineProperty(exports,"__esModule",{value:!0});var p=function(e){atom.views.getView(atom.workspace).classList.add("ide-haskell"),bs().setScheduler(atom.views),dd=!1,atom.config.get("ide-haskell.startupMessageIdeBackend")&&setTimeout(()=>{dd||atom.notifications.addWarning("Ide-Haskell needs backends that provide most of functionality.\n            Please refer to README for details",{dismissable:!0})},5e3);ld=new sd,ud=new y.PluginManager(e,hd()),ld.add(atom.commands.add("atom-workspace",{"ide-haskell:toggle-output":()=>{ud&&ud.togglePanel()},"ide-haskell:next-error":()=>{ud&&ud.nextError()},"ide-haskell:prev-error":()=>{ud&&ud.prevError()}}),atom.commands.add("atom-text-editor.ide-haskell",{"ide-haskell:prettify-file":({currentTarget:e})=>{(0,E.handlePromise)((0,il.prettifyFile)(e.getModel()))}}),atom.commands.add("atom-text-editor.ide-haskell--has-tooltips",{"ide-haskell:close-tooltip":({currentTarget:e,abortKeyBinding:t})=>{const r=ud&&ud.controller(e.getModel());r&&r.tooltips.has()?r.tooltips.hide():t()}})),pd=new sd,pd.add(atom.menu.add([{label:E.MAIN_MENU_LABEL,submenu:[{label:"Prettify",command:"ide-haskell:prettify-file"},{label:"Toggle Panel",command:"ide-haskell:toggle-output"}]}]))};exports.activate=p;var d=function(){ud&&ud.deactivate();ld&&ld.dispose();pd&&pd.dispose();atom.menu.update(),ld=void 0,ud=void 0,pd=void 0,cd=void 0};exports.deactivate=d;var h=function(){if(ud)return ud.serialize();return};exports.serialize=h;var f=hd;exports.deserializeOutputPanel=f;var v=function(e){if(!ld||!ud)return;const t=e({name:"IDE-Haskell"});return ld.add(t),ud.setLinter(t),t};exports.consumeLinter=v;var m=function(e){if(!ud)return;return ud.setStatusBar(e),new ad(()=>{ud&&ud.removeStatusBar()})};exports.consumeStatusBar=m;var g=(vd=void 0,md=exports.provideUpi3_0=vd,gd=exports.provideUpi3_1=md,bd=exports.provideUpi3_2=gd,wd=exports.consumeUpi3_0=bd,exports.consumeUpi3_1=wd);exports.consumeUpi3_2=g;var y={};Object.defineProperty(y,"__esModule",{value:!0});var b=void 0;y.PluginManager=b;var w=u,_={};Object.defineProperty(_,"__esModule",{value:!0}),Object.defineProperty(_,"ResultItem",{enumerable:!0,get:function(){return O.ResultItem}});var k=void 0;_.ResultsDB=k;var O={};Object.defineProperty(O,"__esModule",{value:!0});var P=void 0;O.ResultItem=P;var M=l,j=u,E={};Object.defineProperty(E,"__esModule",{value:!0});var S={MAIN_MENU_LABEL:!0,getEventType:!0,bufferPositionFromMouseEvent:!0,handlePromise:!0,MessageObject:!0},x=function(e){return e&&(e.contextCommand||e[0]&&e[0].contextCommand)?"context":"keyboard"};E.getEventType=x;var C=function(e,t){const r=atom.views.getView(e).component.screenPositionForMouseEvent(t);if(isNaN(r.row)||isNaN(r.column))return;return e.bufferPositionForScreenPosition(r)};E.bufferPositionFromMouseEvent=C;var A=function(e){if("function"!=typeof e.catch)return void atom.notifications.addFatalError("Atom-Typescript: non-promise passed to handlePromise. Please report this.",{stack:(new Error).stack,dismissable:!0});e.catch(e=>{atom.notifications.addFatalError("Atom-Typescript error: "+e.message,{detail:e.toString(),stack:e.stack,dismissable:!0})})};E.handlePromise=A,Object.defineProperty(E,"MessageObject",{enumerable:!0,get:function(){return D.MessageObject}});var T=void 0;E.MAIN_MENU_LABEL=T;var D={};Object.defineProperty(D,"__esModule",{value:!0});var I=void 0;D.MessageObject=I;function N(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function R(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}Object.create;Object.create;var L,B={};!function(){var e="object"==typeof self&&self.self===self&&self||"object"==typeof c&&c.global===c&&c||this||{},t=e._,r=Array.prototype,n=Object.prototype,i="undefined"!=typeof Symbol?Symbol.prototype:null,o=r.push,s=r.slice,a=n.toString,l=n.hasOwnProperty,u=Array.isArray,p=Object.keys,d=Object.create,h=function(){},f=function(e){return e instanceof f?e:this instanceof f?void(this._wrapped=e):new f(e)};void 0===B||B.nodeType?e._=f:(!module.nodeType&&B&&(B=f),L=f,B._=L),f.VERSION="1.9.2";var v,m=function(e,t,r){if(void 0===t)return e;switch(null==r?3:r){case 1:return function(r){return e.call(t,r)};case 3:return function(r,n,i){return e.call(t,r,n,i)};case 4:return function(r,n,i,o){return e.call(t,r,n,i,o)}}return function(){return e.apply(t,arguments)}},g=function(e,t,r){return f.iteratee!==v?f.iteratee(e,t):null==e?f.identity:f.isFunction(e)?m(e,t,r):f.isObject(e)&&!f.isArray(e)?f.matcher(e):f.property(e)};f.iteratee=v=function(e,t){return g(e,t,1/0)};var y=function(e,t){return t=null==t?e.length-1:+t,function(){for(var r=Math.max(arguments.length-t,0),n=Array(r),i=0;i<r;i++)n[i]=arguments[i+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var o=Array(t+1);for(i=0;i<t;i++)o[i]=arguments[i];return o[t]=n,e.apply(this,o)}},b=function(e){if(!f.isObject(e))return{};if(d)return d(e);h.prototype=e;var t=new h;return h.prototype=null,t},w=function(e){return function(t){return null==t?void 0:t[e]}},_=function(e,t){return null!=e&&l.call(e,t)},k=function(e,t){for(var r=t.length,n=0;n<r;n++){if(null==e)return;e=e[t[n]]}return r?e:void 0},O=Math.pow(2,53)-1,P=w("length"),M=function(e){var t=P(e);return"number"==typeof t&&t>=0&&t<=O};f.each=f.forEach=function(e,t,r){var n,i;if(t=m(t,r),M(e))for(n=0,i=e.length;n<i;n++)t(e[n],n,e);else{var o=f.keys(e);for(n=0,i=o.length;n<i;n++)t(e[o[n]],o[n],e)}return e},f.map=f.collect=function(e,t,r){t=g(t,r);for(var n=!M(e)&&f.keys(e),i=(n||e).length,o=Array(i),s=0;s<i;s++){var a=n?n[s]:s;o[s]=t(e[a],a,e)}return o};var j=function(e){var t=function(t,r,n,i){var o=!M(t)&&f.keys(t),s=(o||t).length,a=e>0?0:s-1;for(i||(n=t[o?o[a]:a],a+=e);a>=0&&a<s;a+=e){var l=o?o[a]:a;n=r(n,t[l],l,t)}return n};return function(e,r,n,i){var o=arguments.length>=3;return t(e,m(r,i,4),n,o)}};f.reduce=f.foldl=f.inject=j(1),f.reduceRight=f.foldr=j(-1),f.find=f.detect=function(e,t,r){var n=(M(e)?f.findIndex:f.findKey)(e,t,r);if(void 0!==n&&-1!==n)return e[n]},f.filter=f.select=function(e,t,r){var n=[];return t=g(t,r),f.each(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n},f.reject=function(e,t,r){return f.filter(e,f.negate(g(t)),r)},f.every=f.all=function(e,t,r){t=g(t,r);for(var n=!M(e)&&f.keys(e),i=(n||e).length,o=0;o<i;o++){var s=n?n[o]:o;if(!t(e[s],s,e))return!1}return!0},f.some=f.any=function(e,t,r){t=g(t,r);for(var n=!M(e)&&f.keys(e),i=(n||e).length,o=0;o<i;o++){var s=n?n[o]:o;if(t(e[s],s,e))return!0}return!1},f.contains=f.includes=f.include=function(e,t,r,n){return M(e)||(e=f.values(e)),("number"!=typeof r||n)&&(r=0),f.indexOf(e,t,r)>=0},f.invoke=y((function(e,t,r){var n,i;return f.isFunction(t)?i=t:f.isArray(t)&&(n=t.slice(0,-1),t=t[t.length-1]),f.map(e,(function(e){var o=i;if(!o){if(n&&n.length&&(e=k(e,n)),null==e)return;o=e[t]}return null==o?o:o.apply(e,r)}))})),f.pluck=function(e,t){return f.map(e,f.property(t))},f.where=function(e,t){return f.filter(e,f.matcher(t))},f.findWhere=function(e,t){return f.find(e,f.matcher(t))},f.max=function(e,t,r){var n,i,o=-1/0,s=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,l=(e=M(e)?e:f.values(e)).length;a<l;a++)null!=(n=e[a])&&n>o&&(o=n);else t=g(t,r),f.each(e,(function(e,r,n){((i=t(e,r,n))>s||i===-1/0&&o===-1/0)&&(o=e,s=i)}));return o},f.min=function(e,t,r){var n,i,o=1/0,s=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,l=(e=M(e)?e:f.values(e)).length;a<l;a++)null!=(n=e[a])&&n<o&&(o=n);else t=g(t,r),f.each(e,(function(e,r,n){((i=t(e,r,n))<s||i===1/0&&o===1/0)&&(o=e,s=i)}));return o},f.shuffle=function(e){return f.sample(e,1/0)},f.sample=function(e,t,r){if(null==t||r)return M(e)||(e=f.values(e)),e[f.random(e.length-1)];var n=M(e)?f.clone(e):f.values(e),i=P(n);t=Math.max(Math.min(t,i),0);for(var o=i-1,s=0;s<t;s++){var a=f.random(s,o),l=n[s];n[s]=n[a],n[a]=l}return n.slice(0,t)},f.sortBy=function(e,t,r){var n=0;return t=g(t,r),f.pluck(f.map(e,(function(e,r,i){return{value:e,index:n++,criteria:t(e,r,i)}})).sort((function(e,t){var r=e.criteria,n=t.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(r<n||void 0===n)return-1}return e.index-t.index})),"value")};var E=function(e,t){return function(r,n,i){var o=t?[[],[]]:{};return n=g(n,i),f.each(r,(function(t,i){var s=n(t,i,r);e(o,t,s)})),o}};f.groupBy=E((function(e,t,r){_(e,r)?e[r].push(t):e[r]=[t]})),f.indexBy=E((function(e,t,r){e[r]=t})),f.countBy=E((function(e,t,r){_(e,r)?e[r]++:e[r]=1}));var S=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;f.toArray=function(e){return e?f.isArray(e)?s.call(e):f.isString(e)?e.match(S):M(e)?f.map(e,f.identity):f.values(e):[]},f.size=function(e){return null==e?0:M(e)?e.length:f.keys(e).length},f.partition=E((function(e,t,r){e[r?0:1].push(t)}),!0),f.first=f.head=f.take=function(e,t,r){return null==e||e.length<1?null==t?void 0:[]:null==t||r?e[0]:f.initial(e,e.length-t)},f.initial=function(e,t,r){return s.call(e,0,Math.max(0,e.length-(null==t||r?1:t)))},f.last=function(e,t,r){return null==e||e.length<1?null==t?void 0:[]:null==t||r?e[e.length-1]:f.rest(e,Math.max(0,e.length-t))},f.rest=f.tail=f.drop=function(e,t,r){return s.call(e,null==t||r?1:t)},f.compact=function(e){return f.filter(e,Boolean)};var x=function(e,t,r,n){for(var i=(n=n||[]).length,o=0,s=P(e);o<s;o++){var a=e[o];if(M(a)&&(f.isArray(a)||f.isArguments(a)))if(t)for(var l=0,u=a.length;l<u;)n[i++]=a[l++];else x(a,t,r,n),i=n.length;else r||(n[i++]=a)}return n};f.flatten=function(e,t){return x(e,t,!1)},f.without=y((function(e,t){return f.difference(e,t)})),f.uniq=f.unique=function(e,t,r,n){f.isBoolean(t)||(n=r,r=t,t=!1),null!=r&&(r=g(r,n));for(var i=[],o=[],s=0,a=P(e);s<a;s++){var l=e[s],u=r?r(l,s,e):l;t&&!r?(s&&o===u||i.push(l),o=u):r?f.contains(o,u)||(o.push(u),i.push(l)):f.contains(i,l)||i.push(l)}return i},f.union=y((function(e){return f.uniq(x(e,!0,!0))})),f.intersection=function(e){for(var t=[],r=arguments.length,n=0,i=P(e);n<i;n++){var o=e[n];if(!f.contains(t,o)){var s;for(s=1;s<r&&f.contains(arguments[s],o);s++);s===r&&t.push(o)}}return t},f.difference=y((function(e,t){return t=x(t,!0,!0),f.filter(e,(function(e){return!f.contains(t,e)}))})),f.unzip=function(e){for(var t=e&&f.max(e,P).length||0,r=Array(t),n=0;n<t;n++)r[n]=f.pluck(e,n);return r},f.zip=y(f.unzip),f.object=function(e,t){for(var r={},n=0,i=P(e);n<i;n++)t?r[e[n]]=t[n]:r[e[n][0]]=e[n][1];return r};var C=function(e){return function(t,r,n){r=g(r,n);for(var i=P(t),o=e>0?0:i-1;o>=0&&o<i;o+=e)if(r(t[o],o,t))return o;return-1}};f.findIndex=C(1),f.findLastIndex=C(-1),f.sortedIndex=function(e,t,r,n){for(var i=(r=g(r,n,1))(t),o=0,s=P(e);o<s;){var a=Math.floor((o+s)/2);r(e[a])<i?o=a+1:s=a}return o};var A=function(e,t,r){return function(n,i,o){var a=0,l=P(n);if("number"==typeof o)e>0?a=o>=0?o:Math.max(o+l,a):l=o>=0?Math.min(o+1,l):o+l+1;else if(r&&o&&l)return n[o=r(n,i)]===i?o:-1;if(i!=i)return(o=t(s.call(n,a,l),f.isNaN))>=0?o+a:-1;for(o=e>0?a:l-1;o>=0&&o<l;o+=e)if(n[o]===i)return o;return-1}};f.indexOf=A(1,f.findIndex,f.sortedIndex),f.lastIndexOf=A(-1,f.findLastIndex),f.range=function(e,t,r){null==t&&(t=e||0,e=0),r||(r=t<e?-1:1);for(var n=Math.max(Math.ceil((t-e)/r),0),i=Array(n),o=0;o<n;o++,e+=r)i[o]=e;return i},f.chunk=function(e,t){if(null==t||t<1)return[];for(var r=[],n=0,i=e.length;n<i;)r.push(s.call(e,n,n+=t));return r};var T=function(e,t,r,n,i){if(!(n instanceof t))return e.apply(r,i);var o=b(e.prototype),s=e.apply(o,i);return f.isObject(s)?s:o};f.bind=y((function(e,t,r){if(!f.isFunction(e))throw new TypeError("Bind must be called on a function");var n=y((function(i){return T(e,n,t,this,r.concat(i))}));return n})),f.partial=y((function(e,t){var r=f.partial.placeholder,n=function(){for(var i=0,o=t.length,s=Array(o),a=0;a<o;a++)s[a]=t[a]===r?arguments[i++]:t[a];for(;i<arguments.length;)s.push(arguments[i++]);return T(e,n,this,this,s)};return n})),f.partial.placeholder=f,f.bindAll=y((function(e,t){var r=(t=x(t,!1,!1)).length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=t[r];e[n]=f.bind(e[n],e)}})),f.memoize=function(e,t){var r=function(n){var i=r.cache,o=""+(t?t.apply(this,arguments):n);return _(i,o)||(i[o]=e.apply(this,arguments)),i[o]};return r.cache={},r},f.delay=y((function(e,t,r){return setTimeout((function(){return e.apply(null,r)}),t)})),f.defer=f.partial(f.delay,f,1),f.throttle=function(e,t,r){var n,i,o,s,a=0;r||(r={});var l=function(){a=!1===r.leading?0:f.now(),n=null,s=e.apply(i,o),n||(i=o=null)},u=function(){var u=f.now();a||!1!==r.leading||(a=u);var c=t-(u-a);return i=this,o=arguments,c<=0||c>t?(n&&(clearTimeout(n),n=null),a=u,s=e.apply(i,o),n||(i=o=null)):n||!1===r.trailing||(n=setTimeout(l,c)),s};return u.cancel=function(){clearTimeout(n),a=0,n=i=o=null},u},f.debounce=function(e,t,r){var n,i,o=function(t,r){n=null,r&&(i=e.apply(t,r))},s=y((function(s){if(n&&clearTimeout(n),r){var a=!n;n=setTimeout(o,t),a&&(i=e.apply(this,s))}else n=f.delay(o,t,this,s);return i}));return s.cancel=function(){clearTimeout(n),n=null},s},f.wrap=function(e,t){return f.partial(t,e)},f.negate=function(e){return function(){return!e.apply(this,arguments)}},f.compose=function(){var e=arguments,t=e.length-1;return function(){for(var r=t,n=e[t].apply(this,arguments);r--;)n=e[r].call(this,n);return n}},f.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},f.before=function(e,t){var r;return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}},f.once=f.partial(f.before,2),f.restArguments=y;var D=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],N=function(e,t){var r=I.length,i=e.constructor,o=f.isFunction(i)&&i.prototype||n,s="constructor";for(_(e,s)&&!f.contains(t,s)&&t.push(s);r--;)(s=I[r])in e&&e[s]!==o[s]&&!f.contains(t,s)&&t.push(s)};f.keys=function(e){if(!f.isObject(e))return[];if(p)return p(e);var t=[];for(var r in e)_(e,r)&&t.push(r);return D&&N(e,t),t},f.allKeys=function(e){if(!f.isObject(e))return[];var t=[];for(var r in e)t.push(r);return D&&N(e,t),t},f.values=function(e){for(var t=f.keys(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=e[t[i]];return n},f.mapObject=function(e,t,r){t=g(t,r);for(var n=f.keys(e),i=n.length,o={},s=0;s<i;s++){var a=n[s];o[a]=t(e[a],a,e)}return o},f.pairs=function(e){for(var t=f.keys(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=[t[i],e[t[i]]];return n},f.invert=function(e){for(var t={},r=f.keys(e),n=0,i=r.length;n<i;n++)t[e[r[n]]]=r[n];return t},f.functions=f.methods=function(e){var t=[];for(var r in e)f.isFunction(e[r])&&t.push(r);return t.sort()};var R=function(e,t){return function(r){var n=arguments.length;if(t&&(r=Object(r)),n<2||null==r)return r;for(var i=1;i<n;i++)for(var o=arguments[i],s=e(o),a=s.length,l=0;l<a;l++){var u=s[l];t&&void 0!==r[u]||(r[u]=o[u])}return r}};f.extend=R(f.allKeys),f.extendOwn=f.assign=R(f.keys),f.findKey=function(e,t,r){t=g(t,r);for(var n,i=f.keys(e),o=0,s=i.length;o<s;o++)if(t(e[n=i[o]],n,e))return n};var F,U,z=function(e,t,r){return t in r};f.pick=y((function(e,t){var r={},n=t[0];if(null==e)return r;f.isFunction(n)?(t.length>1&&(n=m(n,t[1])),t=f.allKeys(e)):(n=z,t=x(t,!1,!1),e=Object(e));for(var i=0,o=t.length;i<o;i++){var s=t[i],a=e[s];n(a,s,e)&&(r[s]=a)}return r})),f.omit=y((function(e,t){var r,n=t[0];return f.isFunction(n)?(n=f.negate(n),t.length>1&&(r=t[1])):(t=f.map(x(t,!1,!1),String),n=function(e,r){return!f.contains(t,r)}),f.pick(e,n,r)})),f.defaults=R(f.allKeys,!0),f.create=function(e,t){var r=b(e);return t&&f.extendOwn(r,t),r},f.clone=function(e){return f.isObject(e)?f.isArray(e)?e.slice():f.extend({},e):e},f.tap=function(e,t){return t(e),e},f.isMatch=function(e,t){var r=f.keys(t),n=r.length;if(null==e)return!n;for(var i=Object(e),o=0;o<n;o++){var s=r[o];if(t[s]!==i[s]||!(s in i))return!1}return!0},F=function(e,t,r,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var i=typeof e;return("function"===i||"object"===i||"object"==typeof t)&&U(e,t,r,n)},U=function(e,t,r,n){e instanceof f&&(e=e._wrapped),t instanceof f&&(t=t._wrapped);var o=a.call(e);if(o!==a.call(t))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return i.valueOf.call(e)===i.valueOf.call(t)}var s="[object Array]"===o;if(!s){if("object"!=typeof e||"object"!=typeof t)return!1;var l=e.constructor,u=t.constructor;if(l!==u&&!(f.isFunction(l)&&l instanceof l&&f.isFunction(u)&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1}n=n||[];for(var c=(r=r||[]).length;c--;)if(r[c]===e)return n[c]===t;if(r.push(e),n.push(t),s){if((c=e.length)!==t.length)return!1;for(;c--;)if(!F(e[c],t[c],r,n))return!1}else{var p,d=f.keys(e);if(c=d.length,f.keys(t).length!==c)return!1;for(;c--;)if(p=d[c],!_(t,p)||!F(e[p],t[p],r,n))return!1}return r.pop(),n.pop(),!0},f.isEqual=function(e,t){return F(e,t)},f.isEmpty=function(e){return null==e||(M(e)&&(f.isArray(e)||f.isString(e)||f.isArguments(e))?0===e.length:0===f.keys(e).length)},f.isElement=function(e){return!(!e||1!==e.nodeType)},f.isArray=u||function(e){return"[object Array]"===a.call(e)},f.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},f.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],(function(e){f["is"+e]=function(t){return a.call(t)==="[object "+e+"]"}})),f.isArguments(arguments)||(f.isArguments=function(e){return _(e,"callee")});var q=e.document&&e.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof q&&(f.isFunction=function(e){return"function"==typeof e||!1}),f.isFinite=function(e){return!f.isSymbol(e)&&isFinite(e)&&!isNaN(parseFloat(e))},f.isNaN=function(e){return f.isNumber(e)&&isNaN(e)},f.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===a.call(e)},f.isNull=function(e){return null===e},f.isUndefined=function(e){return void 0===e},f.has=function(e,t){if(!f.isArray(t))return _(e,t);for(var r=t.length,n=0;n<r;n++){var i=t[n];if(null==e||!l.call(e,i))return!1;e=e[i]}return!!r},f.noConflict=function(){return e._=t,this},f.identity=function(e){return e},f.constant=function(e){return function(){return e}},f.noop=function(){},f.property=function(e){return f.isArray(e)?function(t){return k(t,e)}:w(e)},f.propertyOf=function(e){return null==e?function(){}:function(t){return f.isArray(t)?k(e,t):e[t]}},f.matcher=f.matches=function(e){return e=f.extendOwn({},e),function(t){return f.isMatch(t,e)}},f.times=function(e,t,r){var n=Array(Math.max(0,e));t=m(t,r,1);for(var i=0;i<e;i++)n[i]=t(i);return n},f.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},f.now=Date.now||function(){return(new Date).getTime()};var V={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},$=f.invert(V),W=function(e){var t=function(t){return e[t]},r="(?:"+f.keys(e).join("|")+")",n=RegExp(r),i=RegExp(r,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(i,t):e}};f.escape=W(V),f.unescape=W($),f.result=function(e,t,r){f.isArray(t)||(t=[t]);var n=t.length;if(!n)return f.isFunction(r)?r.call(e):r;for(var i=0;i<n;i++){var o=null==e?void 0:e[t[i]];void 0===o&&(o=r,i=n),e=f.isFunction(o)?o.call(e):o}return e};var H=0;f.uniqueId=function(e){var t=++H+"";return e?e+t:t},f.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var G=/(.)^/,Q={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},K=/\\|'|\r|\n|\u2028|\u2029/g,X=function(e){return"\\"+Q[e]};f.template=function(e,t,r){!t&&r&&(t=r),t=f.defaults({},t,f.templateSettings);var n,i=RegExp([(t.escape||G).source,(t.interpolate||G).source,(t.evaluate||G).source].join("|")+"|$","g"),o=0,s="__p+='";e.replace(i,(function(t,r,n,i,a){return s+=e.slice(o,a).replace(K,X),o=a+t.length,r?s+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":n?s+="'+\n((__t=("+n+"))==null?'':__t)+\n'":i&&(s+="';\n"+i+"\n__p+='"),t})),s+="';\n",t.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{n=new Function(t.variable||"obj","_",s)}catch(e){throw e.source=s,e}var a=function(e){return n.call(this,e,f)},l=t.variable||"obj";return a.source="function("+l+"){\n"+s+"}",a},f.chain=function(e){var t=f(e);return t._chain=!0,t};var Y=function(e,t){return e._chain?f(t).chain():t};f.mixin=function(e){return f.each(f.functions(e),(function(t){var r=f[t]=e[t];f.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),Y(this,r.apply(f,e))}})),f},f.mixin(f),f.each(["pop","push","reverse","shift","sort","splice","unshift"],(function(e){var t=r[e];f.prototype[e]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==e&&"splice"!==e||0!==r.length||delete r[0],Y(this,r)}})),f.each(["concat","join","slice"],(function(e){var t=r[e];f.prototype[e]=function(){return Y(this,t.apply(this._wrapped,arguments))}})),f.prototype.value=function(){return this._wrapped},f.prototype.valueOf=f.prototype.toJSON=f.prototype.value,f.prototype.toString=function(){return String(this._wrapped)},"function"==typeof define&&define.amd&&define("underscore",[],(function(){return f}))}();var F,U,z={};function q(e){switch(e){case"&":return"&amp;";case'"':return"&quot;";case"'":return"&#39;";case"<":return"&lt;";case">":return"&gt;";case" ":return"&nbsp;";default:return e}}function V(e){return e.replace(/[&"'<>]/g,q)}function $(e){return e.replace(/[&"'<> ]/g,q)}function W(e,t,r){e.push(t),r.push(`<span class="${t.replace(/\.+/g," ")}">`)}function H(e,t){e.pop(),t.push("</span>")}function G(e,t,r){let n=e.length-t.length;if(n>0)for(;n--;)H(e,r);let i=0;for(let n=e.length;n>=0;--n){if(B.isEqual(e.slice(0,n),t.slice(0,n))){i=n;break}H(e,r)}for(let n=i;n<t.length;++n)W(e,t[n],r)}F=z,U=function(){var e=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function t(e){var t,r,n=e.replace(/^v/,"").replace(/\+.*$/,""),i=(r="-",-1===(t=n).indexOf(r)?t.length:t.indexOf(r)),o=n.substring(0,i).split(".");return o.push(n.substring(i+1)),o}function r(e){return isNaN(Number(e))?e:Number(e)}function n(t){if("string"!=typeof t)throw new TypeError("Invalid argument expected string");if(!e.test(t))throw new Error("Invalid argument not valid semver ('"+t+"' received)")}function i(e,i){[e,i].forEach(n);for(var o=t(e),s=t(i),a=0;a<Math.max(o.length-1,s.length-1);a++){var l=parseInt(o[a]||0,10),u=parseInt(s[a]||0,10);if(l>u)return 1;if(u>l)return-1}var c=o[o.length-1],p=s[s.length-1];if(c&&p){var d=c.split(".").map(r),h=p.split(".").map(r);for(a=0;a<Math.max(d.length,h.length);a++){if(void 0===d[a]||"string"==typeof h[a]&&"number"==typeof d[a])return-1;if(void 0===h[a]||"string"==typeof d[a]&&"number"==typeof h[a])return 1;if(d[a]>h[a])return 1;if(h[a]>d[a])return-1}}else if(c||p)return c?-1:1;return 0}var o=[">",">=","=","<","<="],s={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};return i.validate=function(t){return"string"==typeof t&&e.test(t)},i.compare=function(e,t,r){!function(e){if("string"!=typeof e)throw new TypeError("Invalid operator type, expected string but got "+typeof e);if(-1===o.indexOf(e))throw new TypeError("Invalid operator, expected one of "+o.join("|"))}(r);var n=i(e,t);return s[r].indexOf(n)>-1},i},"function"==typeof define&&define.amd?define([],U):"object"==typeof z?z=U():F.compareVersions=U();const Q={nbsp:!0,lineDivs:!1,editorDiv:!1,wrapCode:!1,editorDivTag:"div",editorDivClass:"editor editor-colors",nullScope:"text.plain.null-grammar"};var K=vo((function(e){const t=atom.grammars.textmateRegistry||atom.grammars,r=Object.assign({},Q,e),n=t.grammarForScopeName(r.scopeName)||(r.nullScope?t.grammarForScopeName(r.nullScope):void 0);if(void 0===n)throw new Error(`Grammar ${r.scopeName} not found, and no ${r.nullScope} grammar`);const i=n.tokenizeLines(r.fileContents);if(i.length>0){const e=i[i.length-1];1===e.length&&""===e[0].value&&i.pop()}const o=r.nbsp?$:V,s=[];r.editorDiv&&s.push(`<${r.editorDivTag} class="${r.editorDivClass}">`),r.wrapCode&&s.push("<code>");for(const e of i){const t=[];r.lineDivs&&s.push('<div class="line">');for(const{value:r,scopes:n}of e){let e=n;z(atom.getVersion(),"1.13.0")>=0&&(e=n.map(e=>"syntax--"+e.replace(/\./g,".syntax--"))),G(t,e,s),s.push(`<span>${o(r)}</span>`)}for(;t.length>0;)H(t,s);r.lineDivs&&s.push("</div>"),s.push("\n")}return r.wrapCode&&s.push("</code>"),r.editorDiv&&s.push(`</${r.editorDivTag}>`),s.join("")})),X={};Object.defineProperty(X,"__esModule",{value:!0});var Y=function(e){return"Dock"===e.constructor.name};X.isDock=Y;var Z=function(e){return"string"==typeof e.element};X.isSimpleControlDef=Z;var J=function(e){return void 0!==e};X.notUndefined=J;var ee=function(e){return"string"==typeof e&&ie.includes(e)};X.isTEventRangeType=ee;var te=function(e){return!(!e||!e.text)};X.isTextMessage=te;var re=function(e){return!(!e||!e.html)};X.isHTMLMessage=re;var ne=void 0;X.eventRangeTypeVals=ne;const ie=["context","keyboard","mouse","selection"];ne=ie,X.eventRangeTypeVals=ne;var oe=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=fo();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(X),se={};Object.defineProperty(se,"__esModule",{value:!0});var ae,le,ue,ce,pe,de,he={},fe={},ve={},me={},ge={},ye={},be={},we="object"==typeof c&&c&&c.Object===Object&&c;de=we;var _e="object"==typeof self&&self&&self.Object===Object&&self,ke=de||_e||Function("return this")();ce=(pe=ke).Symbol;var Oe={},Pe=Object.prototype,Me=Pe.hasOwnProperty,je=Pe.toString,Ee=ce?ce.toStringTag:void 0;Oe=function(e){var t=Me.call(e,Ee),r=e[Ee];try{e[Ee]=void 0;var n=!0}catch(e){}var i=je.call(e);return n&&(t?e[Ee]=r:delete e[Ee]),i};var Se={},xe=Object.prototype.toString;Se=function(e){return xe.call(e)};var Ce=ce?ce.toStringTag:void 0;be=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Ce&&Ce in Object(e)?Oe(e):Se(e)};var Ae={};Ae=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};ye=function(e){if(!Ae(e))return!1;var t=be(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};var Te,De,Ie={},Ne=pe["__core-js_shared__"],Re=(De=/[^.]+$/.exec((Te=Ne)&&Te.keys&&Te.keys.IE_PROTO||""))?"Symbol(src)_1."+De:"";Ie=function(e){return!!Re&&Re in e};var Le={},Be=Function.prototype.toString;Le=function(e){if(null!=e){try{return Be.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var Fe=/^\[object .+?Constructor\]$/,Ue=Function.prototype,ze=Object.prototype,qe=Ue.toString,Ve=ze.hasOwnProperty,$e=RegExp("^"+qe.call(Ve).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");ge=function(e){return!(!Ae(e)||Ie(e))&&(ye(e)?$e:Fe).test(Le(e))};var We={};We=function(e,t){return null==e?void 0:e[t]};var He=(me=function(e,t){var r=We(e,t);return ge(r)?r:void 0})(Object,"create");ve=He,ue=function(){this.__data__=ve?ve(null):{},this.size=0};var Ge;Ge=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t};var Qe,Ke=Object.prototype.hasOwnProperty;Qe=function(e){var t=this.__data__;if(ve){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Ke.call(t,e)?t[e]:void 0};var Xe,Ye=Object.prototype.hasOwnProperty;Xe=function(e){var t=this.__data__;return ve?void 0!==t[e]:Ye.call(t,e)};var Ze;function Je(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ze=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=ve&&void 0===t?"__lodash_hash_undefined__":t,this},Je.prototype.clear=ue,Je.prototype.delete=Ge,Je.prototype.get=Qe,Je.prototype.has=Xe,Je.prototype.set=Ze,fe=Je;var et,tt;tt=function(){this.__data__=[],this.size=0};var rt,nt={},it={};it=function(e,t){return e===t||e!=e&&t!=t},nt=function(e,t){for(var r=e.length;r--;)if(it(e[r][0],t))return r;return-1};var ot=Array.prototype.splice;rt=function(e){var t=this.__data__,r=nt(t,e);return!(r<0)&&(r==t.length-1?t.pop():ot.call(t,r,1),--this.size,!0)};var st;st=function(e){var t=this.__data__,r=nt(t,e);return r<0?void 0:t[r][1]};var at;at=function(e){return nt(this.__data__,e)>-1};var lt;function ut(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}lt=function(e,t){var r=this.__data__,n=nt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},ut.prototype.clear=tt,ut.prototype.delete=rt,ut.prototype.get=st,ut.prototype.has=at,ut.prototype.set=lt,et=ut;var ct,pt=me(pe,"Map");ct=pt,le=function(){this.size=0,this.__data__={hash:new fe,map:new(ct||et),string:new fe}};var dt,ht={},ft={};ft=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},ht=function(e,t){var r=e.__data__;return ft(t)?r["string"==typeof t?"string":"hash"]:r.map},dt=function(e){var t=ht(this,e).delete(e);return this.size-=t?1:0,t};var vt;vt=function(e){return ht(this,e).get(e)};var mt;mt=function(e){return ht(this,e).has(e)};var gt;function yt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}gt=function(e,t){var r=ht(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},yt.prototype.clear=le,yt.prototype.delete=dt,yt.prototype.get=vt,yt.prototype.has=mt,yt.prototype.set=gt,he=yt;function bt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=e.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(bt.Cache||he),r}bt.Cache=he,ae=bt;var wt={};function _t(e){for(var t in e)wt.hasOwnProperty(t)||(wt[t]=e[t])}Object.defineProperty(wt,"__esModule",{value:!0});var kt={};Object.defineProperty(kt,"__esModule",{value:!0});var Ot=function(){function e(e,t,r){void 0===r&&(r={}),this.execute=e,this.applicator=t,this.options=r}return Object.defineProperty(e.prototype,"bound",{get:function(){return null!=this.options.bound&&this.options.bound},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setter",{get:function(){return null!=this.options.setter&&this.options.setter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getter",{get:function(){return null!=this.options.getter&&this.options.getter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"property",{get:function(){return null!=this.options.property&&this.options.property},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){return null==this.options.method||this.options.method},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optionalParams",{get:function(){return null!=this.options.optionalParams&&this.options.optionalParams},enumerable:!0,configurable:!0}),e}();kt.DecoratorConfig=Ot,_t(kt);var Pt={};Object.defineProperty(Pt,"__esModule",{value:!0});var Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});var jt={};function Et(e){for(var t in e)jt.hasOwnProperty(t)||(jt[t]=e[t])}Object.defineProperty(jt,"__esModule",{value:!0});var St={};Object.defineProperty(St,"__esModule",{value:!0});var xt=function(e){return void 0===e&&(e=""),"lodash-decorators -> "+e};St.log=xt,Et(St);var Ct={};Object.defineProperty(Ct,"__esModule",{value:!0});var At={},Tt={},Dt=Array.isArray;Tt=Dt;var It={};It=function(e){return null!=e&&"object"==typeof e};At=function(e){return"string"==typeof e||!Tt(e)&&It(e)&&"[object String]"==be(e)};var Nt=function(e,t,r,n){if(void 0===n&&(n=!0),ye(e))return e;if(At(e)){if(t&&ye(t[e]))return t[e];if(r&&ye(r[e]))return r[e]}if(n)throw new ReferenceError(St.log("Can not resolve method "+e+" on any target Objects"))};Ct.resolveFunction=Nt,Et(Ct);var Rt={};Object.defineProperty(Rt,"__esModule",{value:!0});var Lt={};Lt=function(e){return void 0===e};var Bt=function(){function e(){this._weakMap=new WeakMap}return e.prototype.set=function(e,t){for(var r=this._weakMap,n=0,i=e.length-1;n<i;n++){var o=e[n],s=r.get(o);s||(s=new Map,r.set(o,s)),r=s}r.set(e[e.length-1],t)},e.prototype.get=function(e){for(var t=this._weakMap,r=0,n=e.length;r<n&&(t=t.get(e[r]),!Lt(t));r++);return t},e.prototype.has=function(e){return!Lt(this.get(e))},e}();Rt.CompositeKeyWeakMap=Bt,Et(Rt);var Ft={};Object.defineProperty(Ft,"__esModule",{value:!0});var Ut=function(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e.call.apply(e,[this].concat(r)),r[t]}};Ft.returnAtIndex=Ut,Et(Ft);var zt={};Object.defineProperty(zt,"__esModule",{value:!0});var qt={},Vt={},$t={};var Wt=function(e){return function(t,r,n){for(var i=-1,o=Object(t),s=n(t),a=s.length;a--;){var l=s[e?a:++i];if(!1===r(o[l],l,o))break}return t}}();$t=Wt;var Ht,Gt={},Qt={};Qt=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var Kt={},Xt={};Xt=function(e){return It(e)&&"[object Arguments]"==be(e)};var Yt=Object.prototype,Zt=Yt.hasOwnProperty,Jt=Yt.propertyIsEnumerable,er=Xt(function(){return arguments}())?Xt:function(e){return It(e)&&Zt.call(e,"callee")&&!Jt.call(e,"callee")};Kt=er;var tr;tr=function(){return!1};var rr=function(){var e={exports:this},t="object"==typeof this&&this&&!this.nodeType&&this,r=t&&"object"==typeof e&&e&&!e.nodeType&&e,n=r&&r.exports===t?pe.Buffer:void 0,i=(n?n.isBuffer:void 0)||tr;return e.exports=i,e.exports}.call({}),nr={},ir=/^(?:0|[1-9]\d*)$/;nr=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&ir.test(e))&&e>-1&&e%1==0&&e<t};var or,sr={},ar={};ar=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var lr={};lr["[object Float32Array]"]=lr["[object Float64Array]"]=lr["[object Int8Array]"]=lr["[object Int16Array]"]=lr["[object Int32Array]"]=lr["[object Uint8Array]"]=lr["[object Uint8ClampedArray]"]=lr["[object Uint16Array]"]=lr["[object Uint32Array]"]=!0,lr["[object Arguments]"]=lr["[object Array]"]=lr["[object ArrayBuffer]"]=lr["[object Boolean]"]=lr["[object DataView]"]=lr["[object Date]"]=lr["[object Error]"]=lr["[object Function]"]=lr["[object Map]"]=lr["[object Number]"]=lr["[object Object]"]=lr["[object RegExp]"]=lr["[object Set]"]=lr["[object String]"]=lr["[object WeakMap]"]=!1,or=function(e){return It(e)&&ar(e.length)&&!!lr[be(e)]};var ur={};ur=function(e){return function(t){return e(t)}};var cr=function(){var e={exports:this},t="object"==typeof this&&this&&!this.nodeType&&this,r=t&&"object"==typeof e&&e&&!e.nodeType&&e,n=r&&r.exports===t&&de.process,i=function(){try{var e=r&&r.require&&r.require("util").types;return e||n&&n.binding&&n.binding("util")}catch(e){}}();return e.exports=i,e.exports}.call({}),pr=cr&&cr.isTypedArray,dr=pr?ur(pr):or;sr=dr;var hr=Object.prototype.hasOwnProperty;Gt=function(e,t){var r=Tt(e),n=!r&&Kt(e),i=!r&&!n&&rr(e),o=!r&&!n&&!i&&sr(e),s=r||n||i||o,a=s?Qt(e.length,String):[],l=a.length;for(var u in e)!t&&!hr.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||nr(u,l))||a.push(u);return a};var fr={},vr={},mr=Object.prototype;vr=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||mr)};var gr={},yr={};var br=(yr=function(e,t){return function(r){return e(t(r))}})(Object.keys,Object);gr=br;var wr=Object.prototype.hasOwnProperty;fr=function(e){if(!vr(e))return gr(e);var t=[];for(var r in Object(e))wr.call(e,r)&&"constructor"!=r&&t.push(r);return t};var _r={};_r=function(e){return null!=e&&ar(e.length)&&!ye(e)},Ht=function(e){return _r(e)?Gt(e):fr(e)},Vt=function(e,t){return e&&$t(e,t,Ht)};var kr,Or={};kr=function(e){return e},Or=function(e){return"function"==typeof e?e:kr},qt=function(e,t){return e&&Vt(e,Or(t))};var Pr=function(e,t){return qt(t,(function(t,r){return e[r]=t})),e};zt.copyMetadata=Pr,Et(zt);var Mr={};Object.defineProperty(Mr,"__esModule",{value:!0});var jr=function(e,t){return zt.copyMetadata(e.bind(t),e)};Mr.bind=jr,Et(Mr);var Er={};Object.defineProperty(Er,"__esModule",{value:!0});var Sr={};Object.defineProperty(Sr,"__esModule",{value:!0});var xr,Cr={},Ar={},Tr={};xr=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var Dr;function Ir(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new he;++t<r;)this.add(e[t])}Dr=function(e){return this.__data__.has(e)},Ir.prototype.add=Ir.prototype.push=xr,Ir.prototype.has=Dr,Tr=Ir;var Nr={},Rr={},Lr={};Lr=function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1};var Br;Br=function(e){return e!=e};var Fr={};Fr=function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1},Rr=function(e,t,r){return t==t?Fr(e,t,r):Lr(e,Br,r)},Nr=function(e,t){return!!(null==e?0:e.length)&&Rr(e,t,0)>-1};var Ur;Ur=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1};var zr={};zr=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i};var qr;qr=function(e,t){return e.has(t)};Ar=function(e,t,r,n){var i=-1,o=Nr,s=!0,a=e.length,l=[],u=t.length;if(!a)return l;r&&(t=zr(t,ur(r))),n?(o=Ur,s=!1):t.length>=200&&(o=qr,s=!1,t=new Tr(t));e:for(;++i<a;){var c=e[i],p=null==r?c:r(c);if(c=n||0!==c?c:0,s&&p==p){for(var d=u;d--;)if(t[d]===p)continue e;l.push(c)}else o(t,p,n)||l.push(c)}return l};var Vr={},$r={},Wr={};Wr=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)};var Hr=Math.max;$r=function(e,t,r){return t=Hr(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=Hr(n.length-t,0),s=Array(o);++i<o;)s[i]=n[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=n[i];return a[t]=r(s),Wr(e,this,a)}};var Gr,Qr={},Kr={};Kr=function(e){return function(){return e}};var Xr={},Yr=function(){try{var e=me(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();Gr=(Xr=Yr)?function(e,t){return Xr(e,"toString",{configurable:!0,enumerable:!1,value:Kr(t),writable:!0})}:kr;var Zr={},Jr=Date.now;var en=(Zr=function(e){var t=0,r=0;return function(){var n=Jr(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}})(Gr);Qr=en;var tn={};tn=function(e){return It(e)&&_r(e)};var rn=(Vr=function(e,t){return Qr($r(e,t,kr),e+"")})((function(e,t){return tn(e)?Ar(e,t):[]}));Cr=rn;var nn={},on={},sn={},an={},ln=yr(Object.getPrototypeOf,Object);an=ln;var un=Function.prototype,cn=Object.prototype,pn=un.toString,dn=cn.hasOwnProperty,hn=pn.call(Object);sn=function(e){if(!It(e)||"[object Object]"!=be(e))return!1;var t=an(e);if(null===t)return!0;var r=dn.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&pn.call(r)==hn};on=function(e){if(!It(e))return!1;var t=be(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!sn(e)};var fn=Vr((function(e,t){try{return Wr(e,void 0,t)}catch(e){return on(e)?e:new Error(e)}}));nn=fn;var vn=function(e,t,r){void 0===r&&(r=[]);for(var n=0,i=Cr.apply(void 0,[Object.getOwnPropertyNames(t)].concat(r));n<i.length;n++){var o=i[n];nn(mn,e,t,o)}return e};function mn(e,t,r){var n=Object.getOwnPropertyDescriptor(e,r);if(!n||n.configurable){var i=Object.getOwnPropertyDescriptor(t,r);Ae(i)?Object.defineProperty(e,r,i):e[r]=t[r]}}Sr.assignAll=vn;var gn=mn;Sr.assignProperty=gn;var yn=["length","name","arguments","called","prototype"];var bn=function(e,t){function r(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return t.call.apply(t,[this,e].concat(r))}return r.prototype=e.prototype,Object.defineProperty(r,"name",{configurable:!0,enumerable:!1,value:e.name,writable:!1}),Sr.assignAll(r,e,yn)};Er.wrapConstructor=bn,Et(Er),Et(Sr);var wn={};Object.defineProperty(wn,"__esModule",{value:!0});var _n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>=2&&Ae(e[0])&&At(e[1])&&ye(e[0].constructor)&&e[0].constructor.prototype===e[0]};wn.isMethodOrPropertyDecoratorArgs=_n,Et(wn);var kn={};Object.defineProperty(kn,"__esModule",{value:!0});var On=function(e,t){return e===t||e.constructor!==t.constructor&&Object.getPrototypeOf(this).constructor===t.constructor};kn.isPrototypeAccess=On,Et(kn);var Pn=new jt.CompositeKeyWeakMap;Mt.InstanceChainMap=Pn;var Mn=function(){function e(){}return e.prototype.createDecorator=function(e){var t=this,r=e.applicator,n=e.optionalParams;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var s=i,a=function(n,i,o){var a=t._resolveDescriptor(n,i,o),l=a.value,u=a.get,c=a.set;return Mt.InstanceChainMap.has([n,i])||(ye(l)?a.value=jt.copyMetadata(r.apply({config:e,target:n,value:l,args:s}),l):ye(u)&&e.getter?a.get=jt.copyMetadata(r.apply({config:e,target:n,value:u,args:s}),u):ye(c)&&e.setter&&(a.set=jt.copyMetadata(r.apply({config:e,target:n,value:c,args:s}),c))),a};return n&&jt.isMethodOrPropertyDecoratorArgs.apply(void 0,i)?(s=[],a(i[0],i[1],i[2])):a}},e.prototype.createInstanceDecorator=function(e){var t=this,r=e.applicator,n=e.bound,i=e.optionalParams;return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];var a=o,l=function(i,o,s){var l=t._resolveDescriptor(i,o,s),u=l.value,c=l.writable,p=l.enumerable,d=l.configurable,h=l.get,f=l.set,v=!Mt.InstanceChainMap.has([i,o]),m=Mt.InstanceChainMap.get([i,o])||{fns:[],properties:[]},g=v&&ye(h),y=v&&ye(f),b=v&&ye(u),w=v&&!g&&!y&&!b,_=g?h:b?u:void 0;if(m.properties.push(o),m.fns.push((function(o,s,l){return t._isApplicable(l,e)?(n&&(o=jt.bind(o,s)),jt.copyMetadata(r.apply({args:a,target:i,instance:s,value:o,config:e}),o)):o})),Mt.InstanceChainMap.set([i,o],m),!v)return l;m.isSetter=y,m.isGetter=g,m.isMethod=b,m.isProperty=w;var k=function(e,t,r){return m.fns.reduce((function(e,n){return n(e,r,t)}),e)},O=function(e){var t=h||void 0,r=f||void 0;if(g||y)g&&(t=k(h,{value:h,getter:!0},e)),y&&(r=k(f,{value:f,setter:!0},e)),Object.defineProperty(e,o,{enumerable:p,configurable:d,get:t,set:r});else if(b||w){var n=k(u,b?{value:u,method:!0}:{value:u,property:!0},e);Object.defineProperty(e,o,{writable:c,enumerable:p,configurable:d,value:n})}};return(b||w)&&(delete l.value,delete l.writable),l.get=function(){if(jt.isPrototypeAccess(this,i))return _;O(this);var e=Object.getOwnPropertyDescriptor(this,o);return e.get?e.get.call(this):e.value},l.set=function(e){O(this);var t=Object.getOwnPropertyDescriptor(this,o);t.set?t.set.call(this,e):(w||b)&&(this[o]=e)},l};return i&&jt.isMethodOrPropertyDecoratorArgs.apply(void 0,o)?(a=[],l(o[0],o[1],o[2])):l}},e.prototype._isApplicable=function(e,t){return!Boolean(e.getter&&!t.getter||e.setter&&!t.setter||e.method&&!t.method||e.property&&!t.property)},e.prototype._resolveDescriptor=function(e,t,r){return r||(Object.getOwnPropertyDescriptor(e,t)||{})},e}(),jn=Mn;Pt.InternalDecoratorFactory=jn;var En=new Mn;Pt.DecoratorFactory=En,_t(Pt),_t(Mt);var Sn={};function xn(e){for(var t in e)Sn.hasOwnProperty(t)||(Sn[t]=e[t])}Object.defineProperty(Sn,"__esModule",{value:!0});var Cn={};Object.defineProperty(Cn,"__esModule",{value:!0});var An=function(){};Cn.Applicator=An,xn(Cn);var Tn={};Object.defineProperty(Tn,"__esModule",{value:!0});var Dn=function(e,t){return(Dn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function In(e,t){function r(){this.constructor=e}Dn(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Nn=function(e){function t(t){void 0===t&&(t={});var r=e.call(this)||this;return r._config=t,r}return In(t,e),Object.defineProperty(t.prototype,"post",{get:function(){return!0===this._config.post},enumerable:!0,configurable:!0}),t.prototype.apply=function(e){var t=e.config.execute,r=e.value,n=void 0===r?kr:r,i=e.args,o=e.target,s=this;return function(){for(var e=this,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];var l=i.map((function(t){return jt.resolveFunction(t,e,o)})).slice();return s.post?l.push(n):l.unshift(n),t.apply(void 0,l).apply(this,r)}},t}(Cn.Applicator);Tn.ComposeApplicator=Nn,xn(Tn);var Rn={};Object.defineProperty(Rn,"__esModule",{value:!0});var Ln=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return In(t,e),t.prototype.apply=function(e){var t=e.args,r=e.target,n=e.config.execute;return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return n.apply(void 0,[jt.resolveFunction(t[0],this,r)].concat(t.slice(1))).apply(this,e)}},t}(Cn.Applicator);Rn.PartialApplicator=Ln,xn(Rn);var Bn={};Object.defineProperty(Bn,"__esModule",{value:!0});var Fn,Un={},zn={},qn={},Vn={},$n=(Vn=me(pe,"WeakMap"))&&new Vn;Fn=(qn=$n)?function(e,t){return qn.set(e,t),e}:kr;var Wn={},Hn={},Gn={},Qn=Object.create,Kn=function(){function e(){}return function(t){if(!Ae(t))return{};if(Qn)return Qn(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();Gn=Kn,Hn=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Gn(e.prototype),n=e.apply(r,t);return Ae(n)?n:r}};Wn=function(e,t,r){var n=1&t,i=Hn(e);return function t(){var o=this&&this!==pe&&this instanceof t?i:e;return o.apply(n?r:this,arguments)}};var Xn={},Yn={},Zn={},Jn=Math.max;Zn=function(e,t,r,n){for(var i=-1,o=e.length,s=r.length,a=-1,l=t.length,u=Jn(o-s,0),c=Array(l+u),p=!n;++a<l;)c[a]=t[a];for(;++i<s;)(p||i<o)&&(c[r[i]]=e[i]);for(;u--;)c[a++]=e[i++];return c};var ei={},ti=Math.max;ei=function(e,t,r,n){for(var i=-1,o=e.length,s=-1,a=r.length,l=-1,u=t.length,c=ti(o-a,0),p=Array(c+u),d=!n;++i<c;)p[i]=e[i];for(var h=i;++l<u;)p[h+l]=t[l];for(;++s<a;)(d||i<o)&&(p[h+r[s]]=e[i++]);return p};var ri={};ri=function(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n};var ni,ii,oi={},si={};ii=function(){};function ai(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}ai.prototype=Gn(ii.prototype),ai.prototype.constructor=ai,ni=ai;var li={};li=qn?function(e){return qn.get(e)}:function(){};var ui,ci={};ui={};var pi=Object.prototype.hasOwnProperty;ci=function(e){for(var t=e.name+"",r=ui[t],n=pi.call(ui,t)?r.length:0;n--;){var i=r[n],o=i.func;if(null==o||o==e)return i.name}return t};var di,hi={};function fi(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}fi.prototype=Gn(ii.prototype),fi.prototype.constructor=fi,hi=fi;var vi={},mi={};mi=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t},vi=function(e){if(e instanceof ni)return e.clone();var t=new hi(e.__wrapped__,e.__chain__);return t.__actions__=mi(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t};var gi=Object.prototype.hasOwnProperty;function yi(e){if(It(e)&&!Tt(e)&&!(e instanceof ni)){if(e instanceof hi)return e;if(gi.call(e,"__wrapped__"))return vi(e)}return new hi(e)}yi.prototype=ii.prototype,yi.prototype.constructor=yi,di=yi,si=function(e){var t=ci(e),r=di[t];if("function"!=typeof r||!(t in ni.prototype))return!1;if(e===r)return!0;var n=li(r);return!!n&&e===n[0]};var bi={},wi=Zr(Fn);bi=wi;var _i={},ki={},Oi=/\{\n\/\* \[wrapped with (.+)\] \*/,Pi=/,? & /;ki=function(e){var t=e.match(Oi);return t?t[1].split(Pi):[]};var Mi={},ji=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;Mi=function(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(ji,"{\n/* [wrapped with "+t+"] */\n")};var Ei={},Si={};Si=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e};var xi=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];Ei=function(e,t){return Si(xi,(function(r){var n="_."+r[0];t&r[1]&&!Nr(e,n)&&e.push(n)})),e.sort()},_i=function(e,t,r){var n=t+"";return Qr(e,Mi(n,Ei(ki(n),r)))};oi=function(e,t,r,n,i,o,s,a,l,u){var c=8&t;t|=c?32:64,4&(t&=~(c?64:32))||(t&=-4);var p=[e,t,i,c?o:void 0,c?s:void 0,c?void 0:o,c?void 0:s,a,l,u],d=r.apply(void 0,p);return si(e)&&bi(d,p),d.placeholder=n,_i(d,e,t)};var Ci={};Ci=function(e){return e.placeholder};var Ai={},Ti=Math.min;Ai=function(e,t){for(var r=e.length,n=Ti(t.length,r),i=mi(e);n--;){var o=t[n];e[n]=nr(o,r)?i[o]:void 0}return e};var Di={};Di=function(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var s=e[r];s!==t&&"__lodash_placeholder__"!==s||(e[r]="__lodash_placeholder__",o[i++]=r)}return o};Yn=function e(t,r,n,i,o,s,a,l,u,c){var p=128&r,d=1&r,h=2&r,f=24&r,v=512&r,m=h?void 0:Hn(t);return function g(){for(var y=arguments.length,b=Array(y),w=y;w--;)b[w]=arguments[w];if(f)var _=Ci(g),k=ri(b,_);if(i&&(b=Zn(b,i,o,f)),s&&(b=ei(b,s,a,f)),y-=k,f&&y<c){var O=Di(b,_);return oi(t,r,e,g.placeholder,n,b,O,l,u,c-y)}var P=d?n:this,M=h?P[t]:t;return y=b.length,l?b=Ai(b,l):v&&y>1&&b.reverse(),p&&u<y&&(b.length=u),this&&this!==pe&&this instanceof g&&(M=m||Hn(M)),M.apply(P,b)}},Xn=function(e,t,r){var n=Hn(e);return function i(){for(var o=arguments.length,s=Array(o),a=o,l=Ci(i);a--;)s[a]=arguments[a];var u=o<3&&s[0]!==l&&s[o-1]!==l?[]:Di(s,l);if((o-=u.length)<r)return oi(e,t,Yn,i.placeholder,void 0,s,u,void 0,void 0,r-o);var c=this&&this!==pe&&this instanceof i?n:e;return Wr(c,this,s)}};var Ii={};Ii=function(e,t,r,n){var i=1&t,o=Hn(e);return function t(){for(var s=-1,a=arguments.length,l=-1,u=n.length,c=Array(u+a),p=this&&this!==pe&&this instanceof t?o:e;++l<u;)c[l]=n[l];for(;a--;)c[l++]=arguments[++s];return Wr(p,i?r:this,c)}};var Ni={},Ri=Math.min;Ni=function(e,t){var r=e[1],n=t[1],i=r|n,o=i<131,s=128==n&&8==r||128==n&&256==r&&e[7].length<=t[8]||384==n&&t[7].length<=t[8]&&8==r;if(!o&&!s)return e;1&n&&(e[2]=t[2],i|=1&r?0:4);var a=t[3];if(a){var l=e[3];e[3]=l?Zn(l,a,t[4]):a,e[4]=l?Di(e[3],"__lodash_placeholder__"):t[4]}return(a=t[5])&&(l=e[5],e[5]=l?ei(l,a,t[6]):a,e[6]=l?Di(e[5],"__lodash_placeholder__"):t[6]),(a=t[7])&&(e[7]=a),128&n&&(e[8]=null==e[8]?t[8]:Ri(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i,e};var Li={},Bi={},Fi={},Ui={};Ui=function(e){return"symbol"==typeof e||It(e)&&"[object Symbol]"==be(e)};var zi=/^\s+|\s+$/g,qi=/^[-+]0x[0-9a-f]+$/i,Vi=/^0b[01]+$/i,$i=/^0o[0-7]+$/i,Wi=parseInt;Fi=function(e){if("number"==typeof e)return e;if(Ui(e))return NaN;if(Ae(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ae(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(zi,"");var r=Vi.test(e);return r||$i.test(e)?Wi(e.slice(2),r?2:8):qi.test(e)?NaN:+e};Bi=function(e){return e?(e=Fi(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0},Li=function(e){var t=Bi(e),r=t%1;return t==t?r?t-r:t:0};var Hi=Math.max;zn=function(e,t,r,n,i,o,s,a){var l=2&t;if(!l&&"function"!=typeof e)throw new TypeError("Expected a function");var u=n?n.length:0;if(u||(t&=-97,n=i=void 0),s=void 0===s?s:Hi(Li(s),0),a=void 0===a?a:Li(a),u-=i?i.length:0,64&t){var c=n,p=i;n=i=void 0}var d=l?void 0:li(e),h=[e,t,r,n,i,c,p,o,s,a];if(d&&Ni(h,d),e=h[0],t=h[1],r=h[2],n=h[3],i=h[4],!(a=h[9]=void 0===h[9]?l?0:e.length:Hi(h[9]-u,0))&&24&t&&(t&=-25),t&&1!=t)f=8==t||16==t?Xn(e,t,a):32!=t&&33!=t||i.length?Yn.apply(void 0,h):Ii(e,t,r,n);else var f=Wn(e,t,r);return _i((d?Fn:bi)(f,h),e,t)};var Gi=Vr((function(e,t){var r=Di(t,Ci(Gi));return zn(e,32,void 0,t,r)}));Gi.placeholder={},Un=Gi;var Qi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return In(t,e),t.prototype.apply=function(e){var t=e.config.execute,r=e.value,n=e.args;return Un.apply(void 0,[t,r].concat(n))},t}(Cn.Applicator);Bn.PartialedApplicator=Qi,xn(Bn);var Ki={};Object.defineProperty(Ki,"__esModule",{value:!0});var Xi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return In(t,e),t.prototype.apply=function(e){var t=e.args,r=e.target,n=e.value,i=e.config.execute;return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var s=n,a=0;return ye(s)||(s=jt.resolveFunction(t[0],this,r),a=1),i.apply(void 0,[s].concat(t.slice(a))).apply(this,e)}},t}(Cn.Applicator);Ki.PartialValueApplicator=Xi,xn(Ki);var Yi={};Object.defineProperty(Yi,"__esModule",{value:!0});var Zi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return In(t,e),t.prototype.apply=function(e){var t=e.config,r=t.execute,n=(t.bound,e.args),i=e.value;return r.apply(void 0,n.concat([i]))},t}(Cn.Applicator);Yi.PostValueApplicator=Zi,xn(Yi);var Ji={};Object.defineProperty(Ji,"__esModule",{value:!0});var eo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return In(t,e),t.prototype.apply=function(e){var t=e.value,r=e.config.execute,n=e.args;return r.apply(void 0,[t].concat(n))},t}(Cn.Applicator);Ji.PreValueApplicator=eo,xn(Ji);var to={};Object.defineProperty(to,"__esModule",{value:!0});var ro=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return In(t,e),t.prototype.apply=function(e){var t=e.args,r=e.config.execute,n=e.target,i=e.value;return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return r(jt.resolveFunction(t[0],this,n),i).apply(this,e)}},t}(Cn.Applicator);to.WrapApplicator=ro,xn(to);var no={};Object.defineProperty(no,"__esModule",{value:!0});var io=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return In(t,e),t.prototype.apply=function(e){var t=e.value,r=e.config.execute,n=e.args,i=e.instance;e.target;return i?r.apply(void 0,[t,i].concat(n)):t},t}(Cn.Applicator);no.BindApplicator=io,xn(no);var oo={};Object.defineProperty(oo,"__esModule",{value:!0});var so=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return In(t,e),t.prototype.apply=function(e){var t=e.args,r=(e.target,e.config.execute),n=e.value;return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return r.apply(void 0,[n.bind(this)].concat(e,t))}},t}(Cn.Applicator);oo.InvokeApplicator=so,xn(oo);var ao={};Object.defineProperty(ao,"__esModule",{value:!0});var lo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return In(t,e),t.prototype.apply=function(e){var t=e.value,r=e.instance,n=e.config.execute,i=e.args,o=e.target,s=jt.resolveFunction(ye(i[0])?i[0]:Ae(i[0])?i[0].resolver:i[0],r,o,!1);s&&r&&(s=s.bind(r));var a=s?n(t,s):n(t);if(Ae(i[0])){var l=i[0],u=l.cache,c=l.type;u?a.cache=u:ye(c)&&(a.cache=new c)}return a},t}(Cn.Applicator);ao.MemoizeApplicator=lo,xn(ao);var uo=wt.DecoratorFactory.createInstanceDecorator(new wt.DecoratorConfig(ae,new Sn.MemoizeApplicator,{optionalParams:!0}));se.Memoize=uo;var co=se.Memoize;se.memoize=co;var po=se.Memoize;se.default=po;var ho=vo(se);function fo(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return fo=function(){return e},e}function vo(e){return e&&e.__esModule?e:{default:e}}class mo{constructor(e){this.msg=e}toHtml(){if(oe.isTextMessage(this.msg)&&void 0!==this.msg.highlighter){const e=(0,K.default)({fileContents:this.msg.text,scopeName:this.msg.highlighter,nbsp:!1,lineDivs:!1});return e||(this.msg.highlighter=void 0,this.toHtml())}if(oe.isHTMLMessage(this.msg))return this.msg.html;{let e;e=oe.isTextMessage(this.msg)?this.msg.text:this.msg;const t=document.createElement("div");return t.innerText=e,t.innerHTML}}toPlain(){if(oe.isHTMLMessage(this.msg)){const e=document.createElement("div");return e.innerHTML=this.msg.html,e.innerText}{let e;return e=oe.isTextMessage(this.msg)?this.msg.text:this.msg,e}}raw(){return oe.isTextMessage(this.msg)?this.msg.text:oe.isHTMLMessage(this.msg)?this.msg.html:this.msg}}I=mo,D.MessageObject=I,mo.fromObject=e=>e instanceof mo?e:new mo(e),N([(0,ho.default)(),R("design:type",Function),R("design:paramtypes",[]),R("design:returntype",String)],mo.prototype,"toHtml",null),N([(0,ho.default)(),R("design:type",Function),R("design:paramtypes",[]),R("design:returntype",String)],mo.prototype,"toPlain",null),Object.keys(X).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(S,e)||Object.defineProperty(E,e,{enumerable:!0,get:function(){return X[e]}}))}));var go={};Object.defineProperty(go,"__esModule",{value:!0});var yo=function(e,t,r,n){const i=t=>{const i=t.target.closest(r);i&&e.contains(i)&&n(t)};return e.addEventListener(t,i),new bo.Disposable(()=>{e.removeEventListener(t,i)})};go.listen=yo;var bo=u;Object.keys(go).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(S,e)||Object.defineProperty(E,e,{enumerable:!0,get:function(){return go[e]}}))}));T="Haskell IDE",E.MAIN_MENU_LABEL=T;P=class{constructor(e,{uri:t,message:r,severity:n,position:i,context:o}){this.providerId=e,this.uri=t,this.message=E.MessageObject.fromObject(r),this.severity=n,this.position=i?j.Point.fromObject(i):void 0,this.context=o,this._isValid=!0}isValid(){return this._isValid}setValid(e){this._isValid=e}hash(){if(void 0!==this._hash)return this._hash;const e=(0,M.createHash)("sha1");return e.update(JSON.stringify({uri:this.uri,position:this.position?this.position.serialize():void 0,message:this.message.raw(),severity:this.severity,context:this.context})),this._hash=e.digest("base64"),this._hash}},O.ResultItem=P;var wo=u,_o={};Object.defineProperty(_o,"__esModule",{value:!0});var ko=void 0;_o.Provider=ko;ko=class{constructor(e,t,r){this.parent=e,this.providerSeverities=t,this.id=r,this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.parent.didUpdate(this.id,Array.from(this.providerSeverities),[]))}addSeverity(e){this.providerSeverities.add(e)}removeSeverity(e){this.providerSeverities.delete(e)}setMessages(e){if(this.disposed)return;const t=e.map(e=>new O.ResultItem(this.id,e));this.parent.didUpdate(this.id,Array.from(this.providerSeverities),t)}},_o.Provider=ko;k=class{constructor(){this.currentId=0,this.disposables=new wo.CompositeDisposable,this.emitter=new wo.Emitter,this.disposables.add(this.emitter),this.messages=new Map}destroy(){this.disposables.dispose()}onDidUpdate(e){return this.emitter.on("did-update",e)}didUpdate(e,t,r){const n=r.map(e=>e.uri).filter(E.notUndefined);for(const[r,i]of Array.from(this.messages))(i.providerId===e||void 0!==i.uri&&n.includes(i.uri)&&t.includes(i.severity))&&this.messages.delete(r);for(const e of r)this.messages.set(e.hash(),e);const i=new Set(r.map(e=>e.severity));this.emitter.emit("did-update",Array.from(i))}registerProvider(e){const t=new _o.Provider(this,new Set(e),++this.currentId);return this.disposables.add(t),t}results(){return this.messages.values()}*filter(e){for(const t of this.results())e(t)&&(yield t)}isEmpty(e){return!Array.from(this.messages.values()).some(({severity:t})=>e.includes(t))}},_.ResultsDB=k;var Oo={};Object.defineProperty(Oo,"__esModule",{value:!0});var Po=void 0;Oo.ConfigParamManager=Po;var Mo=u,jo={};Object.defineProperty(jo,"__esModule",{value:!0});var Eo=void 0;jo.ParamControl=Eo;var So,xo,Co=u;xo={onCopy:"copy",onCut:"cut",onPaste:"paste",onCompositionEnd:"compositionend",onCompositionStart:"compositionstart",onCompositionUpdate:"compositionupdate",onKeyDown:"keydown",onKeyPress:"keypress",onKeyUp:"keyup",onFocus:"focus",onBlur:"blur",onChange:"change",onInput:"input",onSubmit:"submit",onClick:"click",onContextMenu:"contextmenu",onDoubleClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragEnter:"dragenter",onDragExit:"dragexit",onDragLeave:"dragleave",onDragOver:"dragover",onDragStart:"dragstart",onDrop:"drop",onMouseDown:"mousedown",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onSelect:"select",onTouchCancel:"touchcancel",onTouchEnd:"touchend",onTouchMove:"touchmove",onTouchStart:"touchstart",onScroll:"scroll",onWheel:"wheel",onAbort:"abort",onCanPlay:"canplay",onCanPlayThrough:"canplaythrough",onDurationChange:"durationchange",onEmptied:"emptied",onEncrypted:"encrypted",onEnded:"ended",onError:"error",onLoadedData:"loadeddata",onLoadedMetadata:"loadedmetadata",onLoadStart:"loadstart",onPause:"pause",onPlay:"play",onPlaying:"playing",onProgress:"progress",onRateChange:"ratechange",onSeeked:"seeked",onSeeking:"seeking",onStalled:"stalled",onSuspend:"suspend",onTimeUpdate:"timeupdate",onVolumeChange:"volumechange",onWaiting:"waiting",onLoad:"load",onAnimationStart:"animationstart",onAnimationEnd:"animationend",onAnimationIteration:"animationiteration",onTransitionEnd:"transitionend"};var Ao={};function To(e,t,...r){let n=[];for(let e=0;e<r.length;){const t=r[e];switch(typeof t){case"string":case"number":r[e]={text:t},e++;break;case"object":Array.isArray(t)?r.splice(e,1,...t):t?(t.context||(n.push(t),t.ambiguous&&t.ambiguous.length&&(n=n.concat(t.ambiguous))),e++):r.splice(e,1);break;default:throw new Error("Invalid child node: "+t)}}if(t){for(const e in t){const r=xo[e];r&&(t.on||(t.on={}),t.on[r]=t[e])}t.class&&(t.className=t.class)}return{tag:e,props:t,children:r,ambiguous:n}}Ao=new Set(["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]);const Do=["a","abbr","address","article","aside","audio","b","bdi","bdo","blockquote","body","button","canvas","caption","cite","code","colgroup","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","html","i","iframe","ins","kbd","label","legend","li","main","map","mark","menu","meter","nav","noscript","object","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","u","ul","var","video","area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];for(const e of Do)To[e]=(t,...r)=>To(e,t,...r);for(const e of Ao)To[e]=(t,...r)=>To(e,t,...r);So=To;var Io,No={},Ro={};Ro=new Map([["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["className","class"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["panose1","panose-1"],["paintOrder","paint-order"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xHeight","x-height"]]);var Lo;function Bo(e,t,r,n){if(t)for(var i in t)r&&i in r||(n?e[i]="":delete e[i]);if(r)for(var i in r){const n=t&&t[i],o=r[i];o!==n&&(e[i]=o)}}function Fo(e,t,r){if(t)for(var n in t)r&&n in r||e.removeAttribute(n);if(r)for(var n in r){const i=t&&t[n],o=r[n];o!==i&&e.setAttribute(n,o)}}function Uo(e,t){let r;if(null!=e.text)r=document.createTextNode(e.text);else{const{tag:n,children:i}=e;let{props:o,context:s}=e;if(s&&(t={refs:s.refs,listenerContext:s}),"function"==typeof n){let s;o&&o.ref&&(s=o.ref);const a=new n(o||{},i);e.component=a,r=a.element,"function"==typeof s?s(a):t&&t.refs&&s&&(t.refs[s]=a)}else Ao.has(n)?(r=document.createElementNS("http://www.w3.org/2000/svg",n),i&&zo(r,i,t),o&&Io(r,null,e,t)):(r=document.createElement(n),i&&zo(r,i,t),o&&Io(r,null,e,t))}return e.domNode=r,r}function zo(e,t,r){for(let n=0;n<t.length;n++)e.appendChild(Uo(t[n],r))}Lo=function(e,t,r,n){r!==t&&("function"==typeof t?t(null):t&&n[t]===e&&delete n[t],"function"==typeof r?r(e):r&&(n[r]=e))},Io=function(e,t,r,n){const i=t&&t.props,o=r.props;let s,a;n&&(s=n.refs,a=n.listenerContext),function e(t,r,n,i,o){if(n)for(var s in n)"ref"!==s&&"on"!==s&&(s in xo||o&&s in o||("dataset"===s?e(t.dataset,null,n&&n.dataset,null,null):"innerHTML"!==s&&r&&Ao.has(r.tag)?t.removeAttribute(Ro.get(s)||s):(t[s]="",delete t[s])));if(o)for(var s in o)if("ref"!==s&&"on"!==s&&!(s in xo)){var a=n&&n[s],l=o[s];"dataset"===s?Bo(t.dataset,a,l,!1):"style"===s&&"string"!=typeof l?("string"==typeof a&&(t.style="",a=null),Bo(t.style,a,l,!0)):"attributes"===s?Fo(t,a,l):l!==a&&("innerHTML"!==s&&i&&Ao.has(i.tag)?t.setAttribute(Ro.get(s)||s,l):i&&"input"===i.tag&&"value"===s&&t[s]===l||(t[s]=l))}}(e,t,i,r,o),s&&Lo(e,i&&i.ref,o&&o.ref,s),function(e,t,r,n){const i=t&&t.props&&t.props.on,o=r.props&&r.props.on;for(const r in i)if(!o||!(r in o)){let n;n=t&&t.boundListeners&&t.boundListeners[r]?t.boundListeners[r]:i[r],e.removeEventListener(r,n)}for(const s in o){const a=i&&i[s],l=o[s];if(l!==a){if(a){let r;r=t&&t.boundListeners&&t.boundListeners[s]?t.boundListeners[s]:a,e.removeEventListener(s,r)}if(l){let t;n?(t=l.bind(n),r.boundListeners||(r.boundListeners={}),r.boundListeners[s]=t):t=l,e.addEventListener(s,t)}}}}(e,t,r,a)},No=Uo;var qo,Vo={};function $o(e,t,r){const n=e.domNode;if(t===e)return n;if(Go(e,t)){let i;return null!=t.text?(n.nodeValue=t.text,i=n):"function"==typeof t.tag?i=function(e,t,r){const{component:n,props:i}=e;let{props:o,children:s}=t;t.component=n;const a=r&&r.refs;a&&Lo(n,i&&i.ref,o&&o.ref,a);return n.update(o||{},s),n.element}(e,t,r):(!function(e,t,r,n){var i,o=0,s=t.length-1,a=t[0],l=t[s],u=0,c=r.length-1,p=r[0],d=r[c];for(;o<=s&&u<=c;)if(a)if(l)if(Go(a,p))$o(a,p,n),a=t[++o],p=r[++u];else if(Go(l,d))$o(l,d,n),l=t[--s],d=r[--c];else if(Go(a,d))$o(a,d,n),e.insertBefore(a.domNode,l.domNode.nextSibling),a=t[++o],d=r[--c];else if(Go(l,p))$o(l,p,n),e.insertBefore(l.domNode,a.domNode),l=t[--s],p=r[++u];else{i||(Wo.length>0?(i=Wo.pop()).clear():i=new Map,Ko(i,t,o,s));var h=Qo(p),f=h?i.get(h):null;if(null==f)e.insertBefore(No(p,n),a.domNode),p=r[++u];else{var v=t[f];$o(v,p,n),t[f]=void 0,e.insertBefore(v.domNode,a.domNode),p=r[++u]}}else l=t[--s];else a=t[++o];if(o>s){var m=r[c+1]?r[c+1].domNode:null;for(let t=u;t<=c;t++)e.insertBefore(No(r[t],n),m)}else if(u>c)for(let e=o;e<=s;e++){var g=t[e];g&&Ho(g,n&&n.refs)}i&&Wo.push(i)}(n,e.children,t.children,r),Io(n,e,t,r),i=n),t.domNode=i,i!==n&&n.parentNode&&n.parentNode.replaceChild(i,n),i}{const i=n.parentNode,o=n.nextSibling;Ho(e,r&&r.refs);const s=No(t,r);return i&&i.insertBefore(s,o),t.domNode=s,s}}let Wo=[new Map,new Map,new Map,new Map];function Ho(e,t,r=!0){const{domNode:n,props:i,children:o,component:s}=e,a=i&&i.ref;if(s)"function"==typeof a?a(null):t&&a&&t[a]===s&&delete t[a],s.destroy&&s.destroy();else if("function"==typeof a?a(null):t&&a&&t[a]===n&&delete t[a],o)for(let e=0;e<o.length;e++)Ho(o[e],t,!1);r&&n.remove()}function Go(e,t){return Qo(e)===Qo(t)&&e.tag===t.tag}function Qo(e){return e.props?e.props.key:void 0}function Ko(e,t,r,n){for(let i=r;i<=n;i++){const r=Qo(t[i]);r&&e.set(r,i)}return e}Vo=$o;var Xo,Yo={};Xo=class{constructor(){this.updateRequests=[],this.readRequests=[],this.pendingAnimationFrame=null,this.performUpdates=this.performUpdates.bind(this),this.performingUpdates=!1}updateDocument(e){this.updateRequests.push(e),this.pendingAnimationFrame||(this.pendingAnimationFrame=window.requestAnimationFrame(this.performUpdates))}readDocument(e){this.readRequests.push(e),this.pendingAnimationFrame||(this.pendingAnimationFrame=window.requestAnimationFrame(this.performUpdates))}getNextUpdatePromise(){return this.nextUpdatePromise||(this.nextUpdatePromise=new Promise(e=>{this.resolveNextUpdatePromise=e})),this.nextUpdatePromise}performUpdates(){for(;this.updateRequests.length>0;)this.updateRequests.shift()();for(this.pendingAnimationFrame=null;this.readRequests.length>0;)this.readRequests.shift()();if(this.nextUpdatePromise){let e=this.resolveNextUpdatePromise;this.nextUpdatePromise=null,this.resolveNextUpdatePromise=null,e()}}};let Zo=null;Yo.setScheduler=function(e){Zo=e};var Jo=function(){return Zo||(Zo=new Xo),Zo};Yo.getScheduler=Jo;const es=new WeakSet;let ts=0,rs=0;function ns(e){return null!=e&&!1!==e}function is(e,t){t.context=e,t.ambiguous&&(t.ambiguous.forEach(t=>{t.context=e}),delete t.ambiguous)}function os(e,t=!0){if(!ns(e.virtualNode))throw new Error((e.constructor?e.constructor.name+" instance":e)+" is not associated with a valid virtualNode. Perhaps this component was never initialized?");if(null==e.element)throw new Error((e.constructor?e.constructor.name+" instance":e)+" is not associated with a DOM element. Perhaps this component was never initialized?");let r=e.render();if(!ns(r)){const t=e.constructor&&e.constructor.name?" in "+e.constructor.name:"";throw new Error("invalid falsy value "+r+" returned from render()"+t)}is(e,r),ts++;let n=e.virtualNode,i=e.element,o=Vo(n,r,{refs:e.refs,listenerContext:e});if(e.virtualNode=r,o!==i&&!t)throw new Error("The root node type changed on update, but the update was performed with the replaceNode option set to false");e.element=o,"function"==typeof e.writeAfterUpdate&&e.writeAfterUpdate(),"function"==typeof e.readAfterUpdate&&Jo().readDocument((function(){e.readAfterUpdate()})),ts--}function ss(e,t=!0){rs++,as(e.virtualNode),1===rs&&t&&e.element.remove(),rs--}function as(e){e.component&&"function"==typeof e.component.destroy?e.component.destroy():e.children&&e.children.forEach(as)}qo={initialize:function(e){if("function"!=typeof e.update)throw new Error("Etch components must implement `update(props, children)`.");let t=e.render();if(!ns(t)){let r=e.constructor&&e.constructor.name?" in "+e.constructor.name:"";throw new Error("invalid falsy value "+t+" returned from render()"+r)}is(e,t),e.refs={},e.virtualNode=t,e.element=No(e.virtualNode,{refs:e.refs,listenerContext:e})},update:function(e,t=!0){if(ts>0)return os(e,t),Promise.resolve();let r=Jo();return es.has(e)||(es.add(e),r.updateDocument((function(){es.delete(e),os(e,t)}))),r.getNextUpdatePromise()},updateSync:os,destroy:function(e,t=!0){if(ts>0||rs>0)return ss(e,t),Promise.resolve();let r=Jo();return r.updateDocument((function(){ss(e,t)})),r.getNextUpdatePromise()},destroySync:ss};var ls,us,cs,ps,ds,hs,fs,vs,ms,gs,ys=!1;function bs(){return ys||(ys=!0,ls={},us=So,cs=No,({initialize:ps,update:ds,updateSync:hs,destroy:fs,destroySync:vs}=qo),({setScheduler:ms,getScheduler:gs}=Yo),ls={dom:us,render:cs,initialize:ps,update:ds,updateSync:hs,destroy:fs,destroySync:vs,setScheduler:ms,getScheduler:gs}),ls}var ws=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_s();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(bs());function _s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _s=function(){return e},e}Eo=class{constructor(e){this.props=e,this.tooltipTitle=()=>{const e=void 0!==this.props.spec.displayName?this.props.spec.displayName:"Undefined name";return this.hiddenValue?`${e}: ${this.props.spec.displayTemplate(this.value)}`:e},this.disposables=new Co.CompositeDisposable,this.hiddenValue=atom.config.get("ide-haskell.hideParameterValues"),this.initStore(),this.initSpec(),ws.initialize(this),this.disposables.add(atom.config.onDidChange("ide-haskell.hideParameterValues",({newValue:e})=>{this.hiddenValue=e,(0,E.handlePromise)(this.update())})),this.disposables.add(atom.tooltips.add(this.element,{title:this.tooltipTitle}))}render(){const e=["ide-haskell--"+this.props.pluginName,"ide-haskell-param--"+this.props.name];return this.hiddenValue&&e.push("hidden-value"),ws.dom("ide-haskell-param",{class:e.join(" "),on:{click:async()=>this.setValue()}},ws.dom("ide-haskell-param-value",null,this.props.spec.displayTemplate(this.value)))}async update(e){if(e){const{pluginName:t,name:r,spec:n,store:i}=e;void 0!==t&&(this.props.pluginName=t),void 0!==r&&(this.props.name=r),n&&this.props.spec!==n&&(this.props.spec=n,this.initSpec()),i&&this.props.store!==i&&(this.props.store=i,this.initStore())}return ws.update(this)}async setValue(e){await this.props.store.setValue(this.props.pluginName,this.props.name,e),(0,E.handlePromise)(this.update())}async destroy(){await ws.destroy(this),this.disposables.dispose()}initStore(){this.storeDisposable&&this.disposables.remove(this.storeDisposable),this.storeDisposable=this.props.store.onDidUpdate(this.props.pluginName,this.props.name,({value:e})=>{this.value=e,(0,E.handlePromise)(this.update())}),this.disposables.add(this.storeDisposable),(0,E.handlePromise)(this.setValueInitial())}async setValueInitial(){return this.value=await this.props.store.getValueRaw(this.props.pluginName,this.props.name),this.update()}initSpec(){void 0===this.props.spec.displayName&&(this.props.spec.displayName=this.props.name.charAt(0).toUpperCase()+this.props.name.slice(1))}},jo.ParamControl=Eo;var ks={};Object.defineProperty(ks,"__esModule",{value:!0});var Os=void 0;ks.ConfigParamStore=Os;var Ps={};Object.defineProperty(Ps,"__esModule",{value:!0});var Ms=async function({items:e,heading:t,itemTemplate:r,itemFilterKey:n,activeItem:i}){const o=e=>{const t=document.createElement("li"),n=document.createElement("div");let o;return n.style.display="inline-block",r?(n.innerHTML=r(e),o=i&&r(e)===r(i)):(n.innerText=""+e,o=i&&e===i),o&&t.classList.add("active"),n.firstElementChild&&"LI"===n.firstElementChild.tagName&&(n.innerHTML=n.firstElementChild.innerHTML),t.appendChild(n),t},s=e=>"string"==typeof n?""+e[n]:n?n(e):""+e,a=await Promise.resolve(e);let l;try{return await new Promise(e=>{const r=new xa.default({items:a,infoMessage:t,itemsClassList:["ide-haskell","mark-active"],elementForItem:o,filterKeyForItem:s,didCancelSelection:()=>{e()},didConfirmSelection:t=>{e(t)}});r.element.classList.add("ide-haskell"),l=atom.workspace.addModalPanel({item:r,visible:!0}),r.focus()})}finally{l&&l.destroy()}};Ps.selectListView=Ms;var js;const{Disposable:Es,CompositeDisposable:Ss,TextEditor:xs}=u;var Cs,As,Ts={};As={onCopy:"copy",onCut:"cut",onPaste:"paste",onCompositionEnd:"compositionend",onCompositionStart:"compositionstart",onCompositionUpdate:"compositionupdate",onKeyDown:"keydown",onKeyPress:"keypress",onKeyUp:"keyup",onFocus:"focus",onBlur:"blur",onChange:"change",onInput:"input",onSubmit:"submit",onClick:"click",onContextMenu:"contextmenu",onDoubleClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragEnter:"dragenter",onDragExit:"dragexit",onDragLeave:"dragleave",onDragOver:"dragover",onDragStart:"dragstart",onDrop:"drop",onMouseDown:"mousedown",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onSelect:"select",onTouchCancel:"touchcancel",onTouchEnd:"touchend",onTouchMove:"touchmove",onTouchStart:"touchstart",onScroll:"scroll",onWheel:"wheel",onAbort:"abort",onCanPlay:"canplay",onCanPlayThrough:"canplaythrough",onDurationChange:"durationchange",onEmptied:"emptied",onEncrypted:"encrypted",onEnded:"ended",onError:"error",onLoadedData:"loadeddata",onLoadedMetadata:"loadedmetadata",onLoadStart:"loadstart",onPause:"pause",onPlay:"play",onPlaying:"playing",onProgress:"progress",onRateChange:"ratechange",onSeeked:"seeked",onSeeking:"seeking",onStalled:"stalled",onSuspend:"suspend",onTimeUpdate:"timeupdate",onVolumeChange:"volumechange",onWaiting:"waiting",onLoad:"load",onAnimationStart:"animationstart",onAnimationEnd:"animationend",onAnimationIteration:"animationiteration",onTransitionEnd:"transitionend"};var Ds={};function Is(e,t,...r){for(let e=0;e<r.length;){const t=r[e];switch(typeof t){case"string":case"number":r[e]={text:t},e++;break;case"object":Array.isArray(t)?r.splice(e,1,...t):t?e++:r.splice(e,1);break;default:throw new Error("Invalid child node: "+t)}}if(t){for(const e in t){const r=As[e];r&&(t.on||(t.on={}),t.on[r]=t[e])}t.class&&(t.className=t.class)}return{tag:e,props:t,children:r}}Ds=new Set(["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]);const Ns=["a","abbr","address","article","aside","audio","b","bdi","bdo","blockquote","body","button","canvas","caption","cite","code","colgroup","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","html","i","iframe","ins","kbd","label","legend","li","main","map","mark","menu","meter","nav","noscript","object","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","u","ul","var","video","area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];for(const e of Ns)Is[e]=(t,...r)=>Is(e,t,...r);for(const e of Ds)Is[e]=(t,...r)=>Is(e,t,...r);Cs=Is;var Rs,Ls={},Bs={};Bs=new Map([["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["className","class"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["panose1","panose-1"],["paintOrder","paint-order"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xHeight","x-height"]]);function Fs(e,t,r,n){if(t)for(var i in t)r&&i in r||(n?e[i]="":delete e[i]);if(r)for(var i in r){const n=t&&t[i],o=r[i];o!==n&&(e[i]=o)}}function Us(e,t,r){if(t)for(var n in t)r&&n in r||e.removeAttribute(n);if(r)for(var n in r){const i=t&&t[n],o=r[n];o!==i&&e.setAttribute(n,o)}}function zs(e,t){let r;if(null!=e.text)r=document.createTextNode(e.text);else{const{tag:n,children:i}=e;let{props:o}=e;if("function"==typeof n){let s;o&&o.ref&&(s=o.ref);const a=new n(o||{},i);e.component=a,r=a.element,t&&t.refs&&s&&(t.refs[s]=a)}else Ds.has(n)?(r=document.createElementNS("http://www.w3.org/2000/svg",n),i&&qs(r,i,t),o&&Rs(r,null,e,t)):(r=document.createElement(n),i&&qs(r,i,t),o&&Rs(r,null,e,t))}return e.domNode=r,r}function qs(e,t,r){for(let n=0;n<t.length;n++)e.appendChild(zs(t[n],r))}Rs=function(e,t,r,n){const i=t&&t.props,o=r.props;let s,a;n&&(s=n.refs,a=n.listenerContext),function e(t,r,n,i,o){if(n)for(var s in n)"ref"!==s&&"on"!==s&&(s in As||o&&s in o||("dataset"===s?e(t.dataset,null,n&&n.dataset,null,null):"innerHTML"!==s&&r&&Ds.has(r.tag)?t.removeAttribute(Bs.get(s)||s):(t[s]="",delete t[s])));if(o)for(var s in o)if("ref"!==s&&"on"!==s&&!(s in As)){var a=n&&n[s],l=o[s];"dataset"===s?Fs(t.dataset,a,l,!1):"style"===s&&"string"!=typeof l?("string"==typeof a&&(t.style="",a=null),Fs(t.style,a,l,!0)):"attributes"===s?Us(t,a,l):l!==a&&("innerHTML"!==s&&i&&Ds.has(i.tag)?t.setAttribute(Bs.get(s)||s,l):i&&"input"===i.tag&&"value"===s&&t[s]===l||(t[s]=l))}}(e,t,i,r,o),s&&function(e,t,r,n){r!==t&&(t&&n[t]===e&&delete n[t],r&&(n[r]=e))}(e,i&&i.ref,o&&o.ref,s),function(e,t,r,n){const i=t&&t.props&&t.props.on,o=r.props&&r.props.on;for(const r in i)if(!o||!(r in o)){let n;n=t&&t.boundListeners&&t.boundListeners[r]?t.boundListeners[r]:i[r],e.removeEventListener(r,n)}for(const s in o){const a=i&&i[s],l=o[s];if(l!==a){if(a){let r;r=t&&t.boundListeners&&t.boundListeners[s]?t.boundListeners[s]:a,e.removeEventListener(s,r)}if(l){let t;n?(t=l.bind(n),r.boundListeners||(r.boundListeners={}),r.boundListeners[s]=t):t=l,e.addEventListener(s,t)}}}}(e,t,r,a)},Ls=zs;var Vs,$s={};function Ws(e,t,r){const n=e.domNode;if(t===e)return n;if(Qs(e,t)){let i;return null!=t.text?(n.nodeValue=t.text,i=n):"function"==typeof t.tag?i=function(e,t,r){const{component:n,props:i}=e;let{props:o,children:s}=t;if(t.component=n,r&&r.refs){const e=r.refs,t=i&&i.ref,s=o&&o.ref;s!==t&&(t&&e[t]===n&&delete e[t],s&&(e[s]=n))}return n.update(o||{},s),n.element}(e,t,r):(!function(e,t,r,n){var i,o=0,s=t.length-1,a=t[0],l=t[s],u=0,c=r.length-1,p=r[0],d=r[c];for(;o<=s&&u<=c;)if(a)if(l)if(Qs(a,p))Ws(a,p,n),a=t[++o],p=r[++u];else if(Qs(l,d))Ws(l,d,n),l=t[--s],d=r[--c];else if(Qs(a,d))Ws(a,d,n),e.insertBefore(a.domNode,l.domNode.nextSibling),a=t[++o],d=r[--c];else if(Qs(l,p))Ws(l,p,n),e.insertBefore(l.domNode,a.domNode),l=t[--s],p=r[++u];else{i||(Hs.length>0?(i=Hs.pop()).clear():i=new Map,Xs(i,t,o,s));var h=Ks(p),f=h?i.get(h):null;if(null==f)e.insertBefore(Ls(p,n),a.domNode),p=r[++u];else{var v=t[f];Ws(v,p,n),t[f]=void 0,e.insertBefore(v.domNode,a.domNode),p=r[++u]}}else l=t[--s];else a=t[++o];if(o>s){var m=r[c+1]?r[c+1].domNode:null;for(let t=u;t<=c;t++)e.insertBefore(Ls(r[t],n),m)}else if(u>c)for(let e=o;e<=s;e++){var g=t[e];g&&Gs(g,n&&n.refs)}i&&Hs.push(i)}(n,e.children,t.children,r),Rs(n,e,t,r),i=n),t.domNode=i,i!==n&&n.parentNode&&n.parentNode.replaceChild(i,n),i}{const i=n.parentNode,o=n.nextSibling;Gs(e,r&&r.refs);const s=Ls(t,r);return i&&i.insertBefore(s,o),t.domNode=s,s}}let Hs=[new Map,new Map,new Map,new Map];function Gs(e,t,r=!0){const{domNode:n,props:i,children:o,component:s}=e,a=i&&i.ref;if(s)t&&a&&t[a]===s&&delete t[a],s.destroy&&s.destroy();else if(t&&a&&t[a]===n&&delete t[a],o)for(let e=0;e<o.length;e++)Gs(o[e],t,!1);r&&n.remove()}function Qs(e,t){return Ks(e)===Ks(t)&&e.tag===t.tag}function Ks(e){return e.props?e.props.key:void 0}function Xs(e,t,r,n){for(let i=r;i<=n;i++){const r=Ks(t[i]);r&&e.set(r,i)}return e}$s=Ws;var Ys;Ys=class{constructor(){this.updateRequests=[],this.readRequests=[],this.pendingAnimationFrame=null,this.performUpdates=this.performUpdates.bind(this),this.performingUpdates=!1}updateDocument(e){this.updateRequests.push(e),this.pendingAnimationFrame||(this.pendingAnimationFrame=window.requestAnimationFrame(this.performUpdates))}readDocument(e){this.readRequests.push(e),this.pendingAnimationFrame||(this.pendingAnimationFrame=window.requestAnimationFrame(this.performUpdates))}getNextUpdatePromise(){return this.nextUpdatePromise||(this.nextUpdatePromise=new Promise(e=>{this.resolveNextUpdatePromise=e})),this.nextUpdatePromise}performUpdates(){for(;this.updateRequests.length>0;)this.updateRequests.shift()();for(this.pendingAnimationFrame=null;this.readRequests.length>0;)this.readRequests.shift()();if(this.nextUpdatePromise){let e=this.resolveNextUpdatePromise;this.nextUpdatePromise=null,this.resolveNextUpdatePromise=null,e()}}};let Zs=null;var Js=function(){return Zs||(Zs=new Ys),Zs};const ea=new WeakSet;let ta=0,ra=0;function na(e){return null!=e&&!1!==e}function ia(e,t=!0){if(!na(e.virtualNode))throw new Error((e.constructor?e.constructor.name+" instance":e)+" is not associated with a valid virtualNode. Perhaps this component was never initialized?");if(null==e.element)throw new Error((e.constructor?e.constructor.name+" instance":e)+" is not associated with a DOM element. Perhaps this component was never initialized?");let r=e.render();if(!na(r)){const t=e.constructor&&e.constructor.name?" in "+e.constructor.name:"";throw new Error("invalid falsy value "+r+" returned from render()"+t)}ta++;let n=e.virtualNode,i=e.element,o=$s(n,r,{refs:e.refs,listenerContext:e});if(e.virtualNode=r,o!==i&&!t)throw new Error("The root node type changed on update, but the update was performed with the replaceNode option set to false");e.element=o,"function"==typeof e.writeAfterUpdate&&e.writeAfterUpdate(),"function"==typeof e.readAfterUpdate&&Js().readDocument((function(){e.readAfterUpdate()})),ta--}function oa(e,t=!0){ra++,sa(e.virtualNode),1===ra&&t&&e.element.remove(),ra--}function sa(e){e.component&&"function"==typeof e.component.destroy?e.component.destroy():e.children&&e.children.forEach(sa)}Vs={initialize:function(e){if("function"!=typeof e.update)throw new Error("Etch components must implement `update(props, children)`.");let t=e.render();if(!na(t)){let r=e.constructor&&e.constructor.name?" in "+e.constructor.name:"";throw new Error("invalid falsy value "+t+" returned from render()"+r)}e.refs={},e.virtualNode=t,e.element=Ls(e.virtualNode,{refs:e.refs,listenerContext:e})},update:function(e,t=!0){if(ta>0)return ia(e,t),Promise.resolve();let r=Js();return ea.has(e)||(ea.add(e),r.updateDocument((function(){ea.delete(e),ia(e,t)}))),r.getNextUpdatePromise()},updateSync:ia,destroy:function(e,t=!0){if(ta>0||ra>0)return oa(e,t),Promise.resolve();let r=Js();return r.updateDocument((function(){oa(e,t)})),r.getNextUpdatePromise()},destroySync:oa};const{initialize:aa,update:la,updateSync:ua,destroy:ca,destroySync:pa}=Vs,da=(Ts={dom:Cs,render:Ls,initialize:aa,update:la,updateSync:ua,destroy:ca,destroySync:pa,setScheduler:function(e){Zs=e},getScheduler:Js}).dom;var ha,fa,va,ma={},ga=!1;function ya(){return ga||(ga=!0,function(){var e,t;e=a.sep,ha=function(t,r,n){var i,o,s,a,l;for(o=t.length-1;t[o]===e;)o--;for(l=0,s=o,i=null;o>=0;)t[o]===e?(l++,null==i&&(i=t.substring(o+1,s+1))):0===o&&(s<t.length-1?null==i&&(i=t.substring(0,s+1)):null==i&&(i=t)),o--;return i===t?n*=2:i&&(n+=fa(i,r)),a=l+1,n*=.01*Math.max(1,10-a)},va.basenameScore=ha,fa=function(r,n){var i,o,s,a,l,u,c,p,d,h,f,v;if(r===n)return 1;if(t(r,n))return 1;for(h=0,c=n.length,d=r.length,s=0,a=0;s<c;){if(i=n[s++],l=r.indexOf(i.toLowerCase()),f=r.indexOf(i.toUpperCase()),-1===(u=Math.min(l,f))&&(u=Math.max(l,f)),-1===(a=u))return 0;o=.1,r[a]===i&&(o+=.1),0===a||r[a-1]===e?o+=.8:"-"!==(v=r[a-1])&&"_"!==v&&" "!==v||(o+=.7),r=r.substring(a+1,d),h+=o}return((p=h/c)*(c/d)+p)/2},va.score=fa,t=function(t,r){if(t[t.length-r.length-1]===e)return t.lastIndexOf(r)===t.length-r.length}}.call(va={})),va}var ba,wa=!1;function _a(){return wa||(wa=!0,function(){var e,t,r;t=ya(),e=function(e){return e.candidate},r=function(e,t){return t.score-e.score},ba=function(n,i,o,s){var a,l,u,c,p,d,h,f,v;if(l=(v=null!=s?s:{}).key,u=v.maxResults,i){for(p=[],h=0,f=n.length;h<f;h++)a=n[h],(d=null!=l?a[l]:a)&&(c=t.score(d,i,o),o||(c=t.basenameScore(d,i,c)),c>0&&p.push({candidate:a,score:c}));p.sort(r),n=p.map(e)}return null!=u&&(n=n.slice(0,u)),n}}.call(ba={})),ba}var ka,Oa,Pa,Ma=!1;function ja(){return Ma||(Ma=!0,function(){var e;e=a.sep,ka=function(t,r){var n,i,o;for(i=t.length-1;t[i]===e;)i--;for(o=i,n=null;i>=0;)t[i]===e?null==n&&(n=t.substring(i+1,o+1)):0===i&&(o<t.length-1?null==n&&(n=t.substring(0,o+1)):null==n&&(n=t)),i--;return Oa(n,r,t.length-n.length)},Pa.basenameMatch=ka,Oa=function(e,t,r){var n,i,o,s,a,l,u,c,p,d;if(null==r&&(r=0),e===t)return function(){d=[];for(var t=r,n=r+e.length;r<=n?t<n:t>n;r<=n?t++:t--)d.push(t);return d}.apply(this);for(u=t.length,c=e.length,i=0,o=0,a=[];i<u;){if(n=t[i++],s=e.indexOf(n.toLowerCase()),p=e.indexOf(n.toUpperCase()),-1===(l=Math.min(s,p))&&(l=Math.max(s,p)),-1===(o=l))return[];a.push(r+o),r+=o+1,e=e.substring(o+1,c)}return a},Pa.match=Oa}.call(Pa={})),Pa}(function(){var e,t,r,n,i;i=ya(),r=_a(),n=ja(),e=a.sep,t=/\ /g,ma={filter:function(n,i,o){var s;return i&&(s=-1!==i.indexOf(e),i=i.replace(t,"")),r(n,i,s,o)},score:function(r,n){var o,s;return r&&n?r===n?2:(o=-1!==n.indexOf(e),n=n.replace(t,""),s=i.score(r,n),o||(s=i.basenameScore(r,n,s)),s):0},match:function(r,i){var o,s,a,l,u,c;if(!r)return[];if(!i)return[];if(r===i)return function(){c=[];for(var e=0,t=r.length;0<=t?e<t:e>t;0<=t?e++:e--)c.push(e);return c}.apply(this);if(l=-1!==i.indexOf(e),i=i.replace(t,""),a=n.match(r,i),!l)for(o=n.basenameMatch(r,i),a=a.concat(o).sort((function(e,t){return e-t})),u=null,s=0;s<a.length;)s&&u===a[s]?a.splice(s,1):(u=a[s],s++);return a}}}).call(ma),js=class{static setScheduler(e){Ts.setScheduler(e)}static getScheduler(e){return Ts.getScheduler()}constructor(e){this.props=e,this.props.hasOwnProperty("initialSelectionIndex")||(this.props.initialSelectionIndex=0),e.initiallyVisibleItemCount&&this.initializeVisibilityObserver(),this.computeItems(!1),this.disposables=new Ss,Ts.initialize(this),this.element.classList.add("select-list"),this.disposables.add(this.refs.queryEditor.onDidChange(this.didChangeQuery.bind(this))),e.skipCommandsRegistration||this.disposables.add(this.registerAtomCommands());const t=this.refs.queryEditor.element,r=this.didLoseFocus.bind(this);t.addEventListener("blur",r),this.didClickItemsList=!1,this.element.addEventListener("mousedown",e=>{e.target===this.refs.items&&(this.didClickItemsList=!0)}),this.disposables.add(new Es(()=>{t.removeEventListener("blur",r)}))}initializeVisibilityObserver(){this.visibilityObserver=new IntersectionObserver(e=>{for(const t of e)if(t.intersectionRatio>0){const e=t.target;this.visibilityObserver.unobserve(e);const r=Array.from(this.refs.items.children).indexOf(e);r>=0&&this.renderItemAtIndex(r)}})}focus(){this.refs.queryEditor.element.focus()}didLoseFocus(e){this.didClickItemsList||this.element.contains(e.relatedTarget)?(this.didClickItemsList=!1,this.refs.queryEditor.element.focus()):document.hasFocus()&&this.cancelSelection()}reset(){this.refs.queryEditor.setText("")}destroy(){return this.disposables.dispose(),this.visibilityObserver&&this.visibilityObserver.disconnect(),Ts.destroy(this)}registerAtomCommands(){return c.atom.commands.add(this.element,{"core:move-up":e=>{this.selectPrevious(),e.stopPropagation()},"core:move-down":e=>{this.selectNext(),e.stopPropagation()},"core:move-to-top":e=>{this.selectFirst(),e.stopPropagation()},"core:move-to-bottom":e=>{this.selectLast(),e.stopPropagation()},"core:confirm":e=>{this.confirmSelection(),e.stopPropagation()},"core:cancel":e=>{this.cancelSelection(),e.stopPropagation()}})}update(e={}){let t=!1;return e.hasOwnProperty("items")&&(this.props.items=e.items,t=!0),e.hasOwnProperty("maxResults")&&(this.props.maxResults=e.maxResults,t=!0),e.hasOwnProperty("filter")&&(this.props.filter=e.filter,t=!0),e.hasOwnProperty("filterQuery")&&(this.props.filterQuery=e.filterQuery,t=!0),e.hasOwnProperty("query")&&(this.refs.queryEditor.setText(e.query),t=!1),e.hasOwnProperty("selectQuery")&&(e.selectQuery?this.refs.queryEditor.selectAll():this.refs.queryEditor.clearSelections()),e.hasOwnProperty("order")&&(this.props.order=e.order),e.hasOwnProperty("emptyMessage")&&(this.props.emptyMessage=e.emptyMessage),e.hasOwnProperty("errorMessage")&&(this.props.errorMessage=e.errorMessage),e.hasOwnProperty("infoMessage")&&(this.props.infoMessage=e.infoMessage),e.hasOwnProperty("loadingMessage")&&(this.props.loadingMessage=e.loadingMessage),e.hasOwnProperty("loadingBadge")&&(this.props.loadingBadge=e.loadingBadge),e.hasOwnProperty("itemsClassList")&&(this.props.itemsClassList=e.itemsClassList),e.hasOwnProperty("initialSelectionIndex")&&(this.props.initialSelectionIndex=e.initialSelectionIndex),t&&this.computeItems(),Ts.update(this)}render(){return da.div({},da(xs,{ref:"queryEditor",mini:!0}),this.renderLoadingMessage(),this.renderInfoMessage(),this.renderErrorMessage(),this.renderItems())}renderItems(){if(this.items.length>0){const e=["list-group"].concat(this.props.itemsClassList||[]).join(" ");return this.visibilityObserver&&Ts.getScheduler().updateDocument(()=>{Array.from(this.refs.items.children).slice(this.props.initiallyVisibleItemCount).forEach(e=>{this.visibilityObserver.observe(e)})}),this.listItems=this.items.map((e,t)=>{const r=this.getSelectedItem()===e,n=!this.props.initiallyVisibleItemCount||t<this.props.initiallyVisibleItemCount;return da(Ea,{element:this.props.elementForItem(e,{selected:r,index:t,visible:n}),selected:r,onclick:()=>this.didClickItem(t)})}),da.ol({className:e,ref:"items"},...this.listItems)}return!this.props.loadingMessage&&this.props.emptyMessage?da.span({ref:"emptyMessage"},this.props.emptyMessage):""}renderErrorMessage(){return this.props.errorMessage?da.span({ref:"errorMessage"},this.props.errorMessage):""}renderInfoMessage(){return this.props.infoMessage?da.span({ref:"infoMessage"},this.props.infoMessage):""}renderLoadingMessage(){return this.props.loadingMessage?da.div({className:"loading"},da.span({ref:"loadingMessage",className:"loading-message"},this.props.loadingMessage),this.props.loadingBadge?da.span({ref:"loadingBadge",className:"badge"},this.props.loadingBadge):""):""}getQuery(){return this.refs&&this.refs.queryEditor?this.refs.queryEditor.getText():""}getFilterQuery(){return this.props.filterQuery?this.props.filterQuery(this.getQuery()):this.getQuery()}didChangeQuery(){this.props.didChangeQuery&&this.props.didChangeQuery(this.getFilterQuery()),this.computeItems()}didClickItem(e){this.selectIndex(e),this.confirmSelection()}computeItems(e){this.listItems=null,this.visibilityObserver&&this.visibilityObserver.disconnect();const t=this.props.filter||this.fuzzyFilter.bind(this);this.items=t(this.props.items.slice(),this.getFilterQuery()),this.props.order&&this.items.sort(this.props.order),this.props.maxResults&&(this.items=this.items.slice(0,this.props.maxResults)),this.selectIndex(this.props.initialSelectionIndex,e)}fuzzyFilter(e,t){if(0===t.length)return e;{const r=[];for(const n of e){const e=this.props.filterKeyForItem?this.props.filterKeyForItem(n):n;let i=ma.score(e,t);i>0&&r.push({item:n,score:i})}return r.sort((e,t)=>t.score-e.score),r.map(e=>e.item)}}getSelectedItem(){return void 0===this.selectionIndex?null:this.items[this.selectionIndex]}renderItemAtIndex(e){const t=this.items[e],r=this.getSelectedItem()===t,n=this.listItems[e].component;this.visibilityObserver&&this.visibilityObserver.unobserve(n.element),n.update({element:this.props.elementForItem(t,{selected:r,index:e,visible:!0}),selected:r,onclick:()=>this.didClickItem(e)})}selectPrevious(){return void 0===this.selectionIndex?this.selectLast():this.selectIndex(this.selectionIndex-1)}selectNext(){return void 0===this.selectionIndex?this.selectFirst():this.selectIndex(this.selectionIndex+1)}selectFirst(){return this.selectIndex(0)}selectLast(){return this.selectIndex(this.items.length-1)}selectNone(){return this.selectIndex(void 0)}selectIndex(e,t=!0){e>=this.items.length?e=0:e<0&&(e=this.items.length-1);const r=this.selectionIndex;return this.selectionIndex=e,void 0!==e&&this.props.didChangeSelection&&this.props.didChangeSelection(this.getSelectedItem()),t?this.listItems?(r>=0&&this.renderItemAtIndex(r),e>=0&&this.renderItemAtIndex(e),Ts.getScheduler().getNextUpdatePromise()):Ts.update(this):Promise.resolve()}selectItem(e){const t=this.items.indexOf(e);if(-1===t)throw new Error("Cannot select the specified item because it does not exist.");return this.selectIndex(t)}confirmSelection(){const e=this.getSelectedItem();null!=e?this.props.didConfirmSelection&&this.props.didConfirmSelection(e):this.props.didConfirmEmptySelection&&this.props.didConfirmEmptySelection()}cancelSelection(){this.props.didCancelSelection&&this.props.didCancelSelection()}};class Ea{constructor(e){this.mouseDown=this.mouseDown.bind(this),this.mouseUp=this.mouseUp.bind(this),this.didClick=this.didClick.bind(this),this.selected=e.selected,this.onclick=e.onclick,this.element=e.element,this.element.addEventListener("mousedown",this.mouseDown),this.element.addEventListener("mouseup",this.mouseUp),this.element.addEventListener("click",this.didClick),this.selected&&this.element.classList.add("selected"),this.domEventsDisposable=new Es(()=>{this.element.removeEventListener("mousedown",this.mouseDown),this.element.removeEventListener("mouseup",this.mouseUp),this.element.removeEventListener("click",this.didClick)}),Ts.getScheduler().updateDocument(this.scrollIntoViewIfNeeded.bind(this))}mouseDown(e){e.preventDefault()}mouseUp(e){e.preventDefault()}didClick(e){e.preventDefault(),this.onclick()}destroy(){this.element.remove(),this.domEventsDisposable.dispose()}update(e){this.element.removeEventListener("mousedown",this.mouseDown),this.element.removeEventListener("mouseup",this.mouseUp),this.element.removeEventListener("click",this.didClick),this.element.parentNode.replaceChild(e.element,this.element),this.element=e.element,this.element.addEventListener("mousedown",this.mouseDown),this.element.addEventListener("mouseup",this.mouseUp),this.element.addEventListener("click",this.didClick),e.selected&&this.element.classList.add("selected"),this.selected=e.selected,this.onclick=e.onclick,Ts.getScheduler().updateDocument(this.scrollIntoViewIfNeeded.bind(this))}scrollIntoViewIfNeeded(){this.selected&&this.element.scrollIntoViewIfNeeded(!1)}}var Sa,xa=(Sa=js)&&Sa.__esModule?Sa:{default:Sa};var Ca=u;Os=class{constructor(e={}){this.disposables=new Ca.CompositeDisposable,this.emitter=new Ca.Emitter,this.disposables.add(this.emitter),this.saved=e,this.plugins=new Map}serialize(){return this.saved}destroy(){this.disposables.dispose()}onDidUpdate(e,t,r){return this.emitter.on("did-update",n=>{n.pluginName===e&&n.paramName===t&&r(n)})}addParamSpec(e,t,r){let n=this.plugins.get(e);if(n||(n=new Map,this.plugins.set(e,n)),n.has(t))throw new Error(`Parameter ${e}.${t} already defined!`);let i=this.saved[`${e}.${t}`];return void 0===i&&(i=r.default),n.set(t,{spec:r,value:i}),this.emitter.emit("did-update",{pluginName:e,paramName:t,value:i}),new Ca.Disposable(()=>{n&&(n.delete(t),0===n.size&&this.plugins.delete(e))})}async setValue(e,t,r){const n=await this.getParamConfig(e,t,"set");if(void 0!==n)return void 0===r&&(r=await this.showSelect(n)),void 0!==r&&(n.value=r,this.saved[`${e}.${t}`]=r,this.emitter.emit("did-update",{pluginName:e,paramName:t,value:r})),r}async getValue(e,t){const r=await this.getParamConfig(e,t,"get");if(void 0!==r)return void 0===r.value&&await this.setValue(e,t),r.value}async getValueRaw(e,t){const r=await this.getParamConfig(e,t,"get raw");if(void 0!==r)return r.value}async getParamConfig(e,t,r){if(!atom.packages.isPackageLoaded(e))return void console.error(new Error(`No ${e} package while trying to ${r} ${e}.${t}`));atom.packages.isPackageActive(e)||await atom.packages.activatePackage(e);const n=this.plugins.get(e);if(!n)throw new Error(`${e} is not defined while trying to ${r} ${e}.${t}`);const i=n.get(t);if(!i)throw new Error(`${t} is not defined while trying to ${r} ${e}.${t}`);return i}async showSelect(e){const t=e.spec;return(0,Ps.selectListView)({items:"function"==typeof t.items?t.items():t.items,heading:t.description,itemTemplate:t.itemTemplate.bind(t),itemFilterKey:t.itemFilterKey,activeItem:e.value})}},ks.ConfigParamStore=Os;Po=class{constructor(e,t){this.outputPanel=e,this.store=new ks.ConfigParamStore(t)}destroy(){this.store.destroy()}serialize(){return this.store.serialize()}add(e,t,r){const n=new Mo.CompositeDisposable;return n.add(this.store.addParamSpec(e,t,r),this.outputPanel.addPanelControl({element:jo.ParamControl,opts:{pluginName:e,name:t,spec:r,store:this.store}})),n}async get(e,t){return this.store.getValue(e,t)}async set(e,t,r){return this.store.setValue(e,t,r)}},Oo.ConfigParamManager=Po;var Aa={};Object.defineProperty(Aa,"__esModule",{value:!0});var Ta=void 0;Aa.EditorControl=Ta;var Da=u,Ia={};Object.defineProperty(Ia,"__esModule",{value:!0});var Na=void 0;Ia.TooltipManager=Na;var Ra={};Object.defineProperty(Ra,"__esModule",{value:!0});var La=void 0;Ra.TooltipMessage=La;var Ba=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=Fa();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(bs());function Fa(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return Fa=function(){return e},e}La=class{constructor(e){Array.isArray(e)?this.message=e.map(e=>Ba.dom("div",{key:e,innerHTML:e.toHtml()})):this.message=[Ba.dom("div",{key:e,innerHTML:e.toHtml()})],Ba.initialize(this)}render(){return Ba.dom("ide-haskell-tooltip",null,this.message)}async update(){return Ba.update(this)}writeAfterUpdate(){this.element.parentElement&&this.element.parentElement.classList.add("ide-haskell")}},Ra.TooltipMessage=La;var Ua={};Object.defineProperty(Ua,"__esModule",{value:!0});var za=void 0;Ua.EventTable=za;za=class{constructor(e,t){this.editor=e,this.table=Object.create(null);for(const e of E.eventRangeTypeVals)this.table[e]=new Map;this.layers=new Set;for(const e of t){const t=this.editor.addMarkerLayer();this.layers.add(t);for(const{type:r,source:n}of e)this.table[r].set(n,t)}}destroy(){for(const e of this.layers.values())e.destroy();for(const e of this.values())e.clear()}get(e,t){const r=this.table[e];let n=r.get(t);if(n||(n=r.get(void 0)),!n)throw new Error(`Failed to classify ${e}:${t}`);return n}clear(){for(const e of this.layers.values())e.clear()}getMarkerCount(){let e=0;for(const t of this.layers.values())e+=t.getMarkerCount();return e}*values(){for(const e of E.eventRangeTypeVals)yield this.table[e]}*entries(){for(const e of E.eventRangeTypeVals)yield[e,this.table[e]]}},Ua.EventTable=za;Na=class{constructor(e){this.editor=e,this.markers=new Ua.EventTable(e,[[{type:"keyboard"},{type:"context"}],[{type:"mouse"},{type:"selection"}]]),this.editorElement=atom.views.getView(this.editor)}dispose(){this.markers.destroy(),this.editorElement.classList.remove("ide-haskell--has-tooltips")}show(e,t,r,n,i){this.hide(r,n);const o=this.markers.get(r,n).markBufferRange(e);o.setProperties(i),this.decorate(o,new Ra.TooltipMessage(t)),this.editorElement.classList.add("ide-haskell--has-tooltips")}hide(e,t,r){void 0!==e?(r?this.markers.get(e,t).findMarkers(r).forEach(e=>e.destroy()):this.markers.get(e,t).clear(),this.has()||this.editorElement.classList.remove("ide-haskell--has-tooltips")):this.markers.clear()}has(e,t,r){return void 0===e?this.markers.getMarkerCount()>0:r?this.markers.get(e,t).findMarkers(r).length>0:this.markers.get(e,t).getMarkerCount()>0}decorate(e,t){this.editor.decorateMarker(e,{type:"overlay",position:"tail",item:t}),this.editor.decorateMarker(e,{type:"highlight",class:"ide-haskell-type"})}},Ia.TooltipManager=Na;Ta=class{constructor(e,t){this.editor=e,this.trackMouseBufferPosition=e=>{const t=(0,E.bufferPositionFromMouseEvent)(this.editor,e);t&&(this.lastMouseBufferPt&&this.lastMouseBufferPt.isEqual(t)||(this.lastMouseBufferPt=t,void 0!==this.exprTypeTimeout&&clearTimeout(this.exprTypeTimeout),this.exprTypeTimeout=window.setTimeout(()=>{this.shouldShowTooltip(t,"mouse")},atom.config.get("ide-haskell.expressionTypeInterval",{scope:this.editor.getRootScopeDescriptor()}))))},this.stopTrackingMouseBufferPosition=()=>{if(void 0!==this.exprTypeTimeout)return clearTimeout(this.exprTypeTimeout)},this.trackSelection=({newBufferRange:e})=>{this.handleCursorUnderTooltip(e),void 0!==this.selTimeout&&clearTimeout(this.selTimeout),e.isEmpty()?(this.tooltips.hide("selection"),void 0!==this.exprTypeTimeout&&clearTimeout(this.exprTypeTimeout),(0,E.handlePromise)(this.tooltipRegistry.showTooltip(this.editor,"keyboard")),"Hide Tooltip"===atom.config.get("ide-haskell.onCursorMove",{scope:this.editor.getRootScopeDescriptor()})&&(this.tooltips.hide("mouse",void 0,{persistent:!1}),this.tooltips.hide("context",void 0,{persistent:!1}))):this.selTimeout=window.setTimeout(()=>this.shouldShowTooltip(e.start,"selection"),atom.config.get("ide-haskell.expressionTypeInterval",{scope:this.editor.getRootScopeDescriptor()}))},this.disposables=new Da.CompositeDisposable,this.tooltips=new Ia.TooltipManager(this.editor),this.disposables.add(this.tooltips),this.tooltipRegistry=t.tooltipRegistry,this.editorElement=atom.views.getView(this.editor);const r=this.editor.getBuffer();this.disposables.add(r.onWillSave(async()=>{await t.willSaveBuffer(r)}),r.onDidSave(()=>t.didSaveBuffer(r)),this.editor.onDidStopChanging(()=>t.didStopChanging(r)),this.editorElement.onDidChangeScrollLeft(()=>this.tooltips.hide("mouse")),this.editorElement.onDidChangeScrollTop(()=>this.tooltips.hide("mouse")),(0,E.listen)(this.editorElement,"mousemove",".scroll-view",this.trackMouseBufferPosition),(0,E.listen)(this.editorElement,"mouseout",".scroll-view",this.stopTrackingMouseBufferPosition),this.editor.onDidChangeSelectionRange(this.trackSelection))}static supportsGrammar(e){return["source.haskell","text.tex.latex.haskell"].includes(e)}destroy(){void 0!==this.exprTypeTimeout&&clearTimeout(this.exprTypeTimeout),void 0!==this.selTimeout&&clearTimeout(this.selTimeout),this.disposables.dispose(),this.lastMouseBufferPt=void 0}getEventRange(e){let t,r;switch(e){case"mouse":case"context":if(!this.lastMouseBufferPt)return;r=this.lastMouseBufferPt;const e=this.editor.getSelections().map(e=>e.getBufferRange()).filter(e=>e.containsPoint(r));t=e.length>0?e[0]:new Da.Range(r,r);break;case"keyboard":case"selection":t=this.editor.getLastSelection().getBufferRange(),r=t.start;break;default:throw new TypeError("Switch assertion failed")}return{crange:t,pos:r,eventType:e}}shouldShowTooltip(e,t){e.row<0||e.row>=this.editor.getLineCount()||e.isEqual(this.editor.getBuffer().rangeForRow(e.row,!1).end)?this.tooltips.hide(t):(0,E.handlePromise)(this.tooltipRegistry.showTooltip(this.editor,t))}handleCursorUnderTooltip(e){const t=document.querySelector("ide-haskell-tooltip");if(!t)return;const r=this.editorElement.pixelRectForScreenRange(this.editor.screenRangeForBufferRange(e)),n=this.editorElement.querySelector(".scroll-view");if(!n)return;const i=n.getBoundingClientRect(),o=t.getBoundingClientRect(),s=t.querySelector("div");if(!s)return;const a=s.getBoundingClientRect(),l={left:o.left-i.left,top:a.top-i.top,width:o.width,height:a.height},u=Math.round(Math.max(l.left,r.left)),c=Math.round(Math.min(l.left+l.width,r.left+r.width)),p=Math.round(Math.max(l.top,r.top)),d=Math.round(Math.min(l.top+l.height,r.top+r.height)),h=document.querySelector("ide-haskell-tooltip");h&&(p<=d&&u<=c?h.classList.add("ide-haskell-tooltip-subdued"):h.classList.remove("ide-haskell-tooltip-subdued"))}},Aa.EditorControl=Ta;var qa={};Object.defineProperty(qa,"__esModule",{value:!0});var Va=void 0;qa.LinterSupport=Va;var $a=u;Va=class{constructor(e,t){this.linter=e,this.resultDb=t,this.update=()=>{this.linter.clearMessages(),this.linter.setAllMessages(Array.from(this.messages()))},this.disposables=new $a.CompositeDisposable,this.disposables.add(t.onDidUpdate(this.update))}destroy(){this.disposables.dispose(),this.linter.dispose()}*messages(){for(const e of this.resultDb.results())if(void 0!==e.uri&&e.position){let t;switch(e.severity){case"error":case"warning":t=e.severity;break;default:t="info"}yield{severity:t,excerpt:e.message.toPlain(),location:{file:e.uri,position:new $a.Range(e.position,e.position.translate([0,1]))}}}}},qa.LinterSupport=Va;var Wa={};Object.defineProperty(Wa,"__esModule",{value:!0});var Ha=void 0;Wa.TooltipRegistry=Ha;var Ga=u;Ha=class{constructor(e){this.pluginManager=e,this.providers=[]}dispose(){this.providers=[]}register(e,t){const r=this.providers.findIndex(({priority:e})=>e<t.priority),n={pluginName:e,eventTypes:t.eventTypes?t.eventTypes:["selection","mouse"],priority:t.priority,handler:t.handler};return-1===r?this.providers.push(n):this.providers.splice(r,0,n),new Ga.Disposable(()=>{const e=this.providers.indexOf(n);this.providers.splice(e,1)})}async showTooltip(e,t,r){const n=this.pluginManager.controller(e);if(!n)return;let i,o;if(r&&"function"!=typeof r.tooltip)o=r.tooltip,i=r.pluginName;else{const s=n.getEventRange(t);if(!s)return;if(r&&"function"==typeof r.tooltip){i=r.pluginName;const e=this.pluginManager.getAwaiter(i),t=r.tooltip,n=await e(()=>t(s.crange));if(void 0===n)return;o=n}else{const r=await this.defaultTooltipFunction(e,t,s.crange);if(!r)return void n.tooltips.hide(t,void 0,{persistent:!1});({pluginName:i,tooltipData:o}=r)}const a=n.getEventRange(t);if(!a||!s.crange.isEqual(a.crange))return}const{persistent:s=!1}=o;let a;a=Array.isArray(o.text)?o.text.map(E.MessageObject.fromObject):E.MessageObject.fromObject(o.text),n.tooltips.show(Ga.Range.fromObject(o.range),a,t,i,{persistent:s})}hideTooltip(e,t,r){const n=this.pluginManager.controller(e);n&&n.tooltips.hide(t,r)}async defaultTooltipFunction(e,t,r){for(const{pluginName:n,handler:i,eventTypes:o}of this.providers){if(!o.includes(t))continue;const s=this.pluginManager.getAwaiter(n),a=await s(()=>i(e,r,t));if(void 0!==a)return{pluginName:n,tooltipData:a}}}},Wa.TooltipRegistry=Ha;var Qa={};Object.defineProperty(Qa,"__esModule",{value:!0});var Ka=void 0;Qa.CheckResultsProvider=Ka;var Xa=u,Ya={};Object.defineProperty(Ya,"__esModule",{value:!0});var Za=void 0;Ya.CREditorControl=Za;var Ja=u;Za=class{constructor(e,t){this.editor=e,this.updateResults=()=>{const e=this.editor.getPath(),t=Array.from(this.resultsDB.filter(t=>t.uri===e&&t.isValid())),r=this.markers.getMarkers(),n=t.filter(e=>r.every(t=>this.markerProps.get(t)!==e));r.filter(e=>{const r=this.markerProps.get(e);return!r||!t.includes(r)}).forEach(e=>e.destroy());for(const e of n)this.markerFromCheckResult(e)};const r=this.editor.gutterWithName("ide-haskell-check-results");this.gutter=r||this.editor.addGutter({name:"ide-haskell-check-results",priority:10}),this.gutterElement=atom.views.getView(this.gutter),this.resultsDB=t.resultsDB,this.tooltipRegistry=t.tooltipRegistry,this.disposables=new Ja.CompositeDisposable,this.markers=e.addMarkerLayer({maintainHistory:!0,persistent:!1}),this.markerProps=new WeakMap,this.disposables.add(this.resultsDB.onDidUpdate(this.updateResults)),this.updateResults(),this.registerGutterEvents()}static supportsGrammar(e){return["source.c2hs","source.hsc2hs","source.haskell","text.tex.latex.haskell","source.hsig"].includes(e)}destroy(){this.markers.destroy(),this.disposables.dispose();try{this.gutter.destroy()}catch(e){console.warn(e)}}getMessageAt(e,t){const r=this.find(e,t),n=[];for(const e of r){if(!e.isValid())continue;const t=this.markerProps.get(e);t&&n.push(t.message)}return n}registerGutterEvents(){this.disposables.add((0,E.listen)(this.gutterElement,"mouseover",".decoration",e=>{const t=(0,E.bufferPositionFromMouseEvent)(this.editor,e);if(t){const e=this.getMessageAt(t,"gutter");e.length>0&&(0,E.handlePromise)(this.tooltipRegistry.showTooltip(this.editor,"mouse",{pluginName:"builtin:check-results",tooltip:{text:e,range:new Ja.Range(t,t)}}))}})),this.disposables.add((0,E.listen)(this.gutterElement,"mouseout",".decoration",()=>this.tooltipRegistry.hideTooltip(this.editor,"mouse","builtin:check-results")))}markerFromCheckResult(e){const{position:t}=e;if(!t)return;const r=new Ja.Range(t,Ja.Point.fromObject([t.row,t.column+1])),n=this.markers.markBufferRange(r,{invalidate:"inside"});this.markerProps.set(n,e);const i=new Ja.CompositeDisposable;i.add(n.onDidDestroy(()=>{this.markerProps.delete(n),i.dispose()}),n.onDidChange(({isValid:t})=>{e.setValid(t)})),this.decorateMarker(n,e)}decorateMarker(e,t){const r={class:"ide-haskell-"+t.severity};this.gutter.decorateMarker(e,{type:"line-number",...r}),this.editor.decorateMarker(e,{type:"highlight",...r})}find(e,t){switch(t){case"gutter":return this.markers.findMarkers({startBufferRow:e.row});case"keyboard":return this.markers.findMarkers({startBufferPosition:e});case"mouse":return this.markers.findMarkers({containsBufferPosition:e});default:throw new TypeError("Switch assertion failed")}}},Ya.CREditorControl=Za;Ka=class{constructor(e){this.pluginManager=e,this.tooltipProvider=(e,t,r)=>{const n=this.pluginManager.controllerType(Ya.CREditorControl,e);if(!n)return;if("keyboard"===r&&"Show Tooltip"!==atom.config.get("ide-haskell.onCursorMove",{scope:e.getRootScopeDescriptor()}))return;const i=n.getMessageAt(t.start,r);return i.length>0?{range:t,text:i}:void 0};const t=e.tooltipRegistry;this.disposables=new Xa.CompositeDisposable,this.disposables.add(t.register("builtin:check-results",{priority:1e3,handler:this.tooltipProvider,eventTypes:["mouse","keyboard"]}),e.addEditorController(Ya.CREditorControl))}destroy(){this.disposables.dispose()}},Qa.CheckResultsProvider=Ka;var el={};Object.defineProperty(el,"__esModule",{value:!0});var tl=void 0;el.StatusBarView=tl;var rl=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=nl();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(bs());function nl(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return nl=function(){return e},e}tl=class{constructor(e,t){this.panel=e,this.bsc=t,this.didClick=()=>{(0,E.handlePromise)(this.panel.toggle())},rl.initialize(this),this.disp=t.onDidUpdate(()=>{(0,E.handlePromise)(this.update())})}render(){return rl.dom("div",{class:"ide-haskell inline-block",on:{click:this.didClick}},rl.dom("span",null,rl.dom("ide-haskell-lambda",null),this.bsc.renderStatusIcon()))}async update(){return rl.update(this)}destroy(){this.disp.dispose(),(0,E.handlePromise)(rl.destroy(this))}},el.StatusBarView=tl;var il={};Object.defineProperty(il,"__esModule",{value:!0}),Object.defineProperty(il,"prettifyFile",{enumerable:!0,get:function(){return ol.prettifyFile}}),Object.defineProperty(il,"PrettifyEditorController",{enumerable:!0,get:function(){return tp.PrettifyEditorController}});var ol={};Object.defineProperty(ol,"__esModule",{value:!0});var sl=async function(e){const[t,...r]=e.getCursors().map(e=>e.getBufferPosition()),n="source.cabal"===e.getGrammar().scopeName?ll.format:Jc.format,i=(await(0,al.getRootDir)(e.getBuffer())).getPath();try{const{stdout:o,stderr:s}=await n(e.getText(),i,e.getRootScopeDescriptor());e.setText(o);const a=e.getLastCursor();a&&a.setBufferPosition(t,{autoscroll:!1}),r.forEach(t=>{e.addCursorAtBufferPosition(t,{autoscroll:!1})}),s.length>0&&atom.notifications.addWarning("Prettifier reported the following problems:",{detail:s,dismissable:!0})}catch(e){const t=e.error||e;let r=e.stderr?e.stderr.trim():"";t.message.includes(r)&&(r=""),atom.notifications.addError("Failed to prettify",{detail:`${r?r+"\n\n":""}${t.message}`,stack:t.stack,dismissable:!0})}};ol.prettifyFile=sl;var al=s,ll={};Object.defineProperty(ll,"__esModule",{value:!0});var ul=async function(e,t,r){const{path:n,fd:i}=await async function(e){return new Promise((t,r)=>{$c.open({prefix:"ide-haskell",suffix:".cabal"},(n,i)=>{if(n)return console.error(n),r(n);cl.writeSync(i.fd,e),t(i)})})}(e);try{const e=atom.config.get("ide-haskell.cabalPath",{scope:r}),{stderr:o}=await(0,Wc.runFilter)({command:e,args:["format",n],cwd:t});return{stdout:await Yc(n),stderr:o}}finally{cl.close(i,Zc),cl.unlink(n,Zc)}};ll.format=ul;var cl=Xc(o),pl={},dl=o,hl=a,fl=i,vl={};vl=dc,dc.sync=gc;var ml=n,gl=a,yl=o,bl={};bl=ic;var wl=o,_l={};_l=Nl,Nl.realpath=Nl,Nl.sync=Rl,Nl.realpathSync=Rl,Nl.monkeypatch=function(){kl.realpath=Nl,kl.realpathSync=Rl},Nl.unmonkeypatch=function(){kl.realpath=Ol,kl.realpathSync=Pl};var kl=o,Ol=kl.realpath,Pl=kl.realpathSync,Ml=process.version,jl=/^v[0-5]\./.test(Ml),El=a,Sl="win32"===process.platform,xl=o,Cl=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function Al(e){return"function"==typeof e?e:function(){var e;if(Cl){var t=new Error;e=function(e){e&&(t.message=e.message,r(e=t))}}else e=r;return e;function r(e){if(e){if(process.throwDeprecation)throw e;if(!process.noDeprecation){var t="fs: missing callback "+(e.stack||e.message);process.traceDeprecation?console.trace(t):console.error(t)}}}}()}El.normalize;if(Sl)var Tl=/(.*?)(?:[\/\\]+|$)/g;else Tl=/(.*?)(?:[\/]+|$)/g;if(Sl)var Dl=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else Dl=/^[\/]*/;function Il(e){return e&&"realpath"===e.syscall&&("ELOOP"===e.code||"ENOMEM"===e.code||"ENAMETOOLONG"===e.code)}function Nl(e,t,r){if(jl)return Ol(e,t,r);"function"==typeof t&&(r=t,t=null),Ol(e,t,(function(n,i){Il(n)?function(e,t,r){if("function"!=typeof r&&(r=Al(t),t=null),e=El.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return process.nextTick(r.bind(null,null,t[e]));var n,i,o,s,a=e,l={},u={};function c(){var t=Dl.exec(e);n=t[0].length,i=t[0],o=t[0],s="",Sl&&!u[o]?xl.lstat(o,(function(e){if(e)return r(e);u[o]=!0,p()})):process.nextTick(p)}function p(){if(n>=e.length)return t&&(t[a]=e),r(null,e);Tl.lastIndex=n;var l=Tl.exec(e);return s=i,i+=l[0],o=s+l[1],n=Tl.lastIndex,u[o]||t&&t[o]===o?process.nextTick(p):t&&Object.prototype.hasOwnProperty.call(t,o)?f(t[o]):xl.lstat(o,d)}function d(e,n){if(e)return r(e);if(!n.isSymbolicLink())return u[o]=!0,t&&(t[o]=o),process.nextTick(p);if(!Sl){var i=n.dev.toString(32)+":"+n.ino.toString(32);if(l.hasOwnProperty(i))return h(null,l[i],o)}xl.stat(o,(function(e){if(e)return r(e);xl.readlink(o,(function(e,t){Sl||(l[i]=t),h(e,t)}))}))}function h(e,n,i){if(e)return r(e);var o=El.resolve(s,n);t&&(t[i]=o),f(o)}function f(t){e=El.resolve(t,e.slice(n)),c()}c()}(e,t,r):r(n,i)}))}function Rl(e,t){if(jl)return Pl(e,t);try{return Pl(e,t)}catch(r){if(Il(r))return function(e,t){if(e=El.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return t[e];var r,n,i,o,s=e,a={},l={};function u(){var t=Dl.exec(e);r=t[0].length,n=t[0],i=t[0],o="",Sl&&!l[i]&&(xl.lstatSync(i),l[i]=!0)}for(u();r<e.length;){Tl.lastIndex=r;var c=Tl.exec(e);if(o=n,n+=c[0],i=o+c[1],r=Tl.lastIndex,!(l[i]||t&&t[i]===i)){var p;if(t&&Object.prototype.hasOwnProperty.call(t,i))p=t[i];else{var d=xl.lstatSync(i);if(!d.isSymbolicLink()){l[i]=!0,t&&(t[i]=i);continue}var h=null;if(!Sl){var f=d.dev.toString(32)+":"+d.ino.toString(32);a.hasOwnProperty(f)&&(h=a[f])}null===h&&(xl.statSync(i),h=xl.readlinkSync(i)),p=El.resolve(o,h),t&&(t[i]=p),Sl||(a[f]=h)}e=El.resolve(p,e.slice(r)),u()}}return t&&(t[s]=e),e}(e,t);throw r}}var Ll;Ll=lu,lu.Minimatch=uu;var Bl={sep:"/"};try{Bl=function(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}("path")}catch(e){}var Fl,Ul=lu.GLOBSTAR=uu.GLOBSTAR={},zl={};Fl=function(e,t){for(var r=[],n=0;n<e.length;n++){var i=t(e[n],n);ql(i)?r.push.apply(r,i):r.push(i)}return r};var ql=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Vl={};function $l(e,t,r){e instanceof RegExp&&(e=Wl(e,r)),t instanceof RegExp&&(t=Wl(t,r));var n=Hl(e,t,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+e.length,n[1]),post:r.slice(n[1]+t.length)}}function Wl(e,t){var r=t.match(e);return r?r[0]:null}function Hl(e,t,r){var n,i,o,s,a,l=r.indexOf(e),u=r.indexOf(t,l+1),c=l;if(l>=0&&u>0){for(n=[],o=r.length;c>=0&&!a;)c==l?(n.push(c),l=r.indexOf(e,c+1)):1==n.length?a=[n.pop(),u]:((i=n.pop())<o&&(o=i,s=u),u=r.indexOf(t,c+1)),c=l<u&&l>=0?l:u;n.length&&(a=[o,s])}return a}Vl=$l,$l.range=Hl,zl=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return function e(t,r){var n=[],i=Vl("{","}",t);if(!i||/\$$/.test(i.pre))return[t];var o,s=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),a=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),l=s||a,u=i.body.indexOf(",")>=0;if(!l&&!u)return i.post.match(/,.*\}/)?(t=i.pre+"{"+i.body+Kl+i.post,e(t)):[t];if(l)o=i.body.split(/\.\./);else{if(1===(o=function e(t){if(!t)return[""];var r=[],n=Vl("{","}",t);if(!n)return t.split(",");var i=n.pre,o=n.body,s=n.post,a=i.split(",");a[a.length-1]+="{"+o+"}";var l=e(s);s.length&&(a[a.length-1]+=l.shift(),a.push.apply(a,l));return r.push.apply(r,a),r}(i.body)).length)if(1===(o=e(o[0],!1).map(eu)).length)return(d=i.post.length?e(i.post,!1):[""]).map((function(e){return i.pre+o[0]+e}))}var c,p=i.pre,d=i.post.length?e(i.post,!1):[""];if(l){var h=Zl(o[0]),f=Zl(o[1]),v=Math.max(o[0].length,o[1].length),m=3==o.length?Math.abs(Zl(o[2])):1,g=ru;f<h&&(m*=-1,g=nu);var y=o.some(tu);c=[];for(var b=h;g(b,f);b+=m){var w;if(a)"\\"===(w=String.fromCharCode(b))&&(w="");else if(w=String(b),y){var _=v-w.length;if(_>0){var k=new Array(_+1).join("0");w=b<0?"-"+k+w.slice(1):k+w}}c.push(w)}}else c=Fl(o,(function(t){return e(t,!1)}));for(var O=0;O<c.length;O++)for(var P=0;P<d.length;P++){var M=p+c[O]+d[P];(!r||l||M)&&n.push(M)}return n}(function(e){return e.split("\\\\").join(Gl).split("\\{").join(Ql).split("\\}").join(Kl).split("\\,").join(Xl).split("\\.").join(Yl)}(e),!0).map(Jl)};var Gl="\0SLASH"+Math.random()+"\0",Ql="\0OPEN"+Math.random()+"\0",Kl="\0CLOSE"+Math.random()+"\0",Xl="\0COMMA"+Math.random()+"\0",Yl="\0PERIOD"+Math.random()+"\0";function Zl(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function Jl(e){return e.split(Gl).join("\\").split(Ql).join("{").split(Kl).join("}").split(Xl).join(",").split(Yl).join(".")}function eu(e){return"{"+e+"}"}function tu(e){return/^-?0\d/.test(e)}function ru(e,t){return e<=t}function nu(e,t){return e>=t}var iu={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},ou="().*{}+?[]^$\\!".split("").reduce((function(e,t){return e[t]=!0,e}),{});var su=/\/+/;function au(e,t){e=e||{},t=t||{};var r={};return Object.keys(t).forEach((function(e){r[e]=t[e]})),Object.keys(e).forEach((function(t){r[t]=e[t]})),r}function lu(e,t,r){if("string"!=typeof t)throw new TypeError("glob pattern string required");return r||(r={}),!(!r.nocomment&&"#"===t.charAt(0))&&(""===t.trim()?""===e:new uu(t,r).match(e))}function uu(e,t){if(!(this instanceof uu))return new uu(e,t);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"/"!==Bl.sep&&(e=e.split(Bl.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function cu(e,t){if(t||(t=this instanceof uu?this.options:{}),void 0===(e=void 0===e?this.pattern:e))throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:zl(e)}lu.filter=function(e,t){return t=t||{},function(r,n,i){return lu(r,e,t)}},lu.defaults=function(e){if(!e||!Object.keys(e).length)return lu;var t=lu,r=function(r,n,i){return t.minimatch(r,n,au(e,i))};return r.Minimatch=function(r,n){return new t.Minimatch(r,au(e,n))},r},uu.defaults=function(e){return e&&Object.keys(e).length?lu.defaults(e).Minimatch:uu},uu.prototype.debug=function(){},uu.prototype.make=function(){if(this._made)return;var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var r=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error);this.debug(this.pattern,r),r=this.globParts=r.map((function(e){return e.split(su)})),this.debug(this.pattern,r),r=r.map((function(e,t,r){return e.map(this.parse,this)}),this),this.debug(this.pattern,r),r=r.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,r),this.set=r},uu.prototype.parseNegate=function(){var e=this.pattern,t=!1,r=this.options,n=0;if(r.nonegate)return;for(var i=0,o=e.length;i<o&&"!"===e.charAt(i);i++)t=!t,n++;n&&(this.pattern=e.substr(n));this.negate=t},lu.braceExpand=function(e,t){return cu(e,t)},uu.prototype.braceExpand=cu,uu.prototype.parse=function(e,t){if(e.length>65536)throw new TypeError("pattern is too long");var r=this.options;if(!r.noglobstar&&"**"===e)return Ul;if(""===e)return"";var n,i="",o=!!r.nocase,s=!1,a=[],l=[],u=!1,c=-1,p=-1,d="."===e.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",h=this;function f(){if(n){switch(n){case"*":i+="[^/]*?",o=!0;break;case"?":i+="[^/]",o=!0;break;default:i+="\\"+n}h.debug("clearStateChar %j %j",n,i),n=!1}}for(var v,m=0,g=e.length;m<g&&(v=e.charAt(m));m++)if(this.debug("%s\t%s %s %j",e,m,i,v),s&&ou[v])i+="\\"+v,s=!1;else switch(v){case"/":return!1;case"\\":f(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,m,i,v),u){this.debug("  in class"),"!"===v&&m===p+1&&(v="^"),i+=v;continue}h.debug("call clearStateChar %j",n),f(),n=v,r.noext&&f();continue;case"(":if(u){i+="(";continue}if(!n){i+="\\(";continue}a.push({type:n,start:m-1,reStart:i.length,open:iu[n].open,close:iu[n].close}),i+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,i),n=!1;continue;case")":if(u||!a.length){i+="\\)";continue}f(),o=!0;var y=a.pop();i+=y.close,"!"===y.type&&l.push(y),y.reEnd=i.length;continue;case"|":if(u||!a.length||s){i+="\\|",s=!1;continue}f(),i+="|";continue;case"[":if(f(),u){i+="\\"+v;continue}u=!0,p=m,c=i.length,i+=v;continue;case"]":if(m===p+1||!u){i+="\\"+v,s=!1;continue}if(u){var b=e.substring(p+1,m);try{RegExp("["+b+"]")}catch(e){var w=this.parse(b,pu);i=i.substr(0,c)+"\\["+w[0]+"\\]",o=o||w[1],u=!1;continue}}o=!0,u=!1,i+=v;continue;default:f(),s?s=!1:!ou[v]||"^"===v&&u||(i+="\\"),i+=v}u&&(b=e.substr(p+1),w=this.parse(b,pu),i=i.substr(0,c)+"\\["+w[0],o=o||w[1]);for(y=a.pop();y;y=a.pop()){var _=i.slice(y.reStart+y.open.length);this.debug("setting tail",i,y),_=_.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,r){return r||(r="\\"),t+t+r+"|"})),this.debug("tail=%j\n   %s",_,_,y,i);var k="*"===y.type?"[^/]*?":"?"===y.type?"[^/]":"\\"+y.type;o=!0,i=i.slice(0,y.reStart)+k+"\\("+_}f(),s&&(i+="\\\\");var O=!1;switch(i.charAt(0)){case".":case"[":case"(":O=!0}for(var P=l.length-1;P>-1;P--){var M=l[P],j=i.slice(0,M.reStart),E=i.slice(M.reStart,M.reEnd-8),S=i.slice(M.reEnd-8,M.reEnd),x=i.slice(M.reEnd);S+=x;var C=j.split("(").length-1,A=x;for(m=0;m<C;m++)A=A.replace(/\)[+*?]?/,"");var T="";""===(x=A)&&t!==pu&&(T="$"),i=j+E+x+T+S}""!==i&&o&&(i="(?=.)"+i);O&&(i=d+i);if(t===pu)return[i,o];if(!o)return function(e){return e.replace(/\\(.)/g,"$1")}(e);var D=r.nocase?"i":"";try{var I=new RegExp("^"+i+"$",D)}catch(e){return new RegExp("$.")}return I._glob=e,I._src=i,I};var pu={};lu.makeRe=function(e,t){return new uu(e,t||{}).makeRe()},uu.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,r=t.noglobstar?"[^/]*?":t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",n=t.nocase?"i":"",i=e.map((function(e){return e.map((function(e){return e===Ul?r:"string"==typeof e?function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(e):e._src})).join("\\/")})).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,n)}catch(e){this.regexp=!1}return this.regexp},lu.match=function(e,t,r){var n=new uu(t,r=r||{});return e=e.filter((function(e){return n.match(e)})),n.options.nonull&&!e.length&&e.push(t),e},uu.prototype.match=function(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var r=this.options;"/"!==Bl.sep&&(e=e.split(Bl.sep).join("/"));e=e.split(su),this.debug(this.pattern,"split",e);var n,i,o=this.set;for(this.debug(this.pattern,"set",o),i=e.length-1;i>=0&&!(n=e[i]);i--);for(i=0;i<o.length;i++){var s=o[i],a=e;if(r.matchBase&&1===s.length&&(a=[n]),this.matchOne(a,s,t))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate},uu.prototype.matchOne=function(e,t,r){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var i=0,o=0,s=e.length,a=t.length;i<s&&o<a;i++,o++){this.debug("matchOne loop");var l,u=t[o],c=e[i];if(this.debug(t,u,c),!1===u)return!1;if(u===Ul){this.debug("GLOBSTAR",[t,u,c]);var p=i,d=o+1;if(d===a){for(this.debug("** at the end");i<s;i++)if("."===e[i]||".."===e[i]||!n.dot&&"."===e[i].charAt(0))return!1;return!0}for(;p<s;){var h=e[p];if(this.debug("\nglobstar while",e,p,t,d,h),this.matchOne(e.slice(p),t.slice(d),r))return this.debug("globstar found match!",p,s,h),!0;if("."===h||".."===h||!n.dot&&"."===h.charAt(0)){this.debug("dot detected!",e,p,t,d);break}this.debug("globstar swallow a segment, and continue"),p++}return!(!r||(this.debug("\n>>> no match, partial?",e,p,t,d),p!==s))}if("string"==typeof u?(l=n.nocase?c.toLowerCase()===u.toLowerCase():c===u,this.debug("string match",u,c,l)):(l=c.match(u),this.debug("pattern match",u,c,l)),!l)return!1}if(i===s&&o===a)return!0;if(i===s)return r;if(o===a)return i===s-1&&""===e[i];throw new Error("wtf?")};Ll.Minimatch;var du={};du="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e};var hu=r.EventEmitter,fu=a,vu=n,mu={};function gu(e){return"/"===e.charAt(0)}function yu(e){var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(e),r=t[1]||"",n=Boolean(r&&":"!==r.charAt(1));return Boolean(t[2]||n)}var bu=gu;(mu="win32"===process.platform?yu:gu).posix=bu;var wu=yu;mu.win32=wu;var _u={};_u=$u,$u.GlobSync=Wu;var ku=o,Ou=(Ll.Minimatch,bl.Glob,a),Pu=n,Mu=function(e,t,r){r||(r={});if(r.matchBase&&-1===t.indexOf("/")){if(r.noglobstar)throw new Error("base matching requires globstar");t="**/"+t}e.silent=!!r.silent,e.pattern=t,e.strict=!1!==r.strict,e.realpath=!!r.realpath,e.realpathCache=r.realpathCache||Object.create(null),e.follow=!!r.follow,e.dot=!!r.dot,e.mark=!!r.mark,e.nodir=!!r.nodir,e.nodir&&(e.mark=!0);e.sync=!!r.sync,e.nounique=!!r.nounique,e.nonull=!!r.nonull,e.nosort=!!r.nosort,e.nocase=!!r.nocase,e.stat=!!r.stat,e.noprocess=!!r.noprocess,e.absolute=!!r.absolute,e.maxLength=r.maxLength||1/0,e.cache=r.cache||Object.create(null),e.statCache=r.statCache||Object.create(null),e.symlinks=r.symlinks||Object.create(null),function(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]);e.ignore.length&&(e.ignore=e.ignore.map(Lu))}(e,r),e.changedCwd=!1;var n=process.cwd();Tu(r,"cwd")?(e.cwd=Du.resolve(r.cwd),e.changedCwd=e.cwd!==n):e.cwd=n;e.root=r.root||Du.resolve(e.cwd,"/"),e.root=Du.resolve(e.root),"win32"===process.platform&&(e.root=e.root.replace(/\\/g,"/"));e.cwdAbs=mu(e.cwd)?e.cwd:Bu(e,e.cwd),"win32"===process.platform&&(e.cwdAbs=e.cwdAbs.replace(/\\/g,"/"));e.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,e.minimatch=new Iu(t,r),e.options=e.minimatch.options},ju=Tu,Eu=Bu,Su=function(e){for(var t=e.nounique,r=t?[]:Object.create(null),n=0,i=e.matches.length;n<i;n++){var o=e.matches[n];if(o&&0!==Object.keys(o).length){var s=Object.keys(o);t?r.push.apply(r,s):s.forEach((function(e){r[e]=!0}))}else if(e.nonull){var a=e.minimatch.globSet[n];t?r.push(a):r[a]=!0}}t||(r=Object.keys(r));e.nosort||(r=r.sort(e.nocase?Nu:Ru));if(e.mark){for(n=0;n<r.length;n++)r[n]=e._mark(r[n]);e.nodir&&(r=r.filter((function(t){var r=!/\/$/.test(t),n=e.cache[t]||e.cache[Bu(e,t)];return r&&n&&(r="DIR"!==n&&!Array.isArray(n)),r})))}e.ignore.length&&(r=r.filter((function(t){return!Fu(e,t)})));e.found=r},xu=function(e,t){var r=Bu(e,t),n=e.cache[r],i=t;if(n){var o="DIR"===n||Array.isArray(n),s="/"===t.slice(-1);if(o&&!s?i+="/":!o&&s&&(i=i.slice(0,-1)),i!==t){var a=Bu(e,i);e.statCache[a]=e.statCache[r],e.cache[a]=e.cache[r]}}return i},Cu=Fu,Au=function(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return!(!e.gmatcher||!e.gmatcher.match(t))}))};function Tu(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Du=a,Iu=Ll.Minimatch;function Nu(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}function Ru(e,t){return e.localeCompare(t)}function Lu(e){var t=null;if("/**"===e.slice(-3)){var r=e.replace(/(\/\*\*)+$/,"");t=new Iu(r,{dot:!0})}return{matcher:new Iu(e,{dot:!0}),gmatcher:t}}function Bu(e,t){var r=t;return r="/"===t.charAt(0)?Du.join(e.root,t):mu(t)||""===t?t:e.changedCwd?Du.resolve(e.cwd,t):Du.resolve(t),"win32"===process.platform&&(r=r.replace(/\\/g,"/")),r}function Fu(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return e.matcher.match(t)||!(!e.gmatcher||!e.gmatcher.match(t))}))}var Uu=Mu,zu=ju,qu=Au,Vu=Cu;function $u(e,t){if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new Wu(e,t).found}function Wu(e,t){if(!e)throw new Error("must provide pattern");if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof Wu))return new Wu(e,t);if(Uu(this,e,t),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}Wu.prototype._finish=function(){if(Pu(this instanceof Wu),this.realpath){var e=this;this.matches.forEach((function(t,r){var n=e.matches[r]=Object.create(null);for(var i in t)try{i=e._makeAbs(i),n[_l.realpathSync(i,e.realpathCache)]=!0}catch(t){if("stat"!==t.syscall)throw t;n[e._makeAbs(i)]=!0}}))}Su(this)},Wu.prototype._process=function(e,t,r){Pu(this instanceof Wu);for(var n,i=0;"string"==typeof e[i];)i++;switch(i){case e.length:return void this._processSimple(e.join("/"),t);case 0:n=null;break;default:n=e.slice(0,i).join("/")}var o,s=e.slice(i);null===n?o=".":mu(n)||mu(e.join("/"))?(n&&mu(n)||(n="/"+n),o=n):o=n;var a=this._makeAbs(o);qu(this,o)||(s[0]===Ll.GLOBSTAR?this._processGlobStar(n,o,a,s,t,r):this._processReaddir(n,o,a,s,t,r))},Wu.prototype._processReaddir=function(e,t,r,n,i,o){var s=this._readdir(r,o);if(s){for(var a=n[0],l=!!this.minimatch.negate,u=a._glob,c=this.dot||"."===u.charAt(0),p=[],d=0;d<s.length;d++){if("."!==(v=s[d]).charAt(0)||c)(l&&!e?!v.match(a):v.match(a))&&p.push(v)}var h=p.length;if(0!==h)if(1!==n.length||this.mark||this.stat){n.shift();for(d=0;d<h;d++){var f;v=p[d];f=e?[e,v]:[v],this._process(f.concat(n),i,o)}}else{this.matches[i]||(this.matches[i]=Object.create(null));for(var d=0;d<h;d++){var v=p[d];e&&(v="/"!==e.slice(-1)?e+"/"+v:e+v),"/"!==v.charAt(0)||this.nomount||(v=Ou.join(this.root,v)),this._emitMatch(i,v)}}}},Wu.prototype._emitMatch=function(e,t){if(!Vu(this,t)){var r=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},Wu.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,r;try{r=ku.lstatSync(e)}catch(e){if("ENOENT"===e.code)return null}var n=r&&r.isSymbolicLink();return this.symlinks[e]=n,n||!r||r.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},Wu.prototype._readdir=function(e,t){if(t&&!zu(this.symlinks,e))return this._readdirInGlobStar(e);if(zu(this.cache,e)){var r=this.cache[e];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(e,ku.readdirSync(e))}catch(t){return this._readdirError(e,t),null}},Wu.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var n=t[r];n="/"===e?e+n:e+"/"+n,this.cache[n]=!0}return this.cache[e]=t,t},Wu.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(t.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=t.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},Wu.prototype._processGlobStar=function(e,t,r,n,i,o){var s=this._readdir(r,o);if(s){var a=n.slice(1),l=e?[e]:[],u=l.concat(a);this._process(u,i,!1);var c=s.length;if(!this.symlinks[r]||!o)for(var p=0;p<c;p++){if("."!==s[p].charAt(0)||this.dot){var d=l.concat(s[p],a);this._process(d,i,!0);var h=l.concat(s[p],n);this._process(h,i,!0)}}}},Wu.prototype._processSimple=function(e,t){var r=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),r){if(e&&mu(e)&&!this.nomount){var n=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=Ou.join(this.root,e):(e=Ou.resolve(this.root,e),n&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}},Wu.prototype._stat=function(e){var t=this._makeAbs(e),r="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&zu(this.cache,t)){var n=this.cache[t];if(Array.isArray(n)&&(n="DIR"),!r||"DIR"===n)return n;if(r&&"FILE"===n)return!1}var i=this.statCache[t];if(!i){var o;try{o=ku.lstatSync(t)}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return this.statCache[t]=!1,!1}if(o&&o.isSymbolicLink())try{i=ku.statSync(t)}catch(e){i=o}else i=o}this.statCache[t]=i;n=!0;return i&&(n=i.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||n,(!r||"FILE"!==n)&&n},Wu.prototype._mark=function(e){return xu(this,e)},Wu.prototype._makeAbs=function(e){return Eu(this,e)};var Hu=Mu,Gu=ju,Qu={},Ku={};Ku=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){n[e]=t[e]})),n;function n(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),i=e[e.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach((function(e){n[e]=i[e]})),n}};var Xu=Object.create(null),Yu={};Yu=Ku(Ju);var Zu=Ku(ec);function Ju(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function ec(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}function tc(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n]=e[n];return r}Yu.strict=Zu,Ju.proto=Ju((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return Ju(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return ec(this)},configurable:!0})})),Qu=Ku((function(e,t){return Xu[e]?(Xu[e].push(t),null):(Xu[e]=[t],function(e){return Yu((function t(){var r=Xu[e],n=r.length,i=tc(arguments);try{for(var o=0;o<n;o++)r[o].apply(null,i)}finally{r.length>n?(r.splice(0,n),process.nextTick((function(){t.apply(null,i)}))):delete Xu[e]}}))}(e))}));var rc=Au,nc=Cu;function ic(e,t,r){if("function"==typeof t&&(r=t,t={}),t||(t={}),t.sync){if(r)throw new TypeError("callback provided to sync glob");return _u(e,t)}return new sc(e,t,r)}ic.sync=_u;var oc=ic.GlobSync=_u.GlobSync;function sc(e,t,r){if("function"==typeof t&&(r=t,t=null),t&&t.sync){if(r)throw new TypeError("callback provided to sync glob");return new oc(e,t)}if(!(this instanceof sc))return new sc(e,t,r);Hu(this,e,t),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),"function"==typeof r&&(r=Yu(r),this.on("error",r),this.on("end",(function(e){r(null,e)})));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===n)return s();for(var o=0;o<n;o++)this._process(this.minimatch.set[o],o,!1,s);function s(){--i._processing,i._processing<=0&&i._finish()}}ic.glob=ic,ic.hasMagic=function(e,t){var r=function(e,t){if(null===t||"object"!=typeof t)return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}({},t);r.noprocess=!0;var n=new sc(e,r).minimatch.set;if(!e)return!1;if(n.length>1)return!0;for(var i=0;i<n[0].length;i++)if("string"!=typeof n[0][i])return!0;return!1},ic.Glob=sc,du(sc,hu),sc.prototype._finish=function(){if(vu(this instanceof sc),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();Su(this),this.emit("end",this.found)}},sc.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var t=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n)}function n(){0==--e&&t._finish()}},sc.prototype._realpathSet=function(e,t){var r=this.matches[e];if(!r)return t();var n=Object.keys(r),i=this,o=n.length;if(0===o)return t();var s=this.matches[e]=Object.create(null);n.forEach((function(r,n){r=i._makeAbs(r),_l.realpath(r,i.realpathCache,(function(n,a){n?"stat"===n.syscall?s[r]=!0:i.emit("error",n):s[a]=!0,0==--o&&(i.matches[e]=s,t())}))}))},sc.prototype._mark=function(e){return xu(this,e)},sc.prototype._makeAbs=function(e){return Eu(this,e)},sc.prototype.abort=function(){this.aborted=!0,this.emit("abort")},sc.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},sc.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var r=e[t];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(t=0;t<n.length;t++){var i=n[t];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},sc.prototype._process=function(e,t,r,n){if(vu(this instanceof sc),vu("function"==typeof n),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([e,t,r,n]);else{for(var i,o=0;"string"==typeof e[o];)o++;switch(o){case e.length:return void this._processSimple(e.join("/"),t,n);case 0:i=null;break;default:i=e.slice(0,o).join("/")}var s,a=e.slice(o);null===i?s=".":mu(i)||mu(e.join("/"))?(i&&mu(i)||(i="/"+i),s=i):s=i;var l=this._makeAbs(s);if(rc(this,s))return n();a[0]===Ll.GLOBSTAR?this._processGlobStar(i,s,l,a,t,r,n):this._processReaddir(i,s,l,a,t,r,n)}},sc.prototype._processReaddir=function(e,t,r,n,i,o,s){var a=this;this._readdir(r,o,(function(l,u){return a._processReaddir2(e,t,r,n,i,o,u,s)}))},sc.prototype._processReaddir2=function(e,t,r,n,i,o,s,a){if(!s)return a();for(var l=n[0],u=!!this.minimatch.negate,c=l._glob,p=this.dot||"."===c.charAt(0),d=[],h=0;h<s.length;h++){if("."!==(v=s[h]).charAt(0)||p)(u&&!e?!v.match(l):v.match(l))&&d.push(v)}var f=d.length;if(0===f)return a();if(1===n.length&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(h=0;h<f;h++){var v=d[h];e&&(v="/"!==e?e+"/"+v:e+v),"/"!==v.charAt(0)||this.nomount||(v=fu.join(this.root,v)),this._emitMatch(i,v)}return a()}n.shift();for(h=0;h<f;h++){v=d[h];e&&(v="/"!==e?e+"/"+v:e+v),this._process([v].concat(n),i,o,a)}a()},sc.prototype._emitMatch=function(e,t){if(!this.aborted&&!nc(this,t))if(this.paused)this._emitQueue.push([e,t]);else{var r=mu(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[e][t]=!0;var i=this.statCache[r];i&&this.emit("stat",t,i),this.emit("match",t)}}},sc.prototype._readdirInGlobStar=function(e,t){if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var r=this,n=Qu("lstat\0"+e,(function(n,i){if(n&&"ENOENT"===n.code)return t();var o=i&&i.isSymbolicLink();r.symlinks[e]=o,o||!i||i.isDirectory()?r._readdir(e,!1,t):(r.cache[e]="FILE",t())}));n&&wl.lstat(e,n)}},sc.prototype._readdir=function(e,t,r){if(!this.aborted&&(r=Qu("readdir\0"+e+"\0"+t,r))){if(t&&!Gu(this.symlinks,e))return this._readdirInGlobStar(e,r);if(Gu(this.cache,e)){var n=this.cache[e];if(!n||"FILE"===n)return r();if(Array.isArray(n))return r(null,n)}wl.readdir(e,function(e,t,r){return function(n,i){n?e._readdirError(t,n,r):e._readdirEntries(t,i,r)}}(this,e,r))}},sc.prototype._readdirEntries=function(e,t,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<t.length;n++){var i=t[n];i="/"===e?e+i:e+"/"+i,this.cache[i]=!0}return this.cache[e]=t,r(null,t)}},sc.prototype._readdirError=function(e,t,r){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(e);if(this.cache[n]="FILE",n===this.cwdAbs){var i=new Error(t.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=t.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return r()}},sc.prototype._processGlobStar=function(e,t,r,n,i,o,s){var a=this;this._readdir(r,o,(function(l,u){a._processGlobStar2(e,t,r,n,i,o,u,s)}))},sc.prototype._processGlobStar2=function(e,t,r,n,i,o,s,a){if(!s)return a();var l=n.slice(1),u=e?[e]:[],c=u.concat(l);this._process(c,i,!1,a);var p=this.symlinks[r],d=s.length;if(p&&o)return a();for(var h=0;h<d;h++){if("."!==s[h].charAt(0)||this.dot){var f=u.concat(s[h],l);this._process(f,i,!0,a);var v=u.concat(s[h],n);this._process(v,i,!0,a)}}a()},sc.prototype._processSimple=function(e,t,r){var n=this;this._stat(e,(function(i,o){n._processSimple2(e,t,i,o,r)}))},sc.prototype._processSimple2=function(e,t,r,n,i){if(this.matches[t]||(this.matches[t]=Object.create(null)),!n)return i();if(e&&mu(e)&&!this.nomount){var o=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=fu.join(this.root,e):(e=fu.resolve(this.root,e),o&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),i()},sc.prototype._stat=function(e,t){var r=this._makeAbs(e),n="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&Gu(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!n||"DIR"===i)return t(null,i);if(n&&"FILE"===i)return t()}var o=this.statCache[r];if(void 0!==o){if(!1===o)return t(null,o);var s=o.isDirectory()?"DIR":"FILE";return n&&"FILE"===s?t():t(null,s,o)}var a=this,l=Qu("stat\0"+r,(function(n,i){if(i&&i.isSymbolicLink())return wl.stat(r,(function(n,o){n?a._stat2(e,r,null,i,t):a._stat2(e,r,n,o,t)}));a._stat2(e,r,n,i,t)}));l&&wl.lstat(r,l)},sc.prototype._stat2=function(e,t,r,n,i){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[t]=!1,i();var o="/"===e.slice(-1);if(this.statCache[t]=n,"/"===t.slice(-1)&&n&&!n.isDirectory())return i(null,!1,n);var s=!0;return n&&(s=n.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||s,o&&"FILE"===s?i():i(null,s,n)};var ac=parseInt("666",8),lc={nosort:!0,silent:!0},uc=0,cc="win32"===process.platform;function pc(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach((function(t){e[t]=e[t]||yl[t],e[t+="Sync"]=e[t]||yl[t]})),e.maxBusyTries=e.maxBusyTries||3,e.emfileWait=e.emfileWait||1e3,!1===e.glob&&(e.disableGlob=!0),e.disableGlob=e.disableGlob||!1,e.glob=e.glob||lc}function dc(e,t,r){"function"==typeof t&&(r=t,t={}),ml(e,"rimraf: missing path"),ml.equal(typeof e,"string","rimraf: path should be a string"),ml.equal(typeof r,"function","rimraf: callback function required"),ml(t,"rimraf: invalid options argument provided"),ml.equal(typeof t,"object","rimraf: options should be object"),pc(t);var n=0,i=null,o=0;if(t.disableGlob||!bl.hasMagic(e))return s(null,[e]);function s(e,s){return e?r(e):0===(o=s.length)?r():void s.forEach((function(e){hc(e,t,(function s(a){if(a){if(("EBUSY"===a.code||"ENOTEMPTY"===a.code||"EPERM"===a.code)&&n<t.maxBusyTries)return n++,setTimeout((function(){hc(e,t,s)}),100*n);if("EMFILE"===a.code&&uc<t.emfileWait)return setTimeout((function(){hc(e,t,s)}),uc++);"ENOENT"===a.code&&(a=null)}uc=0,function(e){i=i||e,0==--o&&r(i)}(a)}))}))}t.lstat(e,(function(r,n){if(!r)return s(null,[e]);bl(e,t.glob,s)}))}function hc(e,t,r){ml(e),ml(t),ml("function"==typeof r),t.lstat(e,(function(n,i){return n&&"ENOENT"===n.code?r(null):(n&&"EPERM"===n.code&&cc&&fc(e,t,n,r),i&&i.isDirectory()?mc(e,t,n,r):void t.unlink(e,(function(n){if(n){if("ENOENT"===n.code)return r(null);if("EPERM"===n.code)return cc?fc(e,t,n,r):mc(e,t,n,r);if("EISDIR"===n.code)return mc(e,t,n,r)}return r(n)})))}))}function fc(e,t,r,n){ml(e),ml(t),ml("function"==typeof n),r&&ml(r instanceof Error),t.chmod(e,ac,(function(i){i?n("ENOENT"===i.code?null:r):t.stat(e,(function(i,o){i?n("ENOENT"===i.code?null:r):o.isDirectory()?mc(e,t,r,n):t.unlink(e,n)}))}))}function vc(e,t,r){ml(e),ml(t),r&&ml(r instanceof Error);try{t.chmodSync(e,ac)}catch(e){if("ENOENT"===e.code)return;throw r}try{var n=t.statSync(e)}catch(e){if("ENOENT"===e.code)return;throw r}n.isDirectory()?yc(e,t,r):t.unlinkSync(e)}function mc(e,t,r,n){ml(e),ml(t),r&&ml(r instanceof Error),ml("function"==typeof n),t.rmdir(e,(function(i){!i||"ENOTEMPTY"!==i.code&&"EEXIST"!==i.code&&"EPERM"!==i.code?i&&"ENOTDIR"===i.code?n(r):n(i):function(e,t,r){ml(e),ml(t),ml("function"==typeof r),t.readdir(e,(function(n,i){if(n)return r(n);var o,s=i.length;if(0===s)return t.rmdir(e,r);i.forEach((function(n){dc(gl.join(e,n),t,(function(n){if(!o)return n?r(o=n):void(0==--s&&t.rmdir(e,r))}))}))}))}(e,t,n)}))}function gc(e,t){var r;if(pc(t=t||{}),ml(e,"rimraf: missing path"),ml.equal(typeof e,"string","rimraf: path should be a string"),ml(t,"rimraf: missing options"),ml.equal(typeof t,"object","rimraf: options should be object"),t.disableGlob||!bl.hasMagic(e))r=[e];else try{t.lstatSync(e),r=[e]}catch(n){r=bl.sync(e,t.glob)}if(r.length)for(var n=0;n<r.length;n++){e=r[n];try{var i=t.lstatSync(e)}catch(r){if("ENOENT"===r.code)return;"EPERM"===r.code&&cc&&vc(e,t,r)}try{i&&i.isDirectory()?yc(e,t,null):t.unlinkSync(e)}catch(r){if("ENOENT"===r.code)return;if("EPERM"===r.code)return cc?vc(e,t,r):yc(e,t,r);if("EISDIR"!==r.code)throw r;yc(e,t,r)}}}function yc(e,t,r){ml(e),ml(t),r&&ml(r instanceof Error);try{t.rmdirSync(e)}catch(n){if("ENOENT"===n.code)return;if("ENOTDIR"===n.code)throw r;"ENOTEMPTY"!==n.code&&"EEXIST"!==n.code&&"EPERM"!==n.code||function(e,t){ml(e),ml(t),t.readdirSync(e).forEach((function(r){gc(gl.join(e,r),t)}));var r=cc?100:1,n=0;for(;;){var i=!0;try{var o=t.rmdirSync(e,t);return i=!1,o}finally{if(++n<r&&i)continue}}}(e,t)}}var bc=t,wc=vl.sync,_c=hl.resolve(bc.tmpdir()),kc=fl.O_CREAT|fl.O_TRUNC|fl.O_RDWR|fl.O_EXCL,Oc=function(e){return"function"==typeof e?[void 0,e]:[new Promise((function(e,r){t=function(){var t=Array.from(arguments),n=t.shift();process.nextTick((function(){n?r(n):1===t.length?e(t[0]):e(t)}))}})),t];var t},Pc=function(e,t){var r=Mc(e,t),n=new Date,i=[r.prefix,n.getFullYear(),n.getMonth(),n.getDate(),"-",process.pid,"-",(4294967296*Math.random()+1).toString(36),r.suffix].join("");return hl.join(r.dir||_c,i)},Mc=function(e,t){var r={prefix:null,suffix:null};if(e)switch(typeof e){case"string":r.prefix=e;break;case"object":r=e;break;default:throw new Error("Unknown affix declaration: "+r)}else r.prefix=t;return r},jc=!1,Ec=!1,Sc=[],xc=[];function Cc(e){if(!jc)return!1;Tc(),Sc.push(e)}function Ac(e){if(!jc)return!1;Tc(),xc.push(e)}function Tc(){if(!jc)return!1;Ec||(process.addListener("exit",Dc),Ec=!0)}function Dc(){return!!jc&&{files:function(){if(!jc)return!1;for(var e,t=0;void 0!==(e=Sc.shift());)wc(e),t++;return t}(),dirs:function(){if(!jc)return!1;for(var e,t=0;void 0!==(e=xc.shift());)wc(e),t++;return t}()}}var Ic=_c;pl.dir=Ic;var Nc=function(e){return jc=!1!==e,pl};pl.track=Nc;var Rc=function(e,t){var r=Oc(t),n=r[0];t=r[1];var i=Pc(e,"d-");return dl.mkdir(i,parseInt("0700",8),(function(e){e||Ac(i),t(e,i)})),n};pl.mkdir=Rc;var Lc=function(e){var t=Pc(e,"d-");return dl.mkdirSync(t,parseInt("0700",8)),Ac(t),t};pl.mkdirSync=Lc;var Bc=function(e,t){var r=Oc(t),n=r[0];t=r[1];var i=Pc(e,"f-");return dl.open(i,kc,parseInt("0600",8),(function(e,r){e||Cc(i),t(e,{path:i,fd:r})})),n};pl.open=Bc;var Fc=function(e){var t=Pc(e,"f-"),r=dl.openSync(t,kc,parseInt("0600",8));return Cc(t),{path:t,fd:r}};pl.openSync=Fc;var Uc=Pc;pl.path=Uc;var zc=function(e){var t=Oc(e),r=t[0];return e=t[1],jc?(function(e){var t=Oc(e),r=t[0];if(e=t[1],!jc)return e(new Error("not tracking")),r;var n,i=0,o=Sc.length;if(!o)return e(null,i),r;for(var s=function(t){if(o){if(t)return e(t),void(o=0);i++,--o||e(null,i)}};void 0!==(n=Sc.shift());)vl(n,s)}((function(t,r){t?e(t,{files:r}):function(e){var t=Oc(e),r=t[0];if(e=t[1],!jc)return e(new Error("not tracking")),r;var n,i=0,o=xc.length;if(!o)return e(null,i),r;for(var s=function(t){if(o){if(t)return e(t,i),void(o=0);i++,--o||e(null,i)}};void 0!==(n=xc.shift());)vl(n,s)}((function(t,n){e(t,{files:r,dirs:n})}))})),r):(e(new Error("not tracking")),r)};pl.cleanup=zc;var qc=Dc;pl.cleanupSync=qc;var Vc=function(e){var t=Pc(e,"s-"),r=dl.createWriteStream(t,{flags:kc,mode:parseInt("0600",8)});return Cc(t),r};pl.createWriteStream=Vc;var $c=Xc(pl),Wc={};Object.defineProperty(Wc,"__esModule",{value:!0});var Hc=async function({command:e,args:t,cwd:r,stdin:n}){return new Promise((i,o)=>{try{const s=Gc.execFile(e,t,{cwd:r},(e,t,r)=>{e?o({error:e,stderr:r}):i({stdout:t,stderr:r})});void 0!==n&&(s.stdin.write(n),s.stdin.end())}catch(e){console.error(e),o(e)}})};Wc.runFilter=Hc;var Gc=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=Qc();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(e);function Qc(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return Qc=function(){return e},e}function Kc(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return Kc=function(){return e},e}function Xc(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=Kc();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}async function Yc(e){return new Promise((t,r)=>{cl.readFile(e,{encoding:"utf-8"},(e,n)=>{e?(console.error(e),r(e)):t(n)})})}function Zc(e){e&&atom.notifications.addError(e.name,{detail:e.message,dismissable:!0})}var Jc={};Object.defineProperty(Jc,"__esModule",{value:!0});var ep=async function(e,t,r){const n=atom.config.get("ide-haskell.stylishHaskellPath",{scope:r}),i=atom.config.get("ide-haskell.stylishHaskellArguments",{scope:r});return(0,Wc.runFilter)({command:n,args:i,cwd:t,stdin:e})};Jc.format=ep;var tp={};Object.defineProperty(tp,"__esModule",{value:!0});var rp=void 0;tp.PrettifyEditorController=rp;var np=u;rp=class{constructor(e){this.editor=e,this.disposables=new np.CompositeDisposable,this.prettify=async()=>{if(atom.config.get("ide-haskell.onSavePrettify",{scope:this.editor.getRootScopeDescriptor()})){const e=this.editor.getGrammar().scopeName.replace(/\./g,"*");if(!atom.config.get("ide-haskell.onSavePrettifyFormats",{scope:this.editor.getRootScopeDescriptor()})[e])return;await(0,ol.prettifyFile)(this.editor)}};const t=this.editor.getBuffer();this.disposables.add(t.onWillSave(this.prettify))}static supportsGrammar(e){return["source.c2hs","source.cabal","source.hsc2hs","source.haskell","text.tex.latex.haskell","source.hsig"].includes(e)}destroy(){this.disposables.dispose()}},tp.PrettifyEditorController=rp;var ip={};Object.defineProperty(ip,"__esModule",{value:!0});var op=void 0;ip.EditorMarkControl=op;op=class{constructor(e){this.editor=e,this.editorElement=atom.views.getView(this.editor),this.editorElement.classList.add("ide-haskell")}static supportsGrammar(e){return["source.c2hs","source.cabal","source.hsc2hs","source.haskell","text.tex.latex.haskell","source.hsig"].includes(e)}destroy(){this.editorElement.classList.remove("ide-haskell")}},ip.EditorMarkControl=op;var sp={};Object.defineProperty(sp,"__esModule",{value:!0});var ap=void 0;sp.BackendStatusController=ap;var lp=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=bp();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(bs()),up=u,cp={};Object.defineProperty(cp,"__esModule",{value:!0});var pp=void 0;cp.StatusIcon=pp;var dp=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=fp();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(bs()),hp=u;function fp(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return fp=function(){return e},e}pp=class{constructor(e){this.props=e,this.disposables=new hp.CompositeDisposable,dp.initialize(this),this.disposables.add(atom.tooltips.add(this.element,{class:"ide-haskell-status-tooltip",title:()=>{const e=[];for(const[t,{status:r,detail:n}]of this.props.statusMap.entries())e.push(`\n          <ide-haskell-status-item>\n            <ide-haskell-status-icon data-status="${r}">${t}</ide-haskell-status-icon>\n            <ide-haskell-status-detail>${n||""}</ide-haskell-status-detail>\n          </ide-haskell-status-item>\n          `);return e.join("")}}))}render(){return dp.dom("ide-haskell-status-icon",{dataset:{status:this.calcCurrentStatus()}})}async update(e){return this.props.statusMap=e.statusMap,dp.update(this)}async destroy(){await dp.destroy(this),this.props.statusMap.clear()}calcCurrentStatus(){const e={progress:50,error:20,warning:10,ready:0},t=Array.from(this.props.statusMap.values());if(0===t.length)return"ready";const[r]=t.sort((t,r)=>e[r.status]-e[t.status]);return r.status}},cp.StatusIcon=pp;var vp={};Object.defineProperty(vp,"__esModule",{value:!0});var mp=void 0;vp.ProgressBar=mp;var gp=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=yp();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(bs());function yp(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return yp=function(){return e},e}function bp(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return bp=function(){return e},e}mp=class{constructor(e){this.props=e,gp.initialize(this)}render(){const e=this.aveProgress();return isNaN(e)?gp.dom("progress",{style:{display:"none"}}):0===e?gp.dom("progress",null):gp.dom("progress",{value:e.toString(),max:"1"})}async update(e){return this.props.progress!==e.progress?(this.props.progress=e.progress,gp.update(this)):Promise.resolve()}async destroy(){await gp.destroy(this)}aveProgress(){return this.props.progress.reduce((e,t)=>e+t,0)/this.props.progress.length}},vp.ProgressBar=mp;ap=class{constructor(){this.statusMap=new Map,this.awaiters=new Map,this.emitter=new up.Emitter}getAwaiter(e){let t=this.awaiters.get(e);void 0===t&&(t=new Set,this.awaiters.set(e,t));const r=t;return async t=>{let n;try{n=Promise.resolve().then(t),r.add(n),this.updateStatus(e,{status:"progress",detail:""});const i=await n;return r.delete(n),0===r.size&&this.updateStatus(e,{status:"ready",detail:""}),i}catch(t){return n&&r.delete(n),this.updateStatus(e,{status:"warning",detail:""+t}),void console.warn(t)}}}forceBackendStatus(e,t){this.updateStatus(e,t)}onDidUpdate(e){return this.emitter.on("did-update",e)}renderStatusIcon(){return lp.dom(cp.StatusIcon,{statusMap:this.statusMap})}renderProgressBar(){const e=Array.from(this.statusMap.values()).reduce((e,t)=>("progress"===t.status&&void 0!==t.progress&&e.push(t.progress),e),[]);return lp.dom(vp.ProgressBar,{progress:e})}updateStatus(e,t){this.statusMap.set(e,t),this.emitter.emit("did-update",{pluginName:e,status:t})}},sp.BackendStatusController=ap;b=class{constructor(e,t){this.outputPanel=t,this.disposables=new w.CompositeDisposable,this.emitter=new w.Emitter,this.willSaveHandlers=new Set,this.controllers=new Map,this.backendStatusController=new sp.BackendStatusController,this.onWillSaveBuffer=e=>(this.willSaveHandlers.add(e),new w.Disposable(()=>this.willSaveHandlers.delete(e))),this.onDidSaveBuffer=e=>this.emitter.on("did-save-buffer",e),this.onDidStopChanging=e=>this.emitter.on("did-stop-changing",e),this.disposables.add(this.emitter),this.resultsDB=new _.ResultsDB,this.outputPanel.connectResults(this.resultsDB),this.outputPanel.connectBsc(this.backendStatusController),this.tooltipRegistry=new Wa.TooltipRegistry(this),this.configParamManager=new Oo.ConfigParamManager(this.outputPanel,e.configParams),this.disposables.add(this.addEditorController(Aa.EditorControl),this.addEditorController(il.PrettifyEditorController),this.addEditorController(ip.EditorMarkControl)),"builtin"===atom.config.get("ide-haskell.messageDisplayFrontend")&&(this.checkResultsProvider=new Qa.CheckResultsProvider(this)),this.subscribeEditorController()}deactivate(){this.resultsDB.destroy(),this.disposables.dispose(),this.checkResultsProvider&&this.checkResultsProvider.destroy(),(0,E.handlePromise)(this.outputPanel.reallyDestroy()),this.configParamManager.destroy(),this.removeStatusBar(),this.linterSupport&&(this.linterSupport.destroy(),this.linterSupport=void 0)}serialize(){return{configParams:this.configParamManager.serialize()}}async willSaveBuffer(e){return Promise.all(Array.from(this.willSaveHandlers.values()).map(t=>t(e)))}didSaveBuffer(e){return this.emitter.emit("did-save-buffer",e)}didStopChanging(e){return this.emitter.emit("did-stop-changing",e)}togglePanel(){(0,E.handlePromise)(atom.workspace.toggle(this.outputPanel))}controller(e){return this.controllerType(Aa.EditorControl,e)}controllerType(e,t){const r=this.controllers.get(e),n=r?r.get(t):void 0;return n?n.controller:void 0}setLinter(e){"linter"===atom.config.get("ide-haskell.messageDisplayFrontend")&&(this.linterSupport=new qa.LinterSupport(e,this.resultsDB))}nextError(){"builtin"===atom.config.get("ide-haskell.messageDisplayFrontend")&&this.outputPanel.showNextError()}prevError(){"builtin"===atom.config.get("ide-haskell.messageDisplayFrontend")&&this.outputPanel.showPrevError()}forceBackendStatus(e,t){this.backendStatusController.forceBackendStatus(e,t)}getAwaiter(e){return this.backendStatusController.getAwaiter(e)}addEditorController(e){if(this.controllers.has(e))throw new Error("Duplicate controller factory "+e.toString());const t=new WeakMap;return this.controllers.set(e,t),new w.Disposable(()=>{this.controllers.delete(e);for(const e of atom.workspace.getTextEditors()){const r=t.get(e);r&&r.disposable.dispose()}})}setStatusBar(e){this.statusBarView=new el.StatusBarView(this.outputPanel,this.backendStatusController),this.statusBarTile=e.addRightTile({item:this.statusBarView.element,priority:100})}removeStatusBar(){this.statusBarTile&&(this.statusBarTile.destroy(),this.statusBarTile=void 0),this.statusBarView&&(this.statusBarView.destroy(),this.statusBarView=void 0)}controllerOnGrammar(e,t){for(const[r,n]of this.controllers.entries()){const i=n.get(e);if(!i&&r.supportsGrammar(t.scopeName)){const t=new r(e,this),i=new w.CompositeDisposable;i.add(new w.Disposable(()=>{n.delete(e),t.destroy()}),e.onDidDestroy(()=>i.dispose())),n.set(e,{controller:t,disposable:i})}else i&&!r.supportsGrammar(t.scopeName)&&i.disposable.dispose()}}subscribeEditorController(){this.disposables.add(atom.workspace.observeTextEditors(e=>{const t=new w.CompositeDisposable;t.add(e.onDidChangeGrammar(t=>{this.controllerOnGrammar(e,t)}),e.onDidDestroy(()=>{t.dispose(),this.disposables.remove(t)})),this.disposables.add(t),this.controllerOnGrammar(e,e.getGrammar())}))}},y.PluginManager=b;var wp={};Object.defineProperty(wp,"__esModule",{value:!0});var _p={};Object.defineProperty(_p,"__esModule",{value:!0});var kp=function(e,t,r){const n=t.name,i=new Ep,o=e.resultsDB.registerProvider(void 0!==t.messageTypes?Object.keys(t.messageTypes):[]);return i.add(o),i.add((0,Op.consume)(e,t,r)),{setMenu(e,t){const r=atom.menu.add([{label:E.MAIN_MENU_LABEL,submenu:[{label:e,submenu:t}]}]);return i.add(r),r},setStatus:t=>e.forceBackendStatus(n,t),setMessages(e){o.setMessages(e)},addMessageTab:async(t,r)=>e.outputPanel.createTab(t,r),showTooltip:async({editor:t,eventType:r,detail:i,tooltip:o})=>(void 0===r&&(r=(0,E.getEventType)(i)),e.tooltipRegistry.showTooltip(t,r,{pluginName:n,tooltip:o})),addPanelControl:t=>e.outputPanel.addPanelControl(t),addConfigParam:(t,r)=>e.configParamManager.add(n,t,r),getConfigParam:async t=>e.configParamManager.get(n,t),getOthersConfigParam:async(t,r)=>e.configParamManager.get(t,r),setConfigParam:async(t,r)=>e.configParamManager.set(n,t,r),getEventRange(t,r){let n;n=(0,E.isTEventRangeType)(r)?r:(0,E.getEventType)(r);const i=e.controller(t);if(i)return i.getEventRange(n)},dispose(){i.dispose()}}};_p.instance=kp;var Op={};Object.defineProperty(Op,"__esModule",{value:!0});var Pp=function(e,t,r){const{name:n,menu:i,messageTypes:o,events:s,controls:a,params:l,tooltip:u,commands:c}=t,p=new Mp.CompositeDisposable;let d;function h(e,t){if(Array.isArray(e)){const r=new Mp.CompositeDisposable;for(const n of e)r.add(t(v(n)));return r}return t(v(e))}const f=e.getAwaiter(n);function v(e){return function(...t){(0,E.handlePromise)(f(()=>e(...t)).then(async e=>{if(d&&void 0!==e)if(Array.isArray(e))d.setMessages(e);else{const t=[];for await(const r of e)t.push(r),d.setMessages(t)}}))}}if(i){const e=atom.menu.add([{label:E.MAIN_MENU_LABEL,submenu:[{label:i.label,submenu:i.menu}]}]);p.add(e)}if(o){r.eventsReturnResults&&(d=e.resultsDB.registerProvider(Object.keys(o)));for(const t of Object.keys(o)){const r=o[t];(0,E.handlePromise)(e.outputPanel.createTab(t,r)),p.add(new Mp.Disposable((function(){(0,E.handlePromise)(e.outputPanel.removeTab(t))})))}}s&&(s.onWillSaveBuffer&&p.add(h(s.onWillSaveBuffer,e.onWillSaveBuffer)),s.onDidSaveBuffer&&p.add(h(s.onDidSaveBuffer,e.onDidSaveBuffer)),s.onDidStopChanging&&p.add(h(s.onDidStopChanging,e.onDidStopChanging)));if(u){let t,r,i;"function"==typeof u?t=u:({handler:t,priority:r,eventTypes:i}=u),void 0===r&&(r=100),p.add(e.tooltipRegistry.register(n,{priority:r,handler:t,eventTypes:i}))}if(a)for(const t of a)p.add(e.outputPanel.addPanelControl(t));if(l)for(const t of Object.keys(l)){const r=l[t];p.add(e.configParamManager.add(n,t,r))}if(r.supportsCommands&&c)for(const[e,t]of Object.entries(c))if(void 0!==t)for(const[r,n]of Object.entries(t))p.add(atom.commands.add(e,r,(function(e){v(n)(e.currentTarget)})));return p};Op.consume=Pp;var Mp=u;function jp(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return jp=function(){return e},e}var Ep=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=jp();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(u).CompositeDisposable;Object.keys(_p).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(wp,e,{enumerable:!0,get:function(){return _p[e]}})})),Object.keys(Op).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(wp,e,{enumerable:!0,get:function(){return Op[e]}})}));var Sp=od(wp),xp={};Object.defineProperty(xp,"__esModule",{value:!0});var Cp=void 0;xp.OutputPanel=Cp;var Ap=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=ed();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(bs()),Tp=u,Dp={};Object.defineProperty(Dp,"__esModule",{value:!0});var Ip=void 0;Dp.OutputPanelButtons=Ip;var Np={};Object.defineProperty(Np,"__esModule",{value:!0});var Rp=void 0;Np.Button=Rp;var Lp=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=Bp();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(bs());function Bp(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return Bp=function(){return e},e}Rp=class{constructor(e){this.props=e,Lp.initialize(this)}render(){return Lp.dom("ide-haskell-button",{class:this.props.active?"active":"",dataset:{caption:this.props.name,count:this.props.count},on:{click:this.props.onClick}})}async update(e){return this.props=e,Lp.update(this)}async destroy(){await Lp.destroy(this)}},Np.Button=Rp;var Fp=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=Up();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(bs());function Up(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return Up=function(){return e},e}Ip=class{constructor(e){this.props=e,Fp.initialize(this)}render(){return Fp.dom("ide-haskell-panel-buttons",null,Array.from(this.renderButtons()))}async update(e){return this.props=e,Fp.update(this)}*renderButtons(){for(const e of this.props.buttons)yield Fp.dom(Np.Button,{active:e.name===this.props.activeBtn,name:e.name,count:e.count,onClick:e.onClick})}},Dp.OutputPanelButtons=Ip;var zp={};Object.defineProperty(zp,"__esModule",{value:!0});var qp=void 0;zp.OutputPanelCheckbox=qp;var Vp=u,$p=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=Wp();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(bs());function Wp(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return Wp=function(){return e},e}qp=class{constructor(e){this.props=e,this.tooltipTitle=()=>this.props.state?this.props.enabledHint:this.props.disabledHint,this.disposables=new Vp.CompositeDisposable,$p.initialize(this),this.disposables.add(atom.tooltips.add(this.element,{title:this.tooltipTitle}))}render(){return $p.dom("ide-haskell-checkbox",{class:`${this.props.class}${this.props.state?" enabled":""}`,on:{click:this.props.onSwitched}})}async update(e={}){return this.props={...this.props,...e},$p.update(this)}async destroy(){await $p.destroy(this),this.disposables.dispose()}},zp.OutputPanelCheckbox=qp;var Hp={};Object.defineProperty(Hp,"__esModule",{value:!0});var Gp=void 0;Hp.OutputPanelItems=Gp;var Qp=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=Jp();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(bs()),Kp={};Object.defineProperty(Kp,"__esModule",{value:!0});var Xp=void 0;Kp.OutputPanelItem=Xp;var Yp=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=Zp();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(bs());function Zp(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return Zp=function(){return e},e}function Jp(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return Jp=function(){return e},e}Xp=class{constructor(e){this.props=e,this.clickPosition=()=>{void 0!==this.props.model.uri&&(0,E.handlePromise)(atom.workspace.open(this.props.model.uri,{searchAllPanes:!0,initialLine:this.props.model.position&&this.props.model.position.row,initialColumn:this.props.model.position&&this.props.model.position.column}))},Yp.initialize(this)}render(){return Yp.dom("ide-haskell-panel-item",{key:this.props.model.hash()},this.renderPosition(),this.renderContext(),Yp.dom("ide-haskell-item-description",{innerHTML:this.props.model.message.toHtml()}))}async update(e){return this.props.model=e.model,Yp.update(this)}async destroy(){await Yp.destroy(this)}renderPosition(){if(void 0!==this.props.model.uri){const e=this.props.model.position?`${this.props.model.uri}: ${this.props.model.position.row+1}, ${this.props.model.position.column+1}`:this.props.model.uri;return Yp.dom("ide-haskell-item-position",{on:{click:this.clickPosition}},e)}return""}renderContext(){return void 0!==this.props.model.context?Yp.dom("ide-haskell-item-context",null,this.props.model.context):""}},Kp.OutputPanelItem=Xp;function ed(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return ed=function(){return e},e}Gp=class{constructor(e){this.props=e,this.itemMap=new WeakMap,Qp.initialize(this)}render(){return Qp.dom("ide-haskell-panel-items",{class:"native-key-bindings",tabIndex:"-1"},this.renderItems())}async update(e){return this.props=e,Qp.update(this)}async destroy(){await Qp.destroy(this)}async showItem(e){await Qp.update(this);const t=this.itemMap.get(e);t&&(t.component.clickPosition(),t.domNode.scrollIntoView({block:"start",behavior:"smooth"}))}async scrollToEnd(){await Qp.update(this),this.element.scrollTop=this.element.scrollHeight}atEnd(){return this.element.scrollTop>=this.element.scrollHeight-this.element.clientHeight}renderItems(){const e=this.props.filter?this.props.model.filter(this.props.filter):this.props.model.results();return Array.from(e).map(e=>{const t=Qp.dom(Kp.OutputPanelItem,{model:e});return this.itemMap.set(e,t),t})}},Hp.OutputPanelItems=Gp;class td{constructor(e={fileFilter:!1,activeTab:"error"}){if(this.state=e,this.elements=new Set,this.disposables=new Tp.CompositeDisposable,this.tabs=new Map,this.tabUsers=new Map,this.currentResult=0,this.switchFileFilter=()=>{this.state.fileFilter=!this.state.fileFilter,(0,E.handlePromise)(this.updateItems())},this.setButtonsClass(atom.config.get("ide-haskell.buttonsPosition")),Ap.initialize(this),atom.config.onDidChange("ide-haskell.buttonsPosition",({newValue:e})=>{this.setButtonsClass(e),(0,E.handlePromise)(this.update())}),"builtin"===atom.config.get("ide-haskell.messageDisplayFrontend"))for(const e of td.defaultTabs)this.tabs.set(e,{name:e,count:0,onClick:()=>this.activateTab(e),uriFilter:!0,autoScroll:!1});(0,E.handlePromise)(this.update()),this.disposables.add(atom.workspace.onDidChangeActivePaneItem(()=>{this.state.fileFilter&&(0,E.handlePromise)(this.updateItems())})),setImmediate(async()=>{await this.show(),atom.config.get("ide-haskell.autoHideOutput")&&this.hide()})}connectBsc(e){if(this.bsc)throw new Error("BackendStatusController already connected!");this.bsc=e,this.disposables.add(this.bsc.onDidUpdate(()=>(0,E.handlePromise)(this.update()))),(0,E.handlePromise)(this.update())}connectResults(e){if(this.results)throw new Error("Results already connected!");this.results=e;let t=Date.now(),r=new Set;this.disposables.add(this.results.onDidUpdate(e=>{this.currentResult=0,(0,E.handlePromise)(this.updateItems());const n=Date.now();if(n-t<atom.config.get("ide-haskell.switchTabOnCheckInterval"))for(const t of e)r.add(t);else r=new Set(e);!atom.config.get("ide-haskell.autoHideOutput")||this.results&&!this.results.isEmpty(e)?atom.config.get("ide-haskell.switchTabOnCheck")&&this.activateFirstNonEmptyTab(r):this.hide(),t=n})),(0,E.handlePromise)(this.update())}render(){var e,t;return this.results?Ap.dom("ide-haskell-panel",{class:this.buttonsClass},Ap.dom("ide-haskell-panel-heading",null,(null===(e=this.bsc)||void 0===e?void 0:e.renderStatusIcon())||null,Ap.dom(Dp.OutputPanelButtons,{buttons:Array.from(this.tabs.values()),activeBtn:this.state.activeTab}),Ap.dom(zp.OutputPanelCheckbox,{class:"ide-haskell-checkbox--uri-filter",state:this.state.fileFilter||!1,onSwitched:this.switchFileFilter,enabledHint:"Show current file messages",disabledHint:"Show all project messages"}),Array.from(this.elements.values()),(null===(t=this.bsc)||void 0===t?void 0:t.renderProgressBar())||null),Ap.dom(Hp.OutputPanelItems,{model:this.results,filter:this.itemFilter,ref:"items"})):Ap.dom("ide-haskell-panel",null)}async update(){return Ap.update(this)}destroy(){this.hide()}async reallyDestroy(){await Ap.destroy(this),this.disposables.dispose()}async toggle(){const e=atom.workspace.paneContainerForItem(this);return!e||(0,E.isDock)(e)&&!e.isVisible()?this.show():this.hide()}async show(){await atom.workspace.open(this,{searchAllPanes:!0,activatePane:!1});const e=atom.workspace.paneContainerForItem(this);e&&(0,E.isDock)(e)&&e.show()}hide(){const e=atom.workspace.paneContainerForItem(this);e&&(0,E.isDock)(e)&&atom.workspace.hide(this)}getTitle(){return"IDE-Haskell"}getURI(){return"ide-haskell://output-panel/"}getDefaultLocation(){return atom.config.get("ide-haskell.panelPosition")}addPanelControl(e){let t;if((0,E.isSimpleControlDef)(e)){const{events:r,classes:n,style:i,attrs:o}=e.opts,s={};n&&(s.class=n.join(" ")),i&&(s.style=i),o&&(s.attributes=o),r&&(s.on=r),t=Ap.dom(e.element,s)}else t=Ap.dom(e.element,e.opts);return this.elements.add(t),(0,E.handlePromise)(this.update()),new Tp.Disposable(()=>{this.elements.delete(t),(0,E.handlePromise)(this.update())})}async updateItems(){const e=this.getActiveTab();let t;if(this.state.fileFilter){const e=atom.workspace.getActiveTextEditor();t=e?e.getPath():void 0}let r=!1;if(e){const n=this.tabs.get(e);void 0!==t&&n&&n.uriFilter?this.itemFilter=({uri:r,severity:n})=>n===e&&r===t:this.itemFilter=({severity:t})=>t===e,r=n&&n.autoScroll&&this.refs.items&&this.refs.items.atEnd()||!1}if(this.results)for(const[e,t]of this.tabs.entries())t.count=Array.from(this.results.filter(({severity:t})=>t===e)).length;await this.update(),r&&this.refs.items&&await this.refs.items.scrollToEnd()}activateTab(e){this.state.activeTab=e,(0,E.handlePromise)(this.updateItems())}activateFirstNonEmptyTab(e){for(const t of this.tabs.values()){if(!e.has(t.name))continue;const r=t.count;if(r&&r>0){(0,E.handlePromise)(this.show()),this.activateTab(t.name);break}}}showItem(e){this.activateTab(e.severity),this.refs.items&&(0,E.handlePromise)(this.refs.items.showItem(e))}getActiveTab(){return this.state.activeTab}async createTab(e,{uriFilter:t=!0,autoScroll:r=!1}){if(!td.defaultTabs.includes(e))return this.tabs.has(e)?this.tabUsers.set(e,this.tabUsers.get(e)+1):(this.tabUsers.set(e,1),this.tabs.set(e,{name:e,count:0,onClick:()=>this.activateTab(e),uriFilter:t,autoScroll:r}),this.state.activeTab&&this.activateTab(this.state.activeTab)),this.update()}async removeTab(e){if(!td.defaultTabs.includes(e)){if(!this.tabUsers.has(e))throw new Error("Ide-Haskell: Removing nonexistent output panel tab "+e);{let t=this.tabUsers.get(e);if(t-=1,0===t)return this.tabUsers.delete(e),this.tabs.delete(e),this.state.activeTab===e&&(this.state.activeTab=td.defaultTabs[0]),this.update();this.tabUsers.set(e,t)}}}serialize(){return{...this.state,deserializer:"ide-haskell/OutputPanel"}}showNextError(){if(!this.results)return;const e=Array.from(this.results.filter(({uri:e})=>void 0!==e));0!==e.length&&(this.currentResult++,this.currentResult>=e.length&&(this.currentResult=0),this.showItem(e[this.currentResult]))}showPrevError(){if(!this.results)return;const e=Array.from(this.results.filter(({uri:e})=>void 0!==e));0!==e.length&&(this.currentResult--,this.currentResult<0&&(this.currentResult=e.length-1),this.showItem(e[this.currentResult]))}setButtonsClass(e){switch(e){case"top":this.buttonsClass="buttons-top";break;case"left":this.buttonsClass="buttons-left"}}}Cp=td,xp.OutputPanel=Cp,td.defaultTabs=["error","warning","lint"];var rd=od(xp),nd=od(u);function id(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return id=function(){return e},e}function od(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=id();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}var sd=nd.CompositeDisposable,ad=nd.Disposable;let ld,ud,cd,pd,dd=!1;function hd(e){return cd||(cd=new rd.OutputPanel(e)),cd}function fd(e={}){return function(){return dd=!0,t=>{if(!ud)throw new Error("IDE-Haskell failed to provide UPI instance: pluginManager is undefined");return Sp.instance(ud,t,e)}}}var vd=fd();exports.provideUpi3_0=vd;var md=fd({eventsReturnResults:!0});exports.provideUpi3_1=md;var gd=fd({eventsReturnResults:!0,supportsCommands:!0});function yd(e={}){return function(t){if(dd=!0,ud)return Sp.consume(ud,t,e)}}exports.provideUpi3_2=gd;var bd=yd({});exports.consumeUpi3_0=bd;var wd=yd({eventsReturnResults:!0});exports.consumeUpi3_1=wd;g=yd({eventsReturnResults:!0,supportsCommands:!0}),exports.consumeUpi3_2=g;
//# sourceMappingURL=main.js.map
