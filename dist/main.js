"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var e=require("atom"),r=t(e),n=require("crypto"),i=t(require("path")),o=require("atom-haskell-utils"),s=require("fs"),a=t(s),c=t(require("constants")),l=t(require("assert")),u=t(require("util")),p=t(require("events")),h=t(require("os")),d=require("child_process"),f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var m=function(){return(m=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function g(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s}function v(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function y(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function w(t){return this instanceof w?(this.v=t,this):new w(t)}var k=Object.freeze({__proto__:null,__extends:function(t,e){function r(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},get __assign(){return m},__rest:function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r},__decorate:g,__param:function(t,e){return function(r,n){e(r,n,t)}},__metadata:v,__awaiter:function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{c(n.next(t))}catch(t){o(t)}}function a(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))},__generator:function(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},__exportStar:function(t,e){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])},__values:y,__read:b,__spread:function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(b(arguments[e]));return t},__spreadArrays:function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},__await:w,__asyncGenerator:function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(t,e||[]),o=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(t){i[t]&&(n[t]=function(e){return new Promise((function(r,n){o.push([t,e,r,n])>1||a(t,e)}))})}function a(t,e){try{(r=i[t](e)).value instanceof w?Promise.resolve(r.value.v).then(c,l):u(o[0][2],r)}catch(t){u(o[0][3],t)}var r}function c(t){a("next",t)}function l(t){a("throw",t)}function u(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}},__asyncDelegator:function(t){var e,r;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,i){e[n]=t[n]?function(e){return(r=!r)?{value:w(t[n](e)),done:"return"===n}:i?i(e):e}:i}},__asyncValues:function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=y(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,i){(function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,i,(e=t[r](e)).done,e.value)}))}}},__makeTemplateObject:function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__importStar:function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},__importDefault:function(t){return t&&t.__esModule?t:{default:t}},__classPrivateFieldGet:function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}}),_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function x(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function S(t,e,r){return t(r={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&r.path)}},r.exports),r.exports}var E=S((function(t,e){!function(){var r="object"==typeof self&&self.self===self&&self||"object"==typeof _&&_.global===_&&_||this||{},n=r._,i=Array.prototype,o=Object.prototype,s="undefined"!=typeof Symbol?Symbol.prototype:null,a=i.push,c=i.slice,l=o.toString,u=o.hasOwnProperty,p=Array.isArray,h=Object.keys,d=Object.create,f=function(){},m=function(t){return t instanceof m?t:this instanceof m?void(this._wrapped=t):new m(t)};e.nodeType?r._=m:(!t.nodeType&&t.exports&&(e=t.exports=m),e._=m),m.VERSION="1.9.2";var g,v=function(t,e,r){if(void 0===e)return t;switch(null==r?3:r){case 1:return function(r){return t.call(e,r)};case 3:return function(r,n,i){return t.call(e,r,n,i)};case 4:return function(r,n,i,o){return t.call(e,r,n,i,o)}}return function(){return t.apply(e,arguments)}},y=function(t,e,r){return m.iteratee!==g?m.iteratee(t,e):null==t?m.identity:m.isFunction(t)?v(t,e,r):m.isObject(t)&&!m.isArray(t)?m.matcher(t):m.property(t)};m.iteratee=g=function(t,e){return y(t,e,1/0)};var b=function(t,e){return e=null==e?t.length-1:+e,function(){for(var r=Math.max(arguments.length-e,0),n=Array(r),i=0;i<r;i++)n[i]=arguments[i+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n);case 2:return t.call(this,arguments[0],arguments[1],n)}var o=Array(e+1);for(i=0;i<e;i++)o[i]=arguments[i];return o[e]=n,t.apply(this,o)}},w=function(t){if(!m.isObject(t))return{};if(d)return d(t);f.prototype=t;var e=new f;return f.prototype=null,e},k=function(t){return function(e){return null==e?void 0:e[t]}},x=function(t,e){return null!=t&&u.call(t,e)},S=function(t,e){for(var r=e.length,n=0;n<r;n++){if(null==t)return;t=t[e[n]]}return r?t:void 0},E=Math.pow(2,53)-1,O=k("length"),P=function(t){var e=O(t);return"number"==typeof e&&e>=0&&e<=E};m.each=m.forEach=function(t,e,r){var n,i;if(e=v(e,r),P(t))for(n=0,i=t.length;n<i;n++)e(t[n],n,t);else{var o=m.keys(t);for(n=0,i=o.length;n<i;n++)e(t[o[n]],o[n],t)}return t},m.map=m.collect=function(t,e,r){e=y(e,r);for(var n=!P(t)&&m.keys(t),i=(n||t).length,o=Array(i),s=0;s<i;s++){var a=n?n[s]:s;o[s]=e(t[a],a,t)}return o};var M=function(t){var e=function(e,r,n,i){var o=!P(e)&&m.keys(e),s=(o||e).length,a=t>0?0:s-1;for(i||(n=e[o?o[a]:a],a+=t);a>=0&&a<s;a+=t){var c=o?o[a]:a;n=r(n,e[c],c,e)}return n};return function(t,r,n,i){var o=arguments.length>=3;return e(t,v(r,i,4),n,o)}};m.reduce=m.foldl=m.inject=M(1),m.reduceRight=m.foldr=M(-1),m.find=m.detect=function(t,e,r){var n=(P(t)?m.findIndex:m.findKey)(t,e,r);if(void 0!==n&&-1!==n)return t[n]},m.filter=m.select=function(t,e,r){var n=[];return e=y(e,r),m.each(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n},m.reject=function(t,e,r){return m.filter(t,m.negate(y(e)),r)},m.every=m.all=function(t,e,r){e=y(e,r);for(var n=!P(t)&&m.keys(t),i=(n||t).length,o=0;o<i;o++){var s=n?n[o]:o;if(!e(t[s],s,t))return!1}return!0},m.some=m.any=function(t,e,r){e=y(e,r);for(var n=!P(t)&&m.keys(t),i=(n||t).length,o=0;o<i;o++){var s=n?n[o]:o;if(e(t[s],s,t))return!0}return!1},m.contains=m.includes=m.include=function(t,e,r,n){return P(t)||(t=m.values(t)),("number"!=typeof r||n)&&(r=0),m.indexOf(t,e,r)>=0},m.invoke=b((function(t,e,r){var n,i;return m.isFunction(e)?i=e:m.isArray(e)&&(n=e.slice(0,-1),e=e[e.length-1]),m.map(t,(function(t){var o=i;if(!o){if(n&&n.length&&(t=S(t,n)),null==t)return;o=t[e]}return null==o?o:o.apply(t,r)}))})),m.pluck=function(t,e){return m.map(t,m.property(e))},m.where=function(t,e){return m.filter(t,m.matcher(e))},m.findWhere=function(t,e){return m.find(t,m.matcher(e))},m.max=function(t,e,r){var n,i,o=-1/0,s=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,c=(t=P(t)?t:m.values(t)).length;a<c;a++)null!=(n=t[a])&&n>o&&(o=n);else e=y(e,r),m.each(t,(function(t,r,n){((i=e(t,r,n))>s||i===-1/0&&o===-1/0)&&(o=t,s=i)}));return o},m.min=function(t,e,r){var n,i,o=1/0,s=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,c=(t=P(t)?t:m.values(t)).length;a<c;a++)null!=(n=t[a])&&n<o&&(o=n);else e=y(e,r),m.each(t,(function(t,r,n){((i=e(t,r,n))<s||i===1/0&&o===1/0)&&(o=t,s=i)}));return o},m.shuffle=function(t){return m.sample(t,1/0)},m.sample=function(t,e,r){if(null==e||r)return P(t)||(t=m.values(t)),t[m.random(t.length-1)];var n=P(t)?m.clone(t):m.values(t),i=O(n);e=Math.max(Math.min(e,i),0);for(var o=i-1,s=0;s<e;s++){var a=m.random(s,o),c=n[s];n[s]=n[a],n[a]=c}return n.slice(0,e)},m.sortBy=function(t,e,r){var n=0;return e=y(e,r),m.pluck(m.map(t,(function(t,r,i){return{value:t,index:n++,criteria:e(t,r,i)}})).sort((function(t,e){var r=t.criteria,n=e.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(r<n||void 0===n)return-1}return t.index-e.index})),"value")};var A=function(t,e){return function(r,n,i){var o=e?[[],[]]:{};return n=y(n,i),m.each(r,(function(e,i){var s=n(e,i,r);t(o,e,s)})),o}};m.groupBy=A((function(t,e,r){x(t,r)?t[r].push(e):t[r]=[e]})),m.indexBy=A((function(t,e,r){t[r]=e})),m.countBy=A((function(t,e,r){x(t,r)?t[r]++:t[r]=1}));var j=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;m.toArray=function(t){return t?m.isArray(t)?c.call(t):m.isString(t)?t.match(j):P(t)?m.map(t,m.identity):m.values(t):[]},m.size=function(t){return null==t?0:P(t)?t.length:m.keys(t).length},m.partition=A((function(t,e,r){t[r?0:1].push(e)}),!0),m.first=m.head=m.take=function(t,e,r){return null==t||t.length<1?null==e?void 0:[]:null==e||r?t[0]:m.initial(t,t.length-e)},m.initial=function(t,e,r){return c.call(t,0,Math.max(0,t.length-(null==e||r?1:e)))},m.last=function(t,e,r){return null==t||t.length<1?null==e?void 0:[]:null==e||r?t[t.length-1]:m.rest(t,Math.max(0,t.length-e))},m.rest=m.tail=m.drop=function(t,e,r){return c.call(t,null==e||r?1:e)},m.compact=function(t){return m.filter(t,Boolean)};var T=function(t,e,r,n){for(var i=(n=n||[]).length,o=0,s=O(t);o<s;o++){var a=t[o];if(P(a)&&(m.isArray(a)||m.isArguments(a)))if(e)for(var c=0,l=a.length;c<l;)n[i++]=a[c++];else T(a,e,r,n),i=n.length;else r||(n[i++]=a)}return n};m.flatten=function(t,e){return T(t,e,!1)},m.without=b((function(t,e){return m.difference(t,e)})),m.uniq=m.unique=function(t,e,r,n){m.isBoolean(e)||(n=r,r=e,e=!1),null!=r&&(r=y(r,n));for(var i=[],o=[],s=0,a=O(t);s<a;s++){var c=t[s],l=r?r(c,s,t):c;e&&!r?(s&&o===l||i.push(c),o=l):r?m.contains(o,l)||(o.push(l),i.push(c)):m.contains(i,c)||i.push(c)}return i},m.union=b((function(t){return m.uniq(T(t,!0,!0))})),m.intersection=function(t){for(var e=[],r=arguments.length,n=0,i=O(t);n<i;n++){var o=t[n];if(!m.contains(e,o)){var s;for(s=1;s<r&&m.contains(arguments[s],o);s++);s===r&&e.push(o)}}return e},m.difference=b((function(t,e){return e=T(e,!0,!0),m.filter(t,(function(t){return!m.contains(e,t)}))})),m.unzip=function(t){for(var e=t&&m.max(t,O).length||0,r=Array(e),n=0;n<e;n++)r[n]=m.pluck(t,n);return r},m.zip=b(m.unzip),m.object=function(t,e){for(var r={},n=0,i=O(t);n<i;n++)e?r[t[n]]=e[n]:r[t[n][0]]=t[n][1];return r};var C=function(t){return function(e,r,n){r=y(r,n);for(var i=O(e),o=t>0?0:i-1;o>=0&&o<i;o+=t)if(r(e[o],o,e))return o;return-1}};m.findIndex=C(1),m.findLastIndex=C(-1),m.sortedIndex=function(t,e,r,n){for(var i=(r=y(r,n,1))(e),o=0,s=O(t);o<s;){var a=Math.floor((o+s)/2);r(t[a])<i?o=a+1:s=a}return o};var D=function(t,e,r){return function(n,i,o){var s=0,a=O(n);if("number"==typeof o)t>0?s=o>=0?o:Math.max(o+a,s):a=o>=0?Math.min(o+1,a):o+a+1;else if(r&&o&&a)return n[o=r(n,i)]===i?o:-1;if(i!=i)return(o=e(c.call(n,s,a),m.isNaN))>=0?o+s:-1;for(o=t>0?s:a-1;o>=0&&o<a;o+=t)if(n[o]===i)return o;return-1}};m.indexOf=D(1,m.findIndex,m.sortedIndex),m.lastIndexOf=D(-1,m.findLastIndex),m.range=function(t,e,r){null==e&&(e=t||0,t=0),r||(r=e<t?-1:1);for(var n=Math.max(Math.ceil((e-t)/r),0),i=Array(n),o=0;o<n;o++,t+=r)i[o]=t;return i},m.chunk=function(t,e){if(null==e||e<1)return[];for(var r=[],n=0,i=t.length;n<i;)r.push(c.call(t,n,n+=e));return r};var I=function(t,e,r,n,i){if(!(n instanceof e))return t.apply(r,i);var o=w(t.prototype),s=t.apply(o,i);return m.isObject(s)?s:o};m.bind=b((function(t,e,r){if(!m.isFunction(t))throw new TypeError("Bind must be called on a function");var n=b((function(i){return I(t,n,e,this,r.concat(i))}));return n})),m.partial=b((function(t,e){var r=m.partial.placeholder,n=function(){for(var i=0,o=e.length,s=Array(o),a=0;a<o;a++)s[a]=e[a]===r?arguments[i++]:e[a];for(;i<arguments.length;)s.push(arguments[i++]);return I(t,n,this,this,s)};return n})),m.partial.placeholder=m,m.bindAll=b((function(t,e){var r=(e=T(e,!1,!1)).length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=e[r];t[n]=m.bind(t[n],t)}})),m.memoize=function(t,e){var r=function(n){var i=r.cache,o=""+(e?e.apply(this,arguments):n);return x(i,o)||(i[o]=t.apply(this,arguments)),i[o]};return r.cache={},r},m.delay=b((function(t,e,r){return setTimeout((function(){return t.apply(null,r)}),e)})),m.defer=m.partial(m.delay,m,1),m.throttle=function(t,e,r){var n,i,o,s,a=0;r||(r={});var c=function(){a=!1===r.leading?0:m.now(),n=null,s=t.apply(i,o),n||(i=o=null)},l=function(){var l=m.now();a||!1!==r.leading||(a=l);var u=e-(l-a);return i=this,o=arguments,u<=0||u>e?(n&&(clearTimeout(n),n=null),a=l,s=t.apply(i,o),n||(i=o=null)):n||!1===r.trailing||(n=setTimeout(c,u)),s};return l.cancel=function(){clearTimeout(n),a=0,n=i=o=null},l},m.debounce=function(t,e,r){var n,i,o=function(e,r){n=null,r&&(i=t.apply(e,r))},s=b((function(s){if(n&&clearTimeout(n),r){var a=!n;n=setTimeout(o,e),a&&(i=t.apply(this,s))}else n=m.delay(o,e,this,s);return i}));return s.cancel=function(){clearTimeout(n),n=null},s},m.wrap=function(t,e){return m.partial(e,t)},m.negate=function(t){return function(){return!t.apply(this,arguments)}},m.compose=function(){var t=arguments,e=t.length-1;return function(){for(var r=e,n=t[e].apply(this,arguments);r--;)n=t[r].call(this,n);return n}},m.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},m.before=function(t,e){var r;return function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=null),r}},m.once=m.partial(m.before,2),m.restArguments=b;var N=!{toString:null}.propertyIsEnumerable("toString"),R=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],L=function(t,e){var r=R.length,n=t.constructor,i=m.isFunction(n)&&n.prototype||o,s="constructor";for(x(t,s)&&!m.contains(e,s)&&e.push(s);r--;)(s=R[r])in t&&t[s]!==i[s]&&!m.contains(e,s)&&e.push(s)};m.keys=function(t){if(!m.isObject(t))return[];if(h)return h(t);var e=[];for(var r in t)x(t,r)&&e.push(r);return N&&L(t,e),e},m.allKeys=function(t){if(!m.isObject(t))return[];var e=[];for(var r in t)e.push(r);return N&&L(t,e),e},m.values=function(t){for(var e=m.keys(t),r=e.length,n=Array(r),i=0;i<r;i++)n[i]=t[e[i]];return n},m.mapObject=function(t,e,r){e=y(e,r);for(var n=m.keys(t),i=n.length,o={},s=0;s<i;s++){var a=n[s];o[a]=e(t[a],a,t)}return o},m.pairs=function(t){for(var e=m.keys(t),r=e.length,n=Array(r),i=0;i<r;i++)n[i]=[e[i],t[e[i]]];return n},m.invert=function(t){for(var e={},r=m.keys(t),n=0,i=r.length;n<i;n++)e[t[r[n]]]=r[n];return e},m.functions=m.methods=function(t){var e=[];for(var r in t)m.isFunction(t[r])&&e.push(r);return e.sort()};var F=function(t,e){return function(r){var n=arguments.length;if(e&&(r=Object(r)),n<2||null==r)return r;for(var i=1;i<n;i++)for(var o=arguments[i],s=t(o),a=s.length,c=0;c<a;c++){var l=s[c];e&&void 0!==r[l]||(r[l]=o[l])}return r}};m.extend=F(m.allKeys),m.extendOwn=m.assign=F(m.keys),m.findKey=function(t,e,r){e=y(e,r);for(var n,i=m.keys(t),o=0,s=i.length;o<s;o++)if(e(t[n=i[o]],n,t))return n};var B,U,z=function(t,e,r){return e in r};m.pick=b((function(t,e){var r={},n=e[0];if(null==t)return r;m.isFunction(n)?(e.length>1&&(n=v(n,e[1])),e=m.allKeys(t)):(n=z,e=T(e,!1,!1),t=Object(t));for(var i=0,o=e.length;i<o;i++){var s=e[i],a=t[s];n(a,s,t)&&(r[s]=a)}return r})),m.omit=b((function(t,e){var r,n=e[0];return m.isFunction(n)?(n=m.negate(n),e.length>1&&(r=e[1])):(e=m.map(T(e,!1,!1),String),n=function(t,r){return!m.contains(e,r)}),m.pick(t,n,r)})),m.defaults=F(m.allKeys,!0),m.create=function(t,e){var r=w(t);return e&&m.extendOwn(r,e),r},m.clone=function(t){return m.isObject(t)?m.isArray(t)?t.slice():m.extend({},t):t},m.tap=function(t,e){return e(t),t},m.isMatch=function(t,e){var r=m.keys(e),n=r.length;if(null==t)return!n;for(var i=Object(t),o=0;o<n;o++){var s=r[o];if(e[s]!==i[s]||!(s in i))return!1}return!0},B=function(t,e,r,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var i=typeof t;return("function"===i||"object"===i||"object"==typeof e)&&U(t,e,r,n)},U=function(t,e,r,n){t instanceof m&&(t=t._wrapped),e instanceof m&&(e=e._wrapped);var i=l.call(t);if(i!==l.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return s.valueOf.call(t)===s.valueOf.call(e)}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,c=e.constructor;if(a!==c&&!(m.isFunction(a)&&a instanceof a&&m.isFunction(c)&&c instanceof c)&&"constructor"in t&&"constructor"in e)return!1}n=n||[];for(var u=(r=r||[]).length;u--;)if(r[u]===t)return n[u]===e;if(r.push(t),n.push(e),o){if((u=t.length)!==e.length)return!1;for(;u--;)if(!B(t[u],e[u],r,n))return!1}else{var p,h=m.keys(t);if(u=h.length,m.keys(e).length!==u)return!1;for(;u--;)if(p=h[u],!x(e,p)||!B(t[p],e[p],r,n))return!1}return r.pop(),n.pop(),!0},m.isEqual=function(t,e){return B(t,e)},m.isEmpty=function(t){return null==t||(P(t)&&(m.isArray(t)||m.isString(t)||m.isArguments(t))?0===t.length:0===m.keys(t).length)},m.isElement=function(t){return!(!t||1!==t.nodeType)},m.isArray=p||function(t){return"[object Array]"===l.call(t)},m.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},m.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],(function(t){m["is"+t]=function(e){return l.call(e)==="[object "+t+"]"}})),m.isArguments(arguments)||(m.isArguments=function(t){return x(t,"callee")});var q=r.document&&r.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof q&&(m.isFunction=function(t){return"function"==typeof t||!1}),m.isFinite=function(t){return!m.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},m.isNaN=function(t){return m.isNumber(t)&&isNaN(t)},m.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===l.call(t)},m.isNull=function(t){return null===t},m.isUndefined=function(t){return void 0===t},m.has=function(t,e){if(!m.isArray(e))return x(t,e);for(var r=e.length,n=0;n<r;n++){var i=e[n];if(null==t||!u.call(t,i))return!1;t=t[i]}return!!r},m.noConflict=function(){return r._=n,this},m.identity=function(t){return t},m.constant=function(t){return function(){return t}},m.noop=function(){},m.property=function(t){return m.isArray(t)?function(e){return S(e,t)}:k(t)},m.propertyOf=function(t){return null==t?function(){}:function(e){return m.isArray(e)?S(t,e):t[e]}},m.matcher=m.matches=function(t){return t=m.extendOwn({},t),function(e){return m.isMatch(e,t)}},m.times=function(t,e,r){var n=Array(Math.max(0,t));e=v(e,r,1);for(var i=0;i<t;i++)n[i]=e(i);return n},m.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},m.now=Date.now||function(){return(new Date).getTime()};var $={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},V=m.invert($),G=function(t){var e=function(e){return t[e]},r="(?:"+m.keys(t).join("|")+")",n=RegExp(r),i=RegExp(r,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(i,e):t}};m.escape=G($),m.unescape=G(V),m.result=function(t,e,r){m.isArray(e)||(e=[e]);var n=e.length;if(!n)return m.isFunction(r)?r.call(t):r;for(var i=0;i<n;i++){var o=null==t?void 0:t[e[i]];void 0===o&&(o=r,i=n),t=m.isFunction(o)?o.call(t):o}return t};var H=0;m.uniqueId=function(t){var e=++H+"";return t?t+e:e},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var W=/(.)^/,Q={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},K=/\\|'|\r|\n|\u2028|\u2029/g,X=function(t){return"\\"+Q[t]};m.template=function(t,e,r){!e&&r&&(e=r),e=m.defaults({},e,m.templateSettings);var n,i=RegExp([(e.escape||W).source,(e.interpolate||W).source,(e.evaluate||W).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(i,(function(e,r,n,i,a){return s+=t.slice(o,a).replace(K,X),o=a+e.length,r?s+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":n?s+="'+\n((__t=("+n+"))==null?'':__t)+\n'":i&&(s+="';\n"+i+"\n__p+='"),e})),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{n=new Function(e.variable||"obj","_",s)}catch(t){throw t.source=s,t}var a=function(t){return n.call(this,t,m)},c=e.variable||"obj";return a.source="function("+c+"){\n"+s+"}",a},m.chain=function(t){var e=m(t);return e._chain=!0,e};var Y=function(t,e){return t._chain?m(e).chain():e};m.mixin=function(t){return m.each(m.functions(t),(function(e){var r=m[e]=t[e];m.prototype[e]=function(){var t=[this._wrapped];return a.apply(t,arguments),Y(this,r.apply(m,t))}})),m},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=i[t];m.prototype[t]=function(){var r=this._wrapped;return e.apply(r,arguments),"shift"!==t&&"splice"!==t||0!==r.length||delete r[0],Y(this,r)}})),m.each(["concat","join","slice"],(function(t){var e=i[t];m.prototype[t]=function(){return Y(this,e.apply(this._wrapped,arguments))}})),m.prototype.value=function(){return this._wrapped},m.prototype.valueOf=m.prototype.toJSON=m.prototype.value,m.prototype.toString=function(){return String(this._wrapped)}}()})),O=(E._,S((function(t,e){t.exports=function(){var t=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function e(t){var e,r,n=t.replace(/^v/,"").replace(/\+.*$/,""),i=(r="-",-1===(e=n).indexOf(r)?e.length:e.indexOf(r)),o=n.substring(0,i).split(".");return o.push(n.substring(i+1)),o}function r(t){return isNaN(Number(t))?t:Number(t)}function n(e){if("string"!=typeof e)throw new TypeError("Invalid argument expected string");if(!t.test(e))throw new Error("Invalid argument not valid semver ('"+e+"' received)")}function i(t,i){[t,i].forEach(n);for(var o=e(t),s=e(i),a=0;a<Math.max(o.length-1,s.length-1);a++){var c=parseInt(o[a]||0,10),l=parseInt(s[a]||0,10);if(c>l)return 1;if(l>c)return-1}var u=o[o.length-1],p=s[s.length-1];if(u&&p){var h=u.split(".").map(r),d=p.split(".").map(r);for(a=0;a<Math.max(h.length,d.length);a++){if(void 0===h[a]||"string"==typeof d[a]&&"number"==typeof h[a])return-1;if(void 0===d[a]||"string"==typeof h[a]&&"number"==typeof d[a])return 1;if(h[a]>d[a])return 1;if(d[a]>h[a])return-1}}else if(u||p)return u?-1:1;return 0}var o=[">",">=","=","<","<="],s={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};return i.validate=function(e){return"string"==typeof e&&t.test(e)},i.compare=function(t,e,r){!function(t){if("string"!=typeof t)throw new TypeError("Invalid operator type, expected string but got "+typeof t);if(-1===o.indexOf(t))throw new TypeError("Invalid operator, expected one of "+o.join("|"))}(r);var n=i(t,e);return s[r].indexOf(n)>-1},i}()})));function P(t){switch(t){case"&":return"&amp;";case'"':return"&quot;";case"'":return"&#39;";case"<":return"&lt;";case">":return"&gt;";case" ":return"&nbsp;";default:return t}}function M(t){return t.replace(/[&"'<>]/g,P)}function A(t){return t.replace(/[&"'<> ]/g,P)}function j(t,e,r){t.push(e),r.push(`<span class="${e.replace(/\.+/g," ")}">`)}function T(t,e){t.pop(),e.push("</span>")}function C(t,e,r){let n=t.length-e.length;if(n>0)for(;n--;)T(t,r);let i=0;for(let n=t.length;n>=0;--n){if(E.isEqual(t.slice(0,n),e.slice(0,n))){i=n;break}T(t,r)}for(let n=i;n<e.length;++n)j(t,e[n],r)}const D={nbsp:!0,lineDivs:!1,editorDiv:!1,wrapCode:!1,editorDivTag:"div",editorDivClass:"editor editor-colors",nullScope:"text.plain.null-grammar"};function I(t){return"Dock"===t.constructor.name}function N(t){return void 0!==t}const R=["context","keyboard","mouse","selection"];function L(t){return!(!t||!t.text)}function F(t){return!(!t||!t.html)}var B="object"==typeof _&&_&&_.Object===Object&&_,U="object"==typeof self&&self&&self.Object===Object&&self,z=B||U||Function("return this")(),q=z.Symbol,$=Object.prototype,V=$.hasOwnProperty,G=$.toString,H=q?q.toStringTag:void 0;var W=function(t){var e=V.call(t,H),r=t[H];try{t[H]=void 0;var n=!0}catch(t){}var i=G.call(t);return n&&(e?t[H]=r:delete t[H]),i},Q=Object.prototype.toString;var K=function(t){return Q.call(t)},X=q?q.toStringTag:void 0;var Y=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":X&&X in Object(t)?W(t):K(t)};var Z=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var J,tt=function(t){if(!Z(t))return!1;var e=Y(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},et=z["__core-js_shared__"],rt=(J=/[^.]+$/.exec(et&&et.keys&&et.keys.IE_PROTO||""))?"Symbol(src)_1."+J:"";var nt=function(t){return!!rt&&rt in t},it=Function.prototype.toString;var ot=function(t){if(null!=t){try{return it.call(t)}catch(t){}try{return t+""}catch(t){}}return""},st=/^\[object .+?Constructor\]$/,at=Function.prototype,ct=Object.prototype,lt=at.toString,ut=ct.hasOwnProperty,pt=RegExp("^"+lt.call(ut).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ht=function(t){return!(!Z(t)||nt(t))&&(tt(t)?pt:st).test(ot(t))};var dt=function(t,e){return null==t?void 0:t[e]};var ft=function(t,e){var r=dt(t,e);return ht(r)?r:void 0},mt=ft(Object,"create");var gt=function(){this.__data__=mt?mt(null):{},this.size=0};var vt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},yt=Object.prototype.hasOwnProperty;var bt=function(t){var e=this.__data__;if(mt){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return yt.call(e,t)?e[t]:void 0},wt=Object.prototype.hasOwnProperty;var kt=function(t){var e=this.__data__;return mt?void 0!==e[t]:wt.call(e,t)};var _t=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=mt&&void 0===e?"__lodash_hash_undefined__":e,this};function xt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}xt.prototype.clear=gt,xt.prototype.delete=vt,xt.prototype.get=bt,xt.prototype.has=kt,xt.prototype.set=_t;var St=xt;var Et=function(){this.__data__=[],this.size=0};var Ot=function(t,e){return t===e||t!=t&&e!=e};var Pt=function(t,e){for(var r=t.length;r--;)if(Ot(t[r][0],e))return r;return-1},Mt=Array.prototype.splice;var At=function(t){var e=this.__data__,r=Pt(e,t);return!(r<0)&&(r==e.length-1?e.pop():Mt.call(e,r,1),--this.size,!0)};var jt=function(t){var e=this.__data__,r=Pt(e,t);return r<0?void 0:e[r][1]};var Tt=function(t){return Pt(this.__data__,t)>-1};var Ct=function(t,e){var r=this.__data__,n=Pt(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function Dt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Dt.prototype.clear=Et,Dt.prototype.delete=At,Dt.prototype.get=jt,Dt.prototype.has=Tt,Dt.prototype.set=Ct;var It=Dt,Nt=ft(z,"Map");var Rt=function(){this.size=0,this.__data__={hash:new St,map:new(Nt||It),string:new St}};var Lt=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var Ft=function(t,e){var r=t.__data__;return Lt(e)?r["string"==typeof e?"string":"hash"]:r.map};var Bt=function(t){var e=Ft(this,t).delete(t);return this.size-=e?1:0,e};var Ut=function(t){return Ft(this,t).get(t)};var zt=function(t){return Ft(this,t).has(t)};var qt=function(t,e){var r=Ft(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function $t(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}$t.prototype.clear=Rt,$t.prototype.delete=Bt,$t.prototype.get=Ut,$t.prototype.has=zt,$t.prototype.set=qt;var Vt=$t;function Gt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=t.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(Gt.Cache||Vt),r}Gt.Cache=Vt;var Ht=Gt,Wt=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,r){void 0===r&&(r={}),this.execute=t,this.applicator=e,this.options=r}return Object.defineProperty(t.prototype,"bound",{get:function(){return null!=this.options.bound&&this.options.bound},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setter",{get:function(){return null!=this.options.setter&&this.options.setter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getter",{get:function(){return null!=this.options.getter&&this.options.getter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"property",{get:function(){return null!=this.options.property&&this.options.property},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"method",{get:function(){return null==this.options.method||this.options.method},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"optionalParams",{get:function(){return null!=this.options.optionalParams&&this.options.optionalParams},enumerable:!0,configurable:!0}),t}();e.DecoratorConfig=r}));x(Wt);Wt.DecoratorConfig;var Qt=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.log=function(t){return void 0===t&&(t=""),"lodash-decorators -> "+t}}));x(Qt);Qt.log;var Kt=Array.isArray;var Xt=function(t){return null!=t&&"object"==typeof t};var Yt=function(t){return"string"==typeof t||!Kt(t)&&Xt(t)&&"[object String]"==Y(t)},Zt=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.resolveFunction=function(t,e,r,n){if(void 0===n&&(n=!0),tt(t))return t;if(Yt(t)){if(e&&tt(e[t]))return e[t];if(r&&tt(r[t]))return r[t]}if(n)throw new ReferenceError(Qt.log("Can not resolve method "+t+" on any target Objects"))}}));x(Zt);Zt.resolveFunction;var Jt=function(t){return void 0===t},te=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this._weakMap=new WeakMap}return t.prototype.set=function(t,e){for(var r=this._weakMap,n=0,i=t.length-1;n<i;n++){var o=t[n],s=r.get(o);s||(s=new Map,r.set(o,s)),r=s}r.set(t[t.length-1],e)},t.prototype.get=function(t){for(var e=this._weakMap,r=0,n=t.length;r<n&&(e=e.get(t[r]),!Jt(e));r++);return e},t.prototype.has=function(t){return!Jt(this.get(t))},t}();e.CompositeKeyWeakMap=r}));x(te);te.CompositeKeyWeakMap;var ee=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.returnAtIndex=function(t,e){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return t.call.apply(t,[this].concat(r)),r[e]}}}));x(ee);ee.returnAtIndex;var re=function(t){return function(e,r,n){for(var i=-1,o=Object(e),s=n(e),a=s.length;a--;){var c=s[t?a:++i];if(!1===r(o[c],c,o))break}return e}}();var ne=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n};var ie=function(t){return Xt(t)&&"[object Arguments]"==Y(t)},oe=Object.prototype,se=oe.hasOwnProperty,ae=oe.propertyIsEnumerable,ce=ie(function(){return arguments}())?ie:function(t){return Xt(t)&&se.call(t,"callee")&&!ae.call(t,"callee")};var le=function(){return!1},ue=S((function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,i=n&&n.exports===r?z.Buffer:void 0,o=(i?i.isBuffer:void 0)||le;t.exports=o})),pe=/^(?:0|[1-9]\d*)$/;var he=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&pe.test(t))&&t>-1&&t%1==0&&t<e};var de=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},fe={};fe["[object Float32Array]"]=fe["[object Float64Array]"]=fe["[object Int8Array]"]=fe["[object Int16Array]"]=fe["[object Int32Array]"]=fe["[object Uint8Array]"]=fe["[object Uint8ClampedArray]"]=fe["[object Uint16Array]"]=fe["[object Uint32Array]"]=!0,fe["[object Arguments]"]=fe["[object Array]"]=fe["[object ArrayBuffer]"]=fe["[object Boolean]"]=fe["[object DataView]"]=fe["[object Date]"]=fe["[object Error]"]=fe["[object Function]"]=fe["[object Map]"]=fe["[object Number]"]=fe["[object Object]"]=fe["[object RegExp]"]=fe["[object Set]"]=fe["[object String]"]=fe["[object WeakMap]"]=!1;var me=function(t){return Xt(t)&&de(t.length)&&!!fe[Y(t)]};var ge=function(t){return function(e){return t(e)}},ve=S((function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,i=n&&n.exports===r&&B.process,o=function(){try{var t=n&&n.require&&n.require("util").types;return t||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=o})),ye=ve&&ve.isTypedArray,be=ye?ge(ye):me,we=Object.prototype.hasOwnProperty;var ke=function(t,e){var r=Kt(t),n=!r&&ce(t),i=!r&&!n&&ue(t),o=!r&&!n&&!i&&be(t),s=r||n||i||o,a=s?ne(t.length,String):[],c=a.length;for(var l in t)!e&&!we.call(t,l)||s&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||he(l,c))||a.push(l);return a},_e=Object.prototype;var xe=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||_e)};var Se=function(t,e){return function(r){return t(e(r))}},Ee=Se(Object.keys,Object),Oe=Object.prototype.hasOwnProperty;var Pe=function(t){if(!xe(t))return Ee(t);var e=[];for(var r in Object(t))Oe.call(t,r)&&"constructor"!=r&&e.push(r);return e};var Me=function(t){return null!=t&&de(t.length)&&!tt(t)};var Ae=function(t){return Me(t)?ke(t):Pe(t)};var je=function(t,e){return t&&re(t,e,Ae)};var Te=function(t){return t};var Ce=function(t){return"function"==typeof t?t:Te};var De=function(t,e){return t&&je(t,Ce(e))},Ie=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.copyMetadata=function(t,e){return De(e,(function(e,r){return t[r]=e})),t}}));x(Ie);Ie.copyMetadata;var Ne=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.bind=function(t,e){return Ie.copyMetadata(t.bind(e),t)}}));x(Ne);Ne.bind;var Re=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var Le=function(t){return this.__data__.has(t)};function Fe(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Vt;++e<r;)this.add(t[e])}Fe.prototype.add=Fe.prototype.push=Re,Fe.prototype.has=Le;var Be=Fe;var Ue=function(t,e,r,n){for(var i=t.length,o=r+(n?1:-1);n?o--:++o<i;)if(e(t[o],o,t))return o;return-1};var ze=function(t){return t!=t};var qe=function(t,e,r){for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1};var $e=function(t,e,r){return e==e?qe(t,e,r):Ue(t,ze,r)};var Ve=function(t,e){return!!(null==t?0:t.length)&&$e(t,e,0)>-1};var Ge=function(t,e,r){for(var n=-1,i=null==t?0:t.length;++n<i;)if(r(e,t[n]))return!0;return!1};var He=function(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i};var We=function(t,e){return t.has(e)};var Qe=function(t,e,r,n){var i=-1,o=Ve,s=!0,a=t.length,c=[],l=e.length;if(!a)return c;r&&(e=He(e,ge(r))),n?(o=Ge,s=!1):e.length>=200&&(o=We,s=!1,e=new Be(e));t:for(;++i<a;){var u=t[i],p=null==r?u:r(u);if(u=n||0!==u?u:0,s&&p==p){for(var h=l;h--;)if(e[h]===p)continue t;c.push(u)}else o(e,p,n)||c.push(u)}return c};var Ke=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)},Xe=Math.max;var Ye=function(t,e,r){return e=Xe(void 0===e?t.length-1:e,0),function(){for(var n=arguments,i=-1,o=Xe(n.length-e,0),s=Array(o);++i<o;)s[i]=n[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=n[i];return a[e]=r(s),Ke(t,this,a)}};var Ze=function(t){return function(){return t}},Je=function(){try{var t=ft(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),tr=Je?function(t,e){return Je(t,"toString",{configurable:!0,enumerable:!1,value:Ze(e),writable:!0})}:Te,er=Date.now;var rr=function(t){var e=0,r=0;return function(){var n=er(),i=16-(n-r);if(r=n,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}},nr=rr(tr);var ir=function(t,e){return nr(Ye(t,e,Te),t+"")};var or=function(t){return Xt(t)&&Me(t)},sr=ir((function(t,e){return or(t)?Qe(t,e):[]})),ar=Se(Object.getPrototypeOf,Object),cr=Function.prototype,lr=Object.prototype,ur=cr.toString,pr=lr.hasOwnProperty,hr=ur.call(Object);var dr=function(t){if(!Xt(t)||"[object Object]"!=Y(t))return!1;var e=ar(t);if(null===e)return!0;var r=pr.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&ur.call(r)==hr};var fr=function(t){if(!Xt(t))return!1;var e=Y(t);return"[object Error]"==e||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!dr(t)},mr=ir((function(t,e){try{return Ke(t,void 0,e)}catch(t){return fr(t)?t:new Error(t)}})),gr=S((function(t,e){function r(t,e,r){var n=Object.getOwnPropertyDescriptor(t,r);if(!n||n.configurable){var i=Object.getOwnPropertyDescriptor(e,r);Z(i)?Object.defineProperty(t,r,i):t[r]=e[r]}}Object.defineProperty(e,"__esModule",{value:!0}),e.assignAll=function(t,e,n){void 0===n&&(n=[]);for(var i=0,o=sr.apply(void 0,[Object.getOwnPropertyNames(e)].concat(n));i<o.length;i++){var s=o[i];mr(r,t,e,s)}return t},e.assignProperty=r}));x(gr);gr.assignAll,gr.assignProperty;var vr=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=["length","name","arguments","called","prototype"];e.wrapConstructor=function(t,e){function n(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e.call.apply(e,[this,t].concat(r))}return n.prototype=t.prototype,Object.defineProperty(n,"name",{configurable:!0,enumerable:!1,value:t.name,writable:!1}),gr.assignAll(n,t,r)}}));x(vr);vr.wrapConstructor;var yr=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isMethodOrPropertyDecoratorArgs=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length>=2&&Z(t[0])&&Yt(t[1])&&tt(t[0].constructor)&&t[0].constructor.prototype===t[0]}}));x(yr);yr.isMethodOrPropertyDecoratorArgs;var br=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isPrototypeAccess=function(t,e){return t===e||t.constructor!==e.constructor&&Object.getPrototypeOf(this).constructor===e.constructor}}));x(br);br.isPrototypeAccess;var wr=S((function(t,e){function r(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),r(Qt),r(Zt),r(te),r(ee),r(Ie),r(Ne),r(vr),r(gr),r(yr),r(br)}));x(wr);var kr=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.InstanceChainMap=new wr.CompositeKeyWeakMap}));x(kr);kr.InstanceChainMap;var _r=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.createDecorator=function(t){var e=this,r=t.applicator,n=t.optionalParams;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var s=i,a=function(n,i,o){var a=e._resolveDescriptor(n,i,o),c=a.value,l=a.get,u=a.set;return kr.InstanceChainMap.has([n,i])||(tt(c)?a.value=wr.copyMetadata(r.apply({config:t,target:n,value:c,args:s}),c):tt(l)&&t.getter?a.get=wr.copyMetadata(r.apply({config:t,target:n,value:l,args:s}),l):tt(u)&&t.setter&&(a.set=wr.copyMetadata(r.apply({config:t,target:n,value:u,args:s}),u))),a};return n&&wr.isMethodOrPropertyDecoratorArgs.apply(void 0,i)?(s=[],a(i[0],i[1],i[2])):a}},t.prototype.createInstanceDecorator=function(t){var e=this,r=t.applicator,n=t.bound,i=t.optionalParams;return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];var a=o,c=function(i,o,s){var c=e._resolveDescriptor(i,o,s),l=c.value,u=c.writable,p=c.enumerable,h=c.configurable,d=c.get,f=c.set,m=!kr.InstanceChainMap.has([i,o]),g=kr.InstanceChainMap.get([i,o])||{fns:[],properties:[]},v=m&&tt(d),y=m&&tt(f),b=m&&tt(l),w=m&&!v&&!y&&!b,k=v?d:b?l:void 0;if(g.properties.push(o),g.fns.push((function(o,s,c){return e._isApplicable(c,t)?(n&&(o=wr.bind(o,s)),wr.copyMetadata(r.apply({args:a,target:i,instance:s,value:o,config:t}),o)):o})),kr.InstanceChainMap.set([i,o],g),!m)return c;g.isSetter=y,g.isGetter=v,g.isMethod=b,g.isProperty=w;var _=function(t,e,r){return g.fns.reduce((function(t,n){return n(t,r,e)}),t)},x=function(t){var e=d||void 0,r=f||void 0;if(v||y)v&&(e=_(d,{value:d,getter:!0},t)),y&&(r=_(f,{value:f,setter:!0},t)),Object.defineProperty(t,o,{enumerable:p,configurable:h,get:e,set:r});else if(b||w){var n=_(l,b?{value:l,method:!0}:{value:l,property:!0},t);Object.defineProperty(t,o,{writable:u,enumerable:p,configurable:h,value:n})}};return(b||w)&&(delete c.value,delete c.writable),c.get=function(){if(wr.isPrototypeAccess(this,i))return k;x(this);var t=Object.getOwnPropertyDescriptor(this,o);return t.get?t.get.call(this):t.value},c.set=function(t){x(this);var e=Object.getOwnPropertyDescriptor(this,o);e.set?e.set.call(this,t):(w||b)&&(this[o]=t)},c};return i&&wr.isMethodOrPropertyDecoratorArgs.apply(void 0,o)?(a=[],c(o[0],o[1],o[2])):c}},t.prototype._isApplicable=function(t,e){return!Boolean(t.getter&&!e.getter||t.setter&&!e.setter||t.method&&!e.method||t.property&&!e.property)},t.prototype._resolveDescriptor=function(t,e,r){return r||(Object.getOwnPropertyDescriptor(t,e)||{})},t}();e.InternalDecoratorFactory=r,e.DecoratorFactory=new r}));x(_r);_r.InternalDecoratorFactory,_r.DecoratorFactory;var xr=S((function(t,e){function r(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),r(Wt),r(_r),r(kr)}));x(xr);var Sr=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){};e.Applicator=r}));x(Sr);Sr.Applicator;var Er=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function e(e){void 0===e&&(e={});var r=t.call(this)||this;return r._config=e,r}return k.__extends(e,t),Object.defineProperty(e.prototype,"post",{get:function(){return!0===this._config.post},enumerable:!0,configurable:!0}),e.prototype.apply=function(t){var e=t.config.execute,r=t.value,n=void 0===r?Te:r,i=t.args,o=t.target,s=this;return function(){for(var t=this,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];var c=i.map((function(e){return wr.resolveFunction(e,t,o)})).slice();return s.post?c.push(n):c.unshift(n),e.apply(void 0,c).apply(this,r)}},e}(Sr.Applicator);e.ComposeApplicator=r}));x(Er);Er.ComposeApplicator;var Or=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return k.__extends(e,t),e.prototype.apply=function(t){var e=t.args,r=t.target,n=t.config.execute;return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return n.apply(void 0,[wr.resolveFunction(e[0],this,r)].concat(e.slice(1))).apply(this,t)}},e}(Sr.Applicator);e.PartialApplicator=r}));x(Or);Or.PartialApplicator;var Pr=ft(z,"WeakMap"),Mr=Pr&&new Pr,Ar=Mr?function(t,e){return Mr.set(t,e),t}:Te,jr=Object.create,Tr=function(){function t(){}return function(e){if(!Z(e))return{};if(jr)return jr(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();var Cr=function(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=Tr(t.prototype),n=t.apply(r,e);return Z(n)?n:r}};var Dr=function(t,e,r){var n=1&e,i=Cr(t);return function e(){var o=this&&this!==z&&this instanceof e?i:t;return o.apply(n?r:this,arguments)}},Ir=Math.max;var Nr=function(t,e,r,n){for(var i=-1,o=t.length,s=r.length,a=-1,c=e.length,l=Ir(o-s,0),u=Array(c+l),p=!n;++a<c;)u[a]=e[a];for(;++i<s;)(p||i<o)&&(u[r[i]]=t[i]);for(;l--;)u[a++]=t[i++];return u},Rr=Math.max;var Lr=function(t,e,r,n){for(var i=-1,o=t.length,s=-1,a=r.length,c=-1,l=e.length,u=Rr(o-a,0),p=Array(u+l),h=!n;++i<u;)p[i]=t[i];for(var d=i;++c<l;)p[d+c]=e[c];for(;++s<a;)(h||i<o)&&(p[d+r[s]]=t[i++]);return p};var Fr=function(t,e){for(var r=t.length,n=0;r--;)t[r]===e&&++n;return n};var Br=function(){};function Ur(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}Ur.prototype=Tr(Br.prototype),Ur.prototype.constructor=Ur;var zr=Ur;var qr=Mr?function(t){return Mr.get(t)}:function(){},$r={},Vr=Object.prototype.hasOwnProperty;var Gr=function(t){for(var e=t.name+"",r=$r[e],n=Vr.call($r,e)?r.length:0;n--;){var i=r[n],o=i.func;if(null==o||o==t)return i.name}return e};function Hr(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}Hr.prototype=Tr(Br.prototype),Hr.prototype.constructor=Hr;var Wr=Hr;var Qr=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e};var Kr=function(t){if(t instanceof zr)return t.clone();var e=new Wr(t.__wrapped__,t.__chain__);return e.__actions__=Qr(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e},Xr=Object.prototype.hasOwnProperty;function Yr(t){if(Xt(t)&&!Kt(t)&&!(t instanceof zr)){if(t instanceof Wr)return t;if(Xr.call(t,"__wrapped__"))return Kr(t)}return new Wr(t)}Yr.prototype=Br.prototype,Yr.prototype.constructor=Yr;var Zr=Yr;var Jr=function(t){var e=Gr(t),r=Zr[e];if("function"!=typeof r||!(e in zr.prototype))return!1;if(t===r)return!0;var n=qr(r);return!!n&&t===n[0]},tn=rr(Ar),en=/\{\n\/\* \[wrapped with (.+)\] \*/,rn=/,? & /;var nn=function(t){var e=t.match(en);return e?e[1].split(rn):[]},on=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;var sn=function(t,e){var r=e.length;if(!r)return t;var n=r-1;return e[n]=(r>1?"& ":"")+e[n],e=e.join(r>2?", ":" "),t.replace(on,"{\n/* [wrapped with "+e+"] */\n")};var an=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t},cn=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];var ln=function(t,e){return an(cn,(function(r){var n="_."+r[0];e&r[1]&&!Ve(t,n)&&t.push(n)})),t.sort()};var un=function(t,e,r){var n=e+"";return nr(t,sn(n,ln(nn(n),r)))};var pn=function(t,e,r,n,i,o,s,a,c,l){var u=8&e;e|=u?32:64,4&(e&=~(u?64:32))||(e&=-4);var p=[t,e,i,u?o:void 0,u?s:void 0,u?void 0:o,u?void 0:s,a,c,l],h=r.apply(void 0,p);return Jr(t)&&tn(h,p),h.placeholder=n,un(h,t,e)};var hn=function(t){return t.placeholder},dn=Math.min;var fn=function(t,e){for(var r=t.length,n=dn(e.length,r),i=Qr(t);n--;){var o=e[n];t[n]=he(o,r)?i[o]:void 0}return t};var mn=function(t,e){for(var r=-1,n=t.length,i=0,o=[];++r<n;){var s=t[r];s!==e&&"__lodash_placeholder__"!==s||(t[r]="__lodash_placeholder__",o[i++]=r)}return o};var gn=function t(e,r,n,i,o,s,a,c,l,u){var p=128&r,h=1&r,d=2&r,f=24&r,m=512&r,g=d?void 0:Cr(e);return function v(){for(var y=arguments.length,b=Array(y),w=y;w--;)b[w]=arguments[w];if(f)var k=hn(v),_=Fr(b,k);if(i&&(b=Nr(b,i,o,f)),s&&(b=Lr(b,s,a,f)),y-=_,f&&y<u){var x=mn(b,k);return pn(e,r,t,v.placeholder,n,b,x,c,l,u-y)}var S=h?n:this,E=d?S[e]:e;return y=b.length,c?b=fn(b,c):m&&y>1&&b.reverse(),p&&l<y&&(b.length=l),this&&this!==z&&this instanceof v&&(E=g||Cr(E)),E.apply(S,b)}};var vn=function(t,e,r){var n=Cr(t);return function i(){for(var o=arguments.length,s=Array(o),a=o,c=hn(i);a--;)s[a]=arguments[a];var l=o<3&&s[0]!==c&&s[o-1]!==c?[]:mn(s,c);if((o-=l.length)<r)return pn(t,e,gn,i.placeholder,void 0,s,l,void 0,void 0,r-o);var u=this&&this!==z&&this instanceof i?n:t;return Ke(u,this,s)}};var yn=function(t,e,r,n){var i=1&e,o=Cr(t);return function e(){for(var s=-1,a=arguments.length,c=-1,l=n.length,u=Array(l+a),p=this&&this!==z&&this instanceof e?o:t;++c<l;)u[c]=n[c];for(;a--;)u[c++]=arguments[++s];return Ke(p,i?r:this,u)}},bn=Math.min;var wn=function(t,e){var r=t[1],n=e[1],i=r|n,o=i<131,s=128==n&&8==r||128==n&&256==r&&t[7].length<=e[8]||384==n&&e[7].length<=e[8]&&8==r;if(!o&&!s)return t;1&n&&(t[2]=e[2],i|=1&r?0:4);var a=e[3];if(a){var c=t[3];t[3]=c?Nr(c,a,e[4]):a,t[4]=c?mn(t[3],"__lodash_placeholder__"):e[4]}return(a=e[5])&&(c=t[5],t[5]=c?Lr(c,a,e[6]):a,t[6]=c?mn(t[5],"__lodash_placeholder__"):e[6]),(a=e[7])&&(t[7]=a),128&n&&(t[8]=null==t[8]?e[8]:bn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t};var kn=function(t){return"symbol"==typeof t||Xt(t)&&"[object Symbol]"==Y(t)},_n=/^\s+|\s+$/g,xn=/^[-+]0x[0-9a-f]+$/i,Sn=/^0b[01]+$/i,En=/^0o[0-7]+$/i,On=parseInt;var Pn=function(t){if("number"==typeof t)return t;if(kn(t))return NaN;if(Z(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Z(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(_n,"");var r=Sn.test(t);return r||En.test(t)?On(t.slice(2),r?2:8):xn.test(t)?NaN:+t};var Mn=function(t){return t?(t=Pn(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var An=function(t){var e=Mn(t),r=e%1;return e==e?r?e-r:e:0},jn=Math.max;var Tn=function(t,e,r,n,i,o,s,a){var c=2&e;if(!c&&"function"!=typeof t)throw new TypeError("Expected a function");var l=n?n.length:0;if(l||(e&=-97,n=i=void 0),s=void 0===s?s:jn(An(s),0),a=void 0===a?a:An(a),l-=i?i.length:0,64&e){var u=n,p=i;n=i=void 0}var h=c?void 0:qr(t),d=[t,e,r,n,i,u,p,o,s,a];if(h&&wn(d,h),t=d[0],e=d[1],r=d[2],n=d[3],i=d[4],!(a=d[9]=void 0===d[9]?c?0:t.length:jn(d[9]-l,0))&&24&e&&(e&=-25),e&&1!=e)f=8==e||16==e?vn(t,e,a):32!=e&&33!=e||i.length?gn.apply(void 0,d):yn(t,e,r,n);else var f=Dr(t,e,r);return un((h?Ar:tn)(f,d),t,e)},Cn=ir((function(t,e){var r=mn(e,hn(Cn));return Tn(t,32,void 0,e,r)}));Cn.placeholder={};var Dn=Cn,In=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return k.__extends(e,t),e.prototype.apply=function(t){var e=t.config.execute,r=t.value,n=t.args;return Dn.apply(void 0,[e,r].concat(n))},e}(Sr.Applicator);e.PartialedApplicator=r}));x(In);In.PartialedApplicator;var Nn=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return k.__extends(e,t),e.prototype.apply=function(t){var e=t.args,r=t.target,n=t.value,i=t.config.execute;return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var s=n,a=0;return tt(s)||(s=wr.resolveFunction(e[0],this,r),a=1),i.apply(void 0,[s].concat(e.slice(a))).apply(this,t)}},e}(Sr.Applicator);e.PartialValueApplicator=r}));x(Nn);Nn.PartialValueApplicator;var Rn=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return k.__extends(e,t),e.prototype.apply=function(t){var e=t.config,r=e.execute,n=(e.bound,t.args),i=t.value;return r.apply(void 0,n.concat([i]))},e}(Sr.Applicator);e.PostValueApplicator=r}));x(Rn);Rn.PostValueApplicator;var Ln=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return k.__extends(e,t),e.prototype.apply=function(t){var e=t.value,r=t.config.execute,n=t.args;return r.apply(void 0,[e].concat(n))},e}(Sr.Applicator);e.PreValueApplicator=r}));x(Ln);Ln.PreValueApplicator;var Fn=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return k.__extends(e,t),e.prototype.apply=function(t){var e=t.args,r=t.config.execute,n=t.target,i=t.value;return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return r(wr.resolveFunction(e[0],this,n),i).apply(this,t)}},e}(Sr.Applicator);e.WrapApplicator=r}));x(Fn);Fn.WrapApplicator;var Bn=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return k.__extends(e,t),e.prototype.apply=function(t){var e=t.value,r=t.config.execute,n=t.args,i=t.instance;t.target;return i?r.apply(void 0,[e,i].concat(n)):e},e}(Sr.Applicator);e.BindApplicator=r}));x(Bn);Bn.BindApplicator;var Un=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return k.__extends(e,t),e.prototype.apply=function(t){var e=t.args,r=(t.target,t.config.execute),n=t.value;return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return r.apply(void 0,[n.bind(this)].concat(t,e))}},e}(Sr.Applicator);e.InvokeApplicator=r}));x(Un);Un.InvokeApplicator;var zn=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return k.__extends(e,t),e.prototype.apply=function(t){var e=t.value,r=t.instance,n=t.config.execute,i=t.args,o=t.target,s=wr.resolveFunction(tt(i[0])?i[0]:Z(i[0])?i[0].resolver:i[0],r,o,!1);s&&r&&(s=s.bind(r));var a=s?n(e,s):n(e);if(Z(i[0])){var c=i[0],l=c.cache,u=c.type;l?a.cache=l:tt(u)&&(a.cache=new u)}return a},e}(Sr.Applicator);e.MemoizeApplicator=r}));x(zn);zn.MemoizeApplicator;var qn=S((function(t,e){function r(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),r(Sr),r(Er),r(Or),r(In),r(Nn),r(Rn),r(Ln),r(Fn),r(Bn),r(Un),r(zn)}));x(qn);var $n=S((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Memoize=xr.DecoratorFactory.createInstanceDecorator(new xr.DecoratorConfig(Ht,new qn.MemoizeApplicator,{optionalParams:!0})),e.memoize=e.Memoize,e.default=e.Memoize})),Vn=x($n);$n.Memoize,$n.memoize;class Gn{constructor(t){this.msg=t}toHtml(){if(L(this.msg)&&void 0!==this.msg.highlighter){const t=function(t){const e=atom.grammars.textmateRegistry||atom.grammars,r=Object.assign({},D,t),n=e.grammarForScopeName(r.scopeName)||(r.nullScope?e.grammarForScopeName(r.nullScope):void 0);if(void 0===n)throw new Error(`Grammar ${r.scopeName} not found, and no ${r.nullScope} grammar`);const i=n.tokenizeLines(r.fileContents);if(i.length>0){const t=i[i.length-1];1===t.length&&""===t[0].value&&i.pop()}const o=r.nbsp?A:M,s=[];r.editorDiv&&s.push(`<${r.editorDivTag} class="${r.editorDivClass}">`),r.wrapCode&&s.push("<code>");for(const t of i){const e=[];r.lineDivs&&s.push('<div class="line">');for(const{value:r,scopes:n}of t){let t=n;O(atom.getVersion(),"1.13.0")>=0&&(t=n.map(t=>"syntax--"+t.replace(/\./g,".syntax--"))),C(e,t,s),s.push(`<span>${o(r)}</span>`)}for(;e.length>0;)T(e,s);r.lineDivs&&s.push("</div>"),s.push("\n")}return r.wrapCode&&s.push("</code>"),r.editorDiv&&s.push(`</${r.editorDivTag}>`),s.join("")}({fileContents:this.msg.text,scopeName:this.msg.highlighter,nbsp:!1,lineDivs:!1});return t||(this.msg.highlighter=void 0,this.toHtml())}if(F(this.msg))return this.msg.html;{let t;t=L(this.msg)?this.msg.text:this.msg;const e=document.createElement("div");return e.innerText=t,e.innerHTML}}toPlain(){if(F(this.msg)){const t=document.createElement("div");return t.innerHTML=this.msg.html,t.innerText}{let t;return t=L(this.msg)?this.msg.text:this.msg,t}}raw(){return L(this.msg)?this.msg.text:F(this.msg)?this.msg.html:this.msg}}function Hn(t,r,n,i){const o=e=>{const r=e.target.closest(n);r&&t.contains(r)&&i(e)};return t.addEventListener(r,o),new e.Disposable(()=>{t.removeEventListener(r,o)})}Gn.fromObject=t=>t instanceof Gn?t:new Gn(t),g([Vn(),v("design:type",Function),v("design:paramtypes",[]),v("design:returntype",String)],Gn.prototype,"toHtml",null),g([Vn(),v("design:type",Function),v("design:paramtypes",[]),v("design:returntype",String)],Gn.prototype,"toPlain",null);function Wn(t){return t&&(t.contextCommand||t[0]&&t[0].contextCommand)?"context":"keyboard"}function Qn(t,e){const r=atom.views.getView(t).component.screenPositionForMouseEvent(e);if(!isNaN(r.row)&&!isNaN(r.column))return t.bufferPositionForScreenPosition(r)}function Kn(t){"function"==typeof t.catch?t.catch(t=>{atom.notifications.addFatalError("Atom-Typescript error: "+t.message,{detail:t.toString(),stack:t.stack,dismissable:!0})}):atom.notifications.addFatalError("Atom-Typescript: non-promise passed to handlePromise. Please report this.",{stack:(new Error).stack,dismissable:!0})}class Xn{constructor(t,{uri:r,message:n,severity:i,position:o,context:s}){this.providerId=t,this.uri=r,this.message=Gn.fromObject(n),this.severity=i,this.position=o?e.Point.fromObject(o):void 0,this.context=s,this._isValid=!0}isValid(){return this._isValid}setValid(t){this._isValid=t}hash(){if(void 0!==this._hash)return this._hash;const t=n.createHash("sha1");return t.update(JSON.stringify({uri:this.uri,position:this.position?this.position.serialize():void 0,message:this.message.raw(),severity:this.severity,context:this.context})),this._hash=t.digest("base64"),this._hash}}class Yn{constructor(t,e,r){this.parent=t,this.providerSeverities=e,this.id=r,this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.parent.didUpdate(this.id,Array.from(this.providerSeverities),[]))}addSeverity(t){this.providerSeverities.add(t)}removeSeverity(t){this.providerSeverities.delete(t)}setMessages(t){if(this.disposed)return;const e=t.map(t=>new Xn(this.id,t));this.parent.didUpdate(this.id,Array.from(this.providerSeverities),e)}}class Zn{constructor(){this.currentId=0,this.disposables=new e.CompositeDisposable,this.emitter=new e.Emitter,this.disposables.add(this.emitter),this.messages=new Map}destroy(){this.disposables.dispose()}onDidUpdate(t){return this.emitter.on("did-update",t)}didUpdate(t,e,r){const n=r.map(t=>t.uri).filter(N);for(const[r,i]of Array.from(this.messages))(i.providerId===t||void 0!==i.uri&&n.includes(i.uri)&&e.includes(i.severity))&&this.messages.delete(r);for(const t of r)this.messages.set(t.hash(),t);const i=new Set(r.map(t=>t.severity));this.emitter.emit("did-update",Array.from(i))}registerProvider(t){const e=new Yn(this,new Set(t),++this.currentId);return this.disposables.add(e),e}results(){return this.messages.values()}*filter(t){for(const e of this.results())t(e)&&(yield e)}isEmpty(t){return!Array.from(this.messages.values()).some(({severity:e})=>t.includes(e))}}var Jn={onCopy:"copy",onCut:"cut",onPaste:"paste",onCompositionEnd:"compositionend",onCompositionStart:"compositionstart",onCompositionUpdate:"compositionupdate",onKeyDown:"keydown",onKeyPress:"keypress",onKeyUp:"keyup",onFocus:"focus",onBlur:"blur",onChange:"change",onInput:"input",onSubmit:"submit",onClick:"click",onContextMenu:"contextmenu",onDoubleClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragEnter:"dragenter",onDragExit:"dragexit",onDragLeave:"dragleave",onDragOver:"dragover",onDragStart:"dragstart",onDrop:"drop",onMouseDown:"mousedown",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onSelect:"select",onTouchCancel:"touchcancel",onTouchEnd:"touchend",onTouchMove:"touchmove",onTouchStart:"touchstart",onScroll:"scroll",onWheel:"wheel",onAbort:"abort",onCanPlay:"canplay",onCanPlayThrough:"canplaythrough",onDurationChange:"durationchange",onEmptied:"emptied",onEncrypted:"encrypted",onEnded:"ended",onError:"error",onLoadedData:"loadeddata",onLoadedMetadata:"loadedmetadata",onLoadStart:"loadstart",onPause:"pause",onPlay:"play",onPlaying:"playing",onProgress:"progress",onRateChange:"ratechange",onSeeked:"seeked",onSeeking:"seeking",onStalled:"stalled",onSuspend:"suspend",onTimeUpdate:"timeupdate",onVolumeChange:"volumechange",onWaiting:"waiting",onLoad:"load",onAnimationStart:"animationstart",onAnimationEnd:"animationend",onAnimationIteration:"animationiteration",onTransitionEnd:"transitionend"},ti=new Set(["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]);function ei(t,e,...r){let n=[];for(let t=0;t<r.length;){const e=r[t];switch(typeof e){case"string":case"number":r[t]={text:e},t++;break;case"object":Array.isArray(e)?r.splice(t,1,...e):e?(e.context||(n.push(e),e.ambiguous&&e.ambiguous.length&&(n=n.concat(e.ambiguous))),t++):r.splice(t,1);break;default:throw new Error("Invalid child node: "+e)}}if(e){for(const t in e){const r=Jn[t];r&&(e.on||(e.on={}),e.on[r]=e[t])}e.class&&(e.className=e.class)}return{tag:t,props:e,children:r,ambiguous:n}}const ri=["a","abbr","address","article","aside","audio","b","bdi","bdo","blockquote","body","button","canvas","caption","cite","code","colgroup","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","html","i","iframe","ins","kbd","label","legend","li","main","map","mark","menu","meter","nav","noscript","object","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","u","ul","var","video","area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];for(const t of ri)ei[t]=(e,...r)=>ei(t,e,...r);for(const t of ti)ei[t]=(e,...r)=>ei(t,e,...r);var ni=ei,ii=new Map([["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["className","class"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["panose1","panose-1"],["paintOrder","paint-order"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xHeight","x-height"]]),oi=function(t,e,r,n){r!==e&&("function"==typeof e?e(null):e&&n[e]===t&&delete n[e],"function"==typeof r?r(t):r&&(n[r]=t))};var si=function(t,e,r,n){const i=e&&e.props,o=r.props;let s,a;n&&(s=n.refs,a=n.listenerContext),function t(e,r,n,i,o){if(n)for(var s in n)"ref"!==s&&"on"!==s&&(s in Jn||o&&s in o||("dataset"===s?t(e.dataset,null,n&&n.dataset,null,null):"innerHTML"!==s&&r&&ti.has(r.tag)?e.removeAttribute(ii.get(s)||s):(e[s]="",delete e[s])));if(o)for(var s in o)if("ref"!==s&&"on"!==s&&!(s in Jn)){var a=n&&n[s],c=o[s];"dataset"===s?ai(e.dataset,a,c,!1):"style"===s&&"string"!=typeof c?("string"==typeof a&&(e.style="",a=null),ai(e.style,a,c,!0)):"attributes"===s?ci(e,a,c):c!==a&&("innerHTML"!==s&&i&&ti.has(i.tag)?e.setAttribute(ii.get(s)||s,c):i&&"input"===i.tag&&"value"===s&&e[s]===c||(e[s]=c))}}(t,e,i,r,o),s&&oi(t,i&&i.ref,o&&o.ref,s),function(t,e,r,n){const i=e&&e.props&&e.props.on,o=r.props&&r.props.on;for(const r in i)if(!o||!(r in o)){let n;n=e&&e.boundListeners&&e.boundListeners[r]?e.boundListeners[r]:i[r],t.removeEventListener(r,n)}for(const s in o){const a=i&&i[s],c=o[s];if(c!==a){if(a){let r;r=e&&e.boundListeners&&e.boundListeners[s]?e.boundListeners[s]:a,t.removeEventListener(s,r)}if(c){let e;n?(e=c.bind(n),r.boundListeners||(r.boundListeners={}),r.boundListeners[s]=e):e=c,t.addEventListener(s,e)}}}}(t,e,r,a)};function ai(t,e,r,n){if(e)for(var i in e)r&&i in r||(n?t[i]="":delete t[i]);if(r)for(var i in r){const n=e&&e[i],o=r[i];o!==n&&(t[i]=o)}}function ci(t,e,r){if(e)for(var n in e)r&&n in r||t.removeAttribute(n);if(r)for(var n in r){const i=e&&e[n],o=r[n];o!==i&&t.setAttribute(n,o)}}function li(t,e){let r;if(null!=t.text)r=document.createTextNode(t.text);else{const{tag:n,children:i}=t;let{props:o,context:s}=t;if(s&&(e={refs:s.refs,listenerContext:s}),"function"==typeof n){let s;o&&o.ref&&(s=o.ref);const a=new n(o||{},i);t.component=a,r=a.element,"function"==typeof s?s(a):e&&e.refs&&s&&(e.refs[s]=a)}else ti.has(n)?(r=document.createElementNS("http://www.w3.org/2000/svg",n),i&&ui(r,i,e),o&&si(r,null,t,e)):(r=document.createElement(n),i&&ui(r,i,e),o&&si(r,null,t,e))}return t.domNode=r,r}function ui(t,e,r){for(let n=0;n<e.length;n++)t.appendChild(li(e[n],r))}var pi=li;function hi(t,e,r){const n=t.domNode;if(e===t)return n;if(mi(t,e)){let i;return null!=e.text?(n.nodeValue=e.text,i=n):"function"==typeof e.tag?i=function(t,e,r){const{component:n,props:i}=t;let{props:o,children:s}=e;e.component=n;const a=r&&r.refs;a&&oi(n,i&&i.ref,o&&o.ref,a);return n.update(o||{},s),n.element}(t,e,r):(!function(t,e,r,n){var i,o=0,s=e.length-1,a=e[0],c=e[s],l=0,u=r.length-1,p=r[0],h=r[u];for(;o<=s&&l<=u;)if(a)if(c)if(mi(a,p))hi(a,p,n),a=e[++o],p=r[++l];else if(mi(c,h))hi(c,h,n),c=e[--s],h=r[--u];else if(mi(a,h))hi(a,h,n),t.insertBefore(a.domNode,c.domNode.nextSibling),a=e[++o],h=r[--u];else if(mi(c,p))hi(c,p,n),t.insertBefore(c.domNode,a.domNode),c=e[--s],p=r[++l];else{i||(di.length>0?(i=di.pop()).clear():i=new Map,vi(i,e,o,s));var d=gi(p),f=d?i.get(d):null;if(null==f)t.insertBefore(pi(p,n),a.domNode),p=r[++l];else{var m=e[f];hi(m,p,n),e[f]=void 0,t.insertBefore(m.domNode,a.domNode),p=r[++l]}}else c=e[--s];else a=e[++o];if(o>s){var g=r[u+1]?r[u+1].domNode:null;for(let e=l;e<=u;e++)t.insertBefore(pi(r[e],n),g)}else if(l>u)for(let t=o;t<=s;t++){var v=e[t];v&&fi(v,n&&n.refs)}i&&di.push(i)}(n,t.children,e.children,r),si(n,t,e,r),i=n),e.domNode=i,i!==n&&n.parentNode&&n.parentNode.replaceChild(i,n),i}{const i=n.parentNode,o=n.nextSibling;fi(t,r&&r.refs);const s=pi(e,r);return i&&i.insertBefore(s,o),e.domNode=s,s}}let di=[new Map,new Map,new Map,new Map];function fi(t,e,r=!0){const{domNode:n,props:i,children:o,component:s}=t,a=i&&i.ref;if(s)"function"==typeof a?a(null):e&&a&&e[a]===s&&delete e[a],s.destroy&&s.destroy();else if("function"==typeof a?a(null):e&&a&&e[a]===n&&delete e[a],o)for(let t=0;t<o.length;t++)fi(o[t],e,!1);r&&n.remove()}function mi(t,e){return gi(t)===gi(e)&&t.tag===e.tag}function gi(t){return t.props?t.props.key:void 0}function vi(t,e,r,n){for(let i=r;i<=n;i++){const r=gi(e[i]);r&&t.set(r,i)}return t}var yi=hi;let bi=null;var wi={setScheduler:function(t){bi=t},getScheduler:function(){return bi||(bi=new class{constructor(){this.updateRequests=[],this.readRequests=[],this.pendingAnimationFrame=null,this.performUpdates=this.performUpdates.bind(this),this.performingUpdates=!1}updateDocument(t){this.updateRequests.push(t),this.pendingAnimationFrame||(this.pendingAnimationFrame=window.requestAnimationFrame(this.performUpdates))}readDocument(t){this.readRequests.push(t),this.pendingAnimationFrame||(this.pendingAnimationFrame=window.requestAnimationFrame(this.performUpdates))}getNextUpdatePromise(){return this.nextUpdatePromise||(this.nextUpdatePromise=new Promise(t=>{this.resolveNextUpdatePromise=t})),this.nextUpdatePromise}performUpdates(){for(;this.updateRequests.length>0;)this.updateRequests.shift()();for(this.pendingAnimationFrame=null;this.readRequests.length>0;)this.readRequests.shift()();if(this.nextUpdatePromise){let t=this.resolveNextUpdatePromise;this.nextUpdatePromise=null,this.resolveNextUpdatePromise=null,t()}}}),bi}};const{getScheduler:ki}=wi,_i=new WeakSet;let xi=0,Si=0;function Ei(t){return null!=t&&!1!==t}function Oi(t,e){e.context=t,e.ambiguous&&(e.ambiguous.forEach(e=>{e.context=t}),delete e.ambiguous)}function Pi(t,e=!0){if(!Ei(t.virtualNode))throw new Error((t.constructor?t.constructor.name+" instance":t)+" is not associated with a valid virtualNode. Perhaps this component was never initialized?");if(null==t.element)throw new Error((t.constructor?t.constructor.name+" instance":t)+" is not associated with a DOM element. Perhaps this component was never initialized?");let r=t.render();if(!Ei(r)){const e=t.constructor&&t.constructor.name?" in "+t.constructor.name:"";throw new Error("invalid falsy value "+r+" returned from render()"+e)}Oi(t,r),xi++;let n=t.virtualNode,i=t.element,o=yi(n,r,{refs:t.refs,listenerContext:t});if(t.virtualNode=r,o!==i&&!e)throw new Error("The root node type changed on update, but the update was performed with the replaceNode option set to false");t.element=o,"function"==typeof t.writeAfterUpdate&&t.writeAfterUpdate(),"function"==typeof t.readAfterUpdate&&ki().readDocument((function(){t.readAfterUpdate()})),xi--}function Mi(t,e=!0){Si++,Ai(t.virtualNode),1===Si&&e&&t.element.remove(),Si--}function Ai(t){t.component&&"function"==typeof t.component.destroy?t.component.destroy():t.children&&t.children.forEach(Ai)}var ji={initialize:function(t){if("function"!=typeof t.update)throw new Error("Etch components must implement `update(props, children)`.");let e=t.render();if(!Ei(e)){let r=t.constructor&&t.constructor.name?" in "+t.constructor.name:"";throw new Error("invalid falsy value "+e+" returned from render()"+r)}Oi(t,e),t.refs={},t.virtualNode=e,t.element=pi(t.virtualNode,{refs:t.refs,listenerContext:t})},update:function(t,e=!0){if(xi>0)return Pi(t,e),Promise.resolve();let r=ki();return _i.has(t)||(_i.add(t),r.updateDocument((function(){_i.delete(t),Pi(t,e)}))),r.getNextUpdatePromise()},updateSync:Pi,destroy:function(t,e=!0){if(xi>0||Si>0)return Mi(t,e),Promise.resolve();let r=ki();return r.updateDocument((function(){Mi(t,e)})),r.getNextUpdatePromise()},destroySync:Mi};const{initialize:Ti,update:Ci,updateSync:Di,destroy:Ii,destroySync:Ni}=ji,{setScheduler:Ri,getScheduler:Li}=wi;var Fi={dom:ni,render:pi,initialize:Ti,update:Ci,updateSync:Di,destroy:Ii,destroySync:Ni,setScheduler:Ri,getScheduler:Li},Bi=Fi.dom,Ui=Fi.initialize,zi=Fi.update,qi=Fi.destroy;class $i{constructor(t){this.props=t,this.tooltipTitle=()=>{const t=void 0!==this.props.spec.displayName?this.props.spec.displayName:"Undefined name";return this.hiddenValue?`${t}: ${this.props.spec.displayTemplate(this.value)}`:t},this.disposables=new e.CompositeDisposable,this.hiddenValue=atom.config.get("ide-haskell.hideParameterValues"),this.initStore(),this.initSpec(),Ui(this),this.disposables.add(atom.config.onDidChange("ide-haskell.hideParameterValues",({newValue:t})=>{this.hiddenValue=t,Kn(this.update())})),this.disposables.add(atom.tooltips.add(this.element,{title:this.tooltipTitle}))}render(){const t=["ide-haskell--"+this.props.pluginName,"ide-haskell-param--"+this.props.name];return this.hiddenValue&&t.push("hidden-value"),Bi("ide-haskell-param",{class:t.join(" "),on:{click:async()=>this.setValue()}},Bi("ide-haskell-param-value",null,this.props.spec.displayTemplate(this.value)))}async update(t){if(t){const{pluginName:e,name:r,spec:n,store:i}=t;void 0!==e&&(this.props.pluginName=e),void 0!==r&&(this.props.name=r),n&&this.props.spec!==n&&(this.props.spec=n,this.initSpec()),i&&this.props.store!==i&&(this.props.store=i,this.initStore())}return zi(this)}async setValue(t){await this.props.store.setValue(this.props.pluginName,this.props.name,t),Kn(this.update())}async destroy(){await qi(this),this.disposables.dispose()}initStore(){this.storeDisposable&&this.disposables.remove(this.storeDisposable),this.storeDisposable=this.props.store.onDidUpdate(this.props.pluginName,this.props.name,({value:t})=>{this.value=t,Kn(this.update())}),this.disposables.add(this.storeDisposable),Kn(this.setValueInitial())}async setValueInitial(){return this.value=await this.props.store.getValueRaw(this.props.pluginName,this.props.name),this.update()}initSpec(){void 0===this.props.spec.displayName&&(this.props.spec.displayName=this.props.name.charAt(0).toUpperCase()+this.props.name.slice(1))}}var Vi={onCopy:"copy",onCut:"cut",onPaste:"paste",onCompositionEnd:"compositionend",onCompositionStart:"compositionstart",onCompositionUpdate:"compositionupdate",onKeyDown:"keydown",onKeyPress:"keypress",onKeyUp:"keyup",onFocus:"focus",onBlur:"blur",onChange:"change",onInput:"input",onSubmit:"submit",onClick:"click",onContextMenu:"contextmenu",onDoubleClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragEnter:"dragenter",onDragExit:"dragexit",onDragLeave:"dragleave",onDragOver:"dragover",onDragStart:"dragstart",onDrop:"drop",onMouseDown:"mousedown",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onSelect:"select",onTouchCancel:"touchcancel",onTouchEnd:"touchend",onTouchMove:"touchmove",onTouchStart:"touchstart",onScroll:"scroll",onWheel:"wheel",onAbort:"abort",onCanPlay:"canplay",onCanPlayThrough:"canplaythrough",onDurationChange:"durationchange",onEmptied:"emptied",onEncrypted:"encrypted",onEnded:"ended",onError:"error",onLoadedData:"loadeddata",onLoadedMetadata:"loadedmetadata",onLoadStart:"loadstart",onPause:"pause",onPlay:"play",onPlaying:"playing",onProgress:"progress",onRateChange:"ratechange",onSeeked:"seeked",onSeeking:"seeking",onStalled:"stalled",onSuspend:"suspend",onTimeUpdate:"timeupdate",onVolumeChange:"volumechange",onWaiting:"waiting",onLoad:"load",onAnimationStart:"animationstart",onAnimationEnd:"animationend",onAnimationIteration:"animationiteration",onTransitionEnd:"transitionend"},Gi=new Set(["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]);function Hi(t,e,...r){for(let t=0;t<r.length;){const e=r[t];switch(typeof e){case"string":case"number":r[t]={text:e},t++;break;case"object":Array.isArray(e)?r.splice(t,1,...e):e?t++:r.splice(t,1);break;default:throw new Error("Invalid child node: "+e)}}if(e){for(const t in e){const r=Vi[t];r&&(e.on||(e.on={}),e.on[r]=e[t])}e.class&&(e.className=e.class)}return{tag:t,props:e,children:r}}const Wi=["a","abbr","address","article","aside","audio","b","bdi","bdo","blockquote","body","button","canvas","caption","cite","code","colgroup","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","html","i","iframe","ins","kbd","label","legend","li","main","map","mark","menu","meter","nav","noscript","object","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","u","ul","var","video","area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];for(const t of Wi)Hi[t]=(e,...r)=>Hi(t,e,...r);for(const t of Gi)Hi[t]=(e,...r)=>Hi(t,e,...r);var Qi=Hi,Ki=new Map([["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["className","class"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["panose1","panose-1"],["paintOrder","paint-order"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xHeight","x-height"]]);var Xi=function(t,e,r,n){const i=e&&e.props,o=r.props;let s,a;n&&(s=n.refs,a=n.listenerContext),function t(e,r,n,i,o){if(n)for(var s in n)"ref"!==s&&"on"!==s&&(s in Vi||o&&s in o||("dataset"===s?t(e.dataset,null,n&&n.dataset,null,null):"innerHTML"!==s&&r&&Gi.has(r.tag)?e.removeAttribute(Ki.get(s)||s):(e[s]="",delete e[s])));if(o)for(var s in o)if("ref"!==s&&"on"!==s&&!(s in Vi)){var a=n&&n[s],c=o[s];"dataset"===s?Yi(e.dataset,a,c,!1):"style"===s&&"string"!=typeof c?("string"==typeof a&&(e.style="",a=null),Yi(e.style,a,c,!0)):"attributes"===s?Zi(e,a,c):c!==a&&("innerHTML"!==s&&i&&Gi.has(i.tag)?e.setAttribute(Ki.get(s)||s,c):i&&"input"===i.tag&&"value"===s&&e[s]===c||(e[s]=c))}}(t,e,i,r,o),s&&function(t,e,r,n){r!==e&&(e&&n[e]===t&&delete n[e],r&&(n[r]=t))}(t,i&&i.ref,o&&o.ref,s),function(t,e,r,n){const i=e&&e.props&&e.props.on,o=r.props&&r.props.on;for(const r in i)if(!o||!(r in o)){let n;n=e&&e.boundListeners&&e.boundListeners[r]?e.boundListeners[r]:i[r],t.removeEventListener(r,n)}for(const s in o){const a=i&&i[s],c=o[s];if(c!==a){if(a){let r;r=e&&e.boundListeners&&e.boundListeners[s]?e.boundListeners[s]:a,t.removeEventListener(s,r)}if(c){let e;n?(e=c.bind(n),r.boundListeners||(r.boundListeners={}),r.boundListeners[s]=e):e=c,t.addEventListener(s,e)}}}}(t,e,r,a)};function Yi(t,e,r,n){if(e)for(var i in e)r&&i in r||(n?t[i]="":delete t[i]);if(r)for(var i in r){const n=e&&e[i],o=r[i];o!==n&&(t[i]=o)}}function Zi(t,e,r){if(e)for(var n in e)r&&n in r||t.removeAttribute(n);if(r)for(var n in r){const i=e&&e[n],o=r[n];o!==i&&t.setAttribute(n,o)}}function Ji(t,e){let r;if(null!=t.text)r=document.createTextNode(t.text);else{const{tag:n,children:i}=t;let{props:o}=t;if("function"==typeof n){let s;o&&o.ref&&(s=o.ref);const a=new n(o||{},i);t.component=a,r=a.element,e&&e.refs&&s&&(e.refs[s]=a)}else Gi.has(n)?(r=document.createElementNS("http://www.w3.org/2000/svg",n),i&&to(r,i,e),o&&Xi(r,null,t,e)):(r=document.createElement(n),i&&to(r,i,e),o&&Xi(r,null,t,e))}return t.domNode=r,r}function to(t,e,r){for(let n=0;n<e.length;n++)t.appendChild(Ji(e[n],r))}var eo=Ji;function ro(t,e,r){const n=t.domNode;if(e===t)return n;if(oo(t,e)){let i;return null!=e.text?(n.nodeValue=e.text,i=n):"function"==typeof e.tag?i=function(t,e,r){const{component:n,props:i}=t;let{props:o,children:s}=e;if(e.component=n,r&&r.refs){const t=r.refs,e=i&&i.ref,s=o&&o.ref;s!==e&&(e&&t[e]===n&&delete t[e],s&&(t[s]=n))}return n.update(o||{},s),n.element}(t,e,r):(!function(t,e,r,n){var i,o=0,s=e.length-1,a=e[0],c=e[s],l=0,u=r.length-1,p=r[0],h=r[u];for(;o<=s&&l<=u;)if(a)if(c)if(oo(a,p))ro(a,p,n),a=e[++o],p=r[++l];else if(oo(c,h))ro(c,h,n),c=e[--s],h=r[--u];else if(oo(a,h))ro(a,h,n),t.insertBefore(a.domNode,c.domNode.nextSibling),a=e[++o],h=r[--u];else if(oo(c,p))ro(c,p,n),t.insertBefore(c.domNode,a.domNode),c=e[--s],p=r[++l];else{i||(no.length>0?(i=no.pop()).clear():i=new Map,ao(i,e,o,s));var d=so(p),f=d?i.get(d):null;if(null==f)t.insertBefore(eo(p,n),a.domNode),p=r[++l];else{var m=e[f];ro(m,p,n),e[f]=void 0,t.insertBefore(m.domNode,a.domNode),p=r[++l]}}else c=e[--s];else a=e[++o];if(o>s){var g=r[u+1]?r[u+1].domNode:null;for(let e=l;e<=u;e++)t.insertBefore(eo(r[e],n),g)}else if(l>u)for(let t=o;t<=s;t++){var v=e[t];v&&io(v,n&&n.refs)}i&&no.push(i)}(n,t.children,e.children,r),Xi(n,t,e,r),i=n),e.domNode=i,i!==n&&n.parentNode&&n.parentNode.replaceChild(i,n),i}{const i=n.parentNode,o=n.nextSibling;io(t,r&&r.refs);const s=eo(e,r);return i&&i.insertBefore(s,o),e.domNode=s,s}}let no=[new Map,new Map,new Map,new Map];function io(t,e,r=!0){const{domNode:n,props:i,children:o,component:s}=t,a=i&&i.ref;if(s)e&&a&&e[a]===s&&delete e[a],s.destroy&&s.destroy();else if(e&&a&&e[a]===n&&delete e[a],o)for(let t=0;t<o.length;t++)io(o[t],e,!1);r&&n.remove()}function oo(t,e){return so(t)===so(e)&&t.tag===e.tag}function so(t){return t.props?t.props.key:void 0}function ao(t,e,r,n){for(let i=r;i<=n;i++){const r=so(e[i]);r&&t.set(r,i)}return t}var co=ro;let lo=null;var uo={setScheduler:function(t){lo=t},getScheduler:function(){return lo||(lo=new class{constructor(){this.updateRequests=[],this.readRequests=[],this.pendingAnimationFrame=null,this.performUpdates=this.performUpdates.bind(this),this.performingUpdates=!1}updateDocument(t){this.updateRequests.push(t),this.pendingAnimationFrame||(this.pendingAnimationFrame=window.requestAnimationFrame(this.performUpdates))}readDocument(t){this.readRequests.push(t),this.pendingAnimationFrame||(this.pendingAnimationFrame=window.requestAnimationFrame(this.performUpdates))}getNextUpdatePromise(){return this.nextUpdatePromise||(this.nextUpdatePromise=new Promise(t=>{this.resolveNextUpdatePromise=t})),this.nextUpdatePromise}performUpdates(){for(;this.updateRequests.length>0;)this.updateRequests.shift()();for(this.pendingAnimationFrame=null;this.readRequests.length>0;)this.readRequests.shift()();if(this.nextUpdatePromise){let t=this.resolveNextUpdatePromise;this.nextUpdatePromise=null,this.resolveNextUpdatePromise=null,t()}}}),lo}};const{getScheduler:po}=uo,ho=new WeakSet;let fo=0,mo=0;function go(t){return null!=t&&!1!==t}function vo(t,e=!0){if(!go(t.virtualNode))throw new Error((t.constructor?t.constructor.name+" instance":t)+" is not associated with a valid virtualNode. Perhaps this component was never initialized?");if(null==t.element)throw new Error((t.constructor?t.constructor.name+" instance":t)+" is not associated with a DOM element. Perhaps this component was never initialized?");let r=t.render();if(!go(r)){const e=t.constructor&&t.constructor.name?" in "+t.constructor.name:"";throw new Error("invalid falsy value "+r+" returned from render()"+e)}fo++;let n=t.virtualNode,i=t.element,o=co(n,r,{refs:t.refs,listenerContext:t});if(t.virtualNode=r,o!==i&&!e)throw new Error("The root node type changed on update, but the update was performed with the replaceNode option set to false");t.element=o,"function"==typeof t.writeAfterUpdate&&t.writeAfterUpdate(),"function"==typeof t.readAfterUpdate&&po().readDocument((function(){t.readAfterUpdate()})),fo--}function yo(t,e=!0){mo++,bo(t.virtualNode),1===mo&&e&&t.element.remove(),mo--}function bo(t){t.component&&"function"==typeof t.component.destroy?t.component.destroy():t.children&&t.children.forEach(bo)}var wo={initialize:function(t){if("function"!=typeof t.update)throw new Error("Etch components must implement `update(props, children)`.");let e=t.render();if(!go(e)){let r=t.constructor&&t.constructor.name?" in "+t.constructor.name:"";throw new Error("invalid falsy value "+e+" returned from render()"+r)}t.refs={},t.virtualNode=e,t.element=eo(t.virtualNode,{refs:t.refs,listenerContext:t})},update:function(t,e=!0){if(fo>0)return vo(t,e),Promise.resolve();let r=po();return ho.has(t)||(ho.add(t),r.updateDocument((function(){ho.delete(t),vo(t,e)}))),r.getNextUpdatePromise()},updateSync:vo,destroy:function(t,e=!0){if(fo>0||mo>0)return yo(t,e),Promise.resolve();let r=po();return r.updateDocument((function(){yo(t,e)})),r.getNextUpdatePromise()},destroySync:yo};const{initialize:ko,update:_o,updateSync:xo,destroy:So,destroySync:Eo}=wo,{setScheduler:Oo,getScheduler:Po}=uo;var Mo={dom:Qi,render:eo,initialize:ko,update:_o,updateSync:xo,destroy:So,destroySync:Eo,setScheduler:Oo,getScheduler:Po},Ao=S((function(t,e){(function(){var t,r;t=i.sep,e.basenameScore=function(r,n,i){var o,s,a,c,l;for(s=r.length-1;r[s]===t;)s--;for(l=0,a=s,o=null;s>=0;)r[s]===t?(l++,null==o&&(o=r.substring(s+1,a+1))):0===s&&(a<r.length-1?null==o&&(o=r.substring(0,a+1)):null==o&&(o=r)),s--;return o===r?i*=2:o&&(i+=e.score(o,n)),c=l+1,i*=.01*Math.max(1,10-c)},e.score=function(e,n){var i,o,s,a,c,l,u,p,h,d,f,m;if(e===n)return 1;if(r(e,n))return 1;for(d=0,u=n.length,h=e.length,s=0,a=0;s<u;){if(i=n[s++],c=e.indexOf(i.toLowerCase()),f=e.indexOf(i.toUpperCase()),-1===(l=Math.min(c,f))&&(l=Math.max(c,f)),-1===(a=l))return 0;o=.1,e[a]===i&&(o+=.1),0===a||e[a-1]===t?o+=.8:"-"!==(m=e[a-1])&&"_"!==m&&" "!==m||(o+=.7),e=e.substring(a+1,h),d+=o}return((p=d/u)*(u/h)+p)/2},r=function(e,r){if(e[e.length-r.length-1]===t)return e.lastIndexOf(r)===e.length-r.length}}).call(_)})),jo=(Ao.basenameScore,Ao.score,S((function(t){(function(){var e,r,n;r=Ao,e=function(t){return t.candidate},n=function(t,e){return e.score-t.score},t.exports=function(t,i,o,s){var a,c,l,u,p,h,d,f,m;if(c=(m=null!=s?s:{}).key,l=m.maxResults,i){for(p=[],d=0,f=t.length;d<f;d++)a=t[d],(h=null!=c?a[c]:a)&&(u=r.score(h,i,o),o||(u=r.basenameScore(h,i,u)),u>0&&p.push({candidate:a,score:u}));p.sort(n),t=p.map(e)}return null!=l&&(t=t.slice(0,l)),t}}).call(_)}))),To=S((function(t,e){(function(){var t;t=i.sep,e.basenameMatch=function(r,n){var i,o,s;for(o=r.length-1;r[o]===t;)o--;for(s=o,i=null;o>=0;)r[o]===t?null==i&&(i=r.substring(o+1,s+1)):0===o&&(s<r.length-1?null==i&&(i=r.substring(0,s+1)):null==i&&(i=r)),o--;return e.match(i,n,r.length-i.length)},e.match=function(t,e,r){var n,i,o,s,a,c,l,u,p,h;if(null==r&&(r=0),t===e)return function(){h=[];for(var e=r,n=r+t.length;r<=n?e<n:e>n;r<=n?e++:e--)h.push(e);return h}.apply(this);for(l=e.length,u=t.length,i=0,o=0,a=[];i<l;){if(n=e[i++],s=t.indexOf(n.toLowerCase()),p=t.indexOf(n.toUpperCase()),-1===(c=Math.min(s,p))&&(c=Math.max(s,p)),-1===(o=c))return[];a.push(r+o),r+=o+1,t=t.substring(o+1,u)}return a}}).call(_)})),Co=(To.basenameMatch,To.match,S((function(t){(function(){var e,r,n,o,s;s=Ao,n=jo,o=To,e=i.sep,r=/\ /g,t.exports={filter:function(t,i,o){var s;return i&&(s=-1!==i.indexOf(e),i=i.replace(r,"")),n(t,i,s,o)},score:function(t,n){var i,o;return t&&n?t===n?2:(i=-1!==n.indexOf(e),n=n.replace(r,""),o=s.score(t,n),i||(o=s.basenameScore(t,n,o)),o):0},match:function(t,n){var i,s,a,c,l,u;if(!t)return[];if(!n)return[];if(t===n)return function(){u=[];for(var e=0,r=t.length;0<=r?e<r:e>r;0<=r?e++:e--)u.push(e);return u}.apply(this);if(c=-1!==n.indexOf(e),n=n.replace(r,""),a=o.match(t,n),!c)for(i=o.basenameMatch(t,n),a=a.concat(i).sort((function(t,e){return t-e})),l=null,s=0;s<a.length;)s&&l===a[s]?a.splice(s,1):(l=a[s],s++);return a}}}).call(_)})));Co.filter,Co.score,Co.match;const{Disposable:Do,CompositeDisposable:Io,TextEditor:No}=r,Ro=Mo.dom;class Lo{constructor(t){this.mouseDown=this.mouseDown.bind(this),this.mouseUp=this.mouseUp.bind(this),this.didClick=this.didClick.bind(this),this.selected=t.selected,this.onclick=t.onclick,this.element=t.element,this.element.addEventListener("mousedown",this.mouseDown),this.element.addEventListener("mouseup",this.mouseUp),this.element.addEventListener("click",this.didClick),this.selected&&this.element.classList.add("selected"),this.domEventsDisposable=new Do(()=>{this.element.removeEventListener("mousedown",this.mouseDown),this.element.removeEventListener("mouseup",this.mouseUp),this.element.removeEventListener("click",this.didClick)}),Mo.getScheduler().updateDocument(this.scrollIntoViewIfNeeded.bind(this))}mouseDown(t){t.preventDefault()}mouseUp(t){t.preventDefault()}didClick(t){t.preventDefault(),this.onclick()}destroy(){this.element.remove(),this.domEventsDisposable.dispose()}update(t){this.element.removeEventListener("mousedown",this.mouseDown),this.element.removeEventListener("mouseup",this.mouseUp),this.element.removeEventListener("click",this.didClick),this.element.parentNode.replaceChild(t.element,this.element),this.element=t.element,this.element.addEventListener("mousedown",this.mouseDown),this.element.addEventListener("mouseup",this.mouseUp),this.element.addEventListener("click",this.didClick),t.selected&&this.element.classList.add("selected"),this.selected=t.selected,this.onclick=t.onclick,Mo.getScheduler().updateDocument(this.scrollIntoViewIfNeeded.bind(this))}scrollIntoViewIfNeeded(){this.selected&&this.element.scrollIntoViewIfNeeded(!1)}}async function Fo({items:t,heading:e,itemTemplate:r,itemFilterKey:n,activeItem:i}){const o=t=>{const e=document.createElement("li"),n=document.createElement("div");let o;return n.style.display="inline-block",r?(n.innerHTML=r(t),o=i&&r(t)===r(i)):(n.innerText=""+t,o=i&&t===i),o&&e.classList.add("active"),n.firstElementChild&&"LI"===n.firstElementChild.tagName&&(n.innerHTML=n.firstElementChild.innerHTML),e.appendChild(n),e},s=t=>"string"==typeof n?""+t[n]:n?n(t):""+t,a=await Promise.resolve(t);let c;try{return await new Promise(t=>{const r=new class{static setScheduler(t){Mo.setScheduler(t)}static getScheduler(t){return Mo.getScheduler()}constructor(t){this.props=t,this.props.hasOwnProperty("initialSelectionIndex")||(this.props.initialSelectionIndex=0),t.initiallyVisibleItemCount&&this.initializeVisibilityObserver(),this.computeItems(!1),this.disposables=new Io,Mo.initialize(this),this.element.classList.add("select-list"),this.disposables.add(this.refs.queryEditor.onDidChange(this.didChangeQuery.bind(this))),t.skipCommandsRegistration||this.disposables.add(this.registerAtomCommands());const e=this.refs.queryEditor.element,r=this.didLoseFocus.bind(this);e.addEventListener("blur",r),this.didClickItemsList=!1,this.element.addEventListener("mousedown",t=>{t.target===this.refs.items&&(this.didClickItemsList=!0)}),this.disposables.add(new Do(()=>{e.removeEventListener("blur",r)}))}initializeVisibilityObserver(){this.visibilityObserver=new IntersectionObserver(t=>{for(const e of t)if(e.intersectionRatio>0){const t=e.target;this.visibilityObserver.unobserve(t);const r=Array.from(this.refs.items.children).indexOf(t);r>=0&&this.renderItemAtIndex(r)}})}focus(){this.refs.queryEditor.element.focus()}didLoseFocus(t){this.didClickItemsList||this.element.contains(t.relatedTarget)?(this.didClickItemsList=!1,this.refs.queryEditor.element.focus()):document.hasFocus()&&this.cancelSelection()}reset(){this.refs.queryEditor.setText("")}destroy(){return this.disposables.dispose(),this.visibilityObserver&&this.visibilityObserver.disconnect(),Mo.destroy(this)}registerAtomCommands(){return _.atom.commands.add(this.element,{"core:move-up":t=>{this.selectPrevious(),t.stopPropagation()},"core:move-down":t=>{this.selectNext(),t.stopPropagation()},"core:move-to-top":t=>{this.selectFirst(),t.stopPropagation()},"core:move-to-bottom":t=>{this.selectLast(),t.stopPropagation()},"core:confirm":t=>{this.confirmSelection(),t.stopPropagation()},"core:cancel":t=>{this.cancelSelection(),t.stopPropagation()}})}update(t={}){let e=!1;return t.hasOwnProperty("items")&&(this.props.items=t.items,e=!0),t.hasOwnProperty("maxResults")&&(this.props.maxResults=t.maxResults,e=!0),t.hasOwnProperty("filter")&&(this.props.filter=t.filter,e=!0),t.hasOwnProperty("filterQuery")&&(this.props.filterQuery=t.filterQuery,e=!0),t.hasOwnProperty("query")&&(this.refs.queryEditor.setText(t.query),e=!1),t.hasOwnProperty("selectQuery")&&(t.selectQuery?this.refs.queryEditor.selectAll():this.refs.queryEditor.clearSelections()),t.hasOwnProperty("order")&&(this.props.order=t.order),t.hasOwnProperty("emptyMessage")&&(this.props.emptyMessage=t.emptyMessage),t.hasOwnProperty("errorMessage")&&(this.props.errorMessage=t.errorMessage),t.hasOwnProperty("infoMessage")&&(this.props.infoMessage=t.infoMessage),t.hasOwnProperty("loadingMessage")&&(this.props.loadingMessage=t.loadingMessage),t.hasOwnProperty("loadingBadge")&&(this.props.loadingBadge=t.loadingBadge),t.hasOwnProperty("itemsClassList")&&(this.props.itemsClassList=t.itemsClassList),t.hasOwnProperty("initialSelectionIndex")&&(this.props.initialSelectionIndex=t.initialSelectionIndex),e&&this.computeItems(),Mo.update(this)}render(){return Ro.div({},Ro(No,{ref:"queryEditor",mini:!0}),this.renderLoadingMessage(),this.renderInfoMessage(),this.renderErrorMessage(),this.renderItems())}renderItems(){if(this.items.length>0){const t=["list-group"].concat(this.props.itemsClassList||[]).join(" ");return this.visibilityObserver&&Mo.getScheduler().updateDocument(()=>{Array.from(this.refs.items.children).slice(this.props.initiallyVisibleItemCount).forEach(t=>{this.visibilityObserver.observe(t)})}),this.listItems=this.items.map((t,e)=>{const r=this.getSelectedItem()===t,n=!this.props.initiallyVisibleItemCount||e<this.props.initiallyVisibleItemCount;return Ro(Lo,{element:this.props.elementForItem(t,{selected:r,index:e,visible:n}),selected:r,onclick:()=>this.didClickItem(e)})}),Ro.ol({className:t,ref:"items"},...this.listItems)}return!this.props.loadingMessage&&this.props.emptyMessage?Ro.span({ref:"emptyMessage"},this.props.emptyMessage):""}renderErrorMessage(){return this.props.errorMessage?Ro.span({ref:"errorMessage"},this.props.errorMessage):""}renderInfoMessage(){return this.props.infoMessage?Ro.span({ref:"infoMessage"},this.props.infoMessage):""}renderLoadingMessage(){return this.props.loadingMessage?Ro.div({className:"loading"},Ro.span({ref:"loadingMessage",className:"loading-message"},this.props.loadingMessage),this.props.loadingBadge?Ro.span({ref:"loadingBadge",className:"badge"},this.props.loadingBadge):""):""}getQuery(){return this.refs&&this.refs.queryEditor?this.refs.queryEditor.getText():""}getFilterQuery(){return this.props.filterQuery?this.props.filterQuery(this.getQuery()):this.getQuery()}didChangeQuery(){this.props.didChangeQuery&&this.props.didChangeQuery(this.getFilterQuery()),this.computeItems()}didClickItem(t){this.selectIndex(t),this.confirmSelection()}computeItems(t){this.listItems=null,this.visibilityObserver&&this.visibilityObserver.disconnect();const e=this.props.filter||this.fuzzyFilter.bind(this);this.items=e(this.props.items.slice(),this.getFilterQuery()),this.props.order&&this.items.sort(this.props.order),this.props.maxResults&&(this.items=this.items.slice(0,this.props.maxResults)),this.selectIndex(this.props.initialSelectionIndex,t)}fuzzyFilter(t,e){if(0===e.length)return t;{const r=[];for(const n of t){const t=this.props.filterKeyForItem?this.props.filterKeyForItem(n):n;let i=Co.score(t,e);i>0&&r.push({item:n,score:i})}return r.sort((t,e)=>e.score-t.score),r.map(t=>t.item)}}getSelectedItem(){return void 0===this.selectionIndex?null:this.items[this.selectionIndex]}renderItemAtIndex(t){const e=this.items[t],r=this.getSelectedItem()===e,n=this.listItems[t].component;this.visibilityObserver&&this.visibilityObserver.unobserve(n.element),n.update({element:this.props.elementForItem(e,{selected:r,index:t,visible:!0}),selected:r,onclick:()=>this.didClickItem(t)})}selectPrevious(){return void 0===this.selectionIndex?this.selectLast():this.selectIndex(this.selectionIndex-1)}selectNext(){return void 0===this.selectionIndex?this.selectFirst():this.selectIndex(this.selectionIndex+1)}selectFirst(){return this.selectIndex(0)}selectLast(){return this.selectIndex(this.items.length-1)}selectNone(){return this.selectIndex(void 0)}selectIndex(t,e=!0){t>=this.items.length?t=0:t<0&&(t=this.items.length-1);const r=this.selectionIndex;return this.selectionIndex=t,void 0!==t&&this.props.didChangeSelection&&this.props.didChangeSelection(this.getSelectedItem()),e?this.listItems?(r>=0&&this.renderItemAtIndex(r),t>=0&&this.renderItemAtIndex(t),Mo.getScheduler().getNextUpdatePromise()):Mo.update(this):Promise.resolve()}selectItem(t){const e=this.items.indexOf(t);if(-1===e)throw new Error("Cannot select the specified item because it does not exist.");return this.selectIndex(e)}confirmSelection(){const t=this.getSelectedItem();null!=t?this.props.didConfirmSelection&&this.props.didConfirmSelection(t):this.props.didConfirmEmptySelection&&this.props.didConfirmEmptySelection()}cancelSelection(){this.props.didCancelSelection&&this.props.didCancelSelection()}}({items:a,infoMessage:e,itemsClassList:["ide-haskell","mark-active"],elementForItem:o,filterKeyForItem:s,didCancelSelection:()=>{t()},didConfirmSelection:e=>{t(e)}});r.element.classList.add("ide-haskell"),c=atom.workspace.addModalPanel({item:r,visible:!0}),r.focus()})}finally{c&&c.destroy()}}class Bo{constructor(t={}){this.disposables=new e.CompositeDisposable,this.emitter=new e.Emitter,this.disposables.add(this.emitter),this.saved=t,this.plugins=new Map}serialize(){return this.saved}destroy(){this.disposables.dispose()}onDidUpdate(t,e,r){return this.emitter.on("did-update",n=>{n.pluginName===t&&n.paramName===e&&r(n)})}addParamSpec(t,r,n){let i=this.plugins.get(t);if(i||(i=new Map,this.plugins.set(t,i)),i.has(r))throw new Error(`Parameter ${t}.${r} already defined!`);let o=this.saved[`${t}.${r}`];return void 0===o&&(o=n.default),i.set(r,{spec:n,value:o}),this.emitter.emit("did-update",{pluginName:t,paramName:r,value:o}),new e.Disposable(()=>{i&&(i.delete(r),0===i.size&&this.plugins.delete(t))})}async setValue(t,e,r){const n=await this.getParamConfig(t,e,"set");if(void 0!==n)return void 0===r&&(r=await this.showSelect(n)),void 0!==r&&(n.value=r,this.saved[`${t}.${e}`]=r,this.emitter.emit("did-update",{pluginName:t,paramName:e,value:r})),r}async getValue(t,e){const r=await this.getParamConfig(t,e,"get");if(void 0!==r)return void 0===r.value&&await this.setValue(t,e),r.value}async getValueRaw(t,e){const r=await this.getParamConfig(t,e,"get raw");if(void 0!==r)return r.value}async getParamConfig(t,e,r){if(!atom.packages.isPackageLoaded(t))return void console.error(new Error(`No ${t} package while trying to ${r} ${t}.${e}`));atom.packages.isPackageActive(t)||await atom.packages.activatePackage(t);const n=this.plugins.get(t);if(!n)throw new Error(`${t} is not defined while trying to ${r} ${t}.${e}`);const i=n.get(e);if(!i)throw new Error(`${e} is not defined while trying to ${r} ${t}.${e}`);return i}async showSelect(t){const e=t.spec;return Fo({items:"function"==typeof e.items?e.items():e.items,heading:e.description,itemTemplate:e.itemTemplate.bind(e),itemFilterKey:e.itemFilterKey,activeItem:t.value})}}class Uo{constructor(t,e){this.outputPanel=t,this.store=new Bo(e)}destroy(){this.store.destroy()}serialize(){return this.store.serialize()}add(t,r,n){const i=new e.CompositeDisposable;return i.add(this.store.addParamSpec(t,r,n),this.outputPanel.addPanelControl({element:$i,opts:{pluginName:t,name:r,spec:n,store:this.store}})),i}async get(t,e){return this.store.getValue(t,e)}async set(t,e,r){return this.store.setValue(t,e,r)}}class zo{constructor(t){Array.isArray(t)?this.message=t.map(t=>Bi("div",{key:t,innerHTML:t.toHtml()})):this.message=[Bi("div",{key:t,innerHTML:t.toHtml()})],Ui(this)}render(){return Bi("ide-haskell-tooltip",null,this.message)}async update(){return zi(this)}writeAfterUpdate(){this.element.parentElement&&this.element.parentElement.classList.add("ide-haskell")}}class qo{constructor(t,e){this.editor=t,this.table=Object.create(null);for(const t of R)this.table[t]=new Map;this.layers=new Set;for(const t of e){const e=this.editor.addMarkerLayer();this.layers.add(e);for(const{type:r,source:n}of t)this.table[r].set(n,e)}}destroy(){for(const t of this.layers.values())t.destroy();for(const t of this.values())t.clear()}get(t,e){const r=this.table[t];let n=r.get(e);if(n||(n=r.get(void 0)),!n)throw new Error(`Failed to classify ${t}:${e}`);return n}clear(){for(const t of this.layers.values())t.clear()}getMarkerCount(){let t=0;for(const e of this.layers.values())t+=e.getMarkerCount();return t}*values(){for(const t of R)yield this.table[t]}*entries(){for(const t of R)yield[t,this.table[t]]}}class $o{constructor(t){this.editor=t,this.markers=new qo(t,[[{type:"keyboard"},{type:"context"}],[{type:"mouse"},{type:"selection"}]]),this.editorElement=atom.views.getView(this.editor)}dispose(){this.markers.destroy(),this.editorElement.classList.remove("ide-haskell--has-tooltips")}show(t,e,r,n,i){this.hide(r,n);const o=this.markers.get(r,n).markBufferRange(t);o.setProperties(i),this.decorate(o,new zo(e)),this.editorElement.classList.add("ide-haskell--has-tooltips")}hide(t,e,r){void 0!==t?(r?this.markers.get(t,e).findMarkers(r).forEach(t=>t.destroy()):this.markers.get(t,e).clear(),this.has()||this.editorElement.classList.remove("ide-haskell--has-tooltips")):this.markers.clear()}has(t,e,r){return void 0===t?this.markers.getMarkerCount()>0:r?this.markers.get(t,e).findMarkers(r).length>0:this.markers.get(t,e).getMarkerCount()>0}decorate(t,e){this.editor.decorateMarker(t,{type:"overlay",position:"tail",item:e}),this.editor.decorateMarker(t,{type:"highlight",class:"ide-haskell-type"})}}class Vo{constructor(t,r){this.editor=t,this.trackMouseBufferPosition=t=>{const e=Qn(this.editor,t);e&&(this.lastMouseBufferPt&&this.lastMouseBufferPt.isEqual(e)||(this.lastMouseBufferPt=e,void 0!==this.exprTypeTimeout&&clearTimeout(this.exprTypeTimeout),this.exprTypeTimeout=window.setTimeout(()=>{this.shouldShowTooltip(e,"mouse")},atom.config.get("ide-haskell.expressionTypeInterval",{scope:this.editor.getRootScopeDescriptor()}))))},this.stopTrackingMouseBufferPosition=()=>{if(void 0!==this.exprTypeTimeout)return clearTimeout(this.exprTypeTimeout)},this.trackSelection=({newBufferRange:t})=>{this.handleCursorUnderTooltip(t),void 0!==this.selTimeout&&clearTimeout(this.selTimeout),t.isEmpty()?(this.tooltips.hide("selection"),void 0!==this.exprTypeTimeout&&clearTimeout(this.exprTypeTimeout),Kn(this.tooltipRegistry.showTooltip(this.editor,"keyboard")),"Hide Tooltip"===atom.config.get("ide-haskell.onCursorMove",{scope:this.editor.getRootScopeDescriptor()})&&(this.tooltips.hide("mouse",void 0,{persistent:!1}),this.tooltips.hide("context",void 0,{persistent:!1}))):this.selTimeout=window.setTimeout(()=>this.shouldShowTooltip(t.start,"selection"),atom.config.get("ide-haskell.expressionTypeInterval",{scope:this.editor.getRootScopeDescriptor()}))},this.disposables=new e.CompositeDisposable,this.tooltips=new $o(this.editor),this.disposables.add(this.tooltips),this.tooltipRegistry=r.tooltipRegistry,this.editorElement=atom.views.getView(this.editor);const n=this.editor.getBuffer();this.disposables.add(n.onWillSave(async()=>{await r.willSaveBuffer(n)}),n.onDidSave(()=>r.didSaveBuffer(n)),this.editor.onDidStopChanging(()=>r.didStopChanging(n)),this.editorElement.onDidChangeScrollLeft(()=>this.tooltips.hide("mouse")),this.editorElement.onDidChangeScrollTop(()=>this.tooltips.hide("mouse")),Hn(this.editorElement,"mousemove",".scroll-view",this.trackMouseBufferPosition),Hn(this.editorElement,"mouseout",".scroll-view",this.stopTrackingMouseBufferPosition),this.editor.onDidChangeSelectionRange(this.trackSelection))}static supportsGrammar(t){return["source.haskell","text.tex.latex.haskell"].includes(t)}destroy(){void 0!==this.exprTypeTimeout&&clearTimeout(this.exprTypeTimeout),void 0!==this.selTimeout&&clearTimeout(this.selTimeout),this.disposables.dispose(),this.lastMouseBufferPt=void 0}getEventRange(t){let r,n;switch(t){case"mouse":case"context":if(!this.lastMouseBufferPt)return;n=this.lastMouseBufferPt;const t=this.editor.getSelections().map(t=>t.getBufferRange()).filter(t=>t.containsPoint(n));r=t.length>0?t[0]:new e.Range(n,n);break;case"keyboard":case"selection":r=this.editor.getLastSelection().getBufferRange(),n=r.start;break;default:throw new TypeError("Switch assertion failed")}return{crange:r,pos:n,eventType:t}}shouldShowTooltip(t,e){t.row<0||t.row>=this.editor.getLineCount()||t.isEqual(this.editor.getBuffer().rangeForRow(t.row,!1).end)?this.tooltips.hide(e):Kn(this.tooltipRegistry.showTooltip(this.editor,e))}handleCursorUnderTooltip(t){const e=document.querySelector("ide-haskell-tooltip");if(!e)return;const r=this.editorElement.pixelRectForScreenRange(this.editor.screenRangeForBufferRange(t)),n=this.editorElement.querySelector(".scroll-view");if(!n)return;const i=n.getBoundingClientRect(),o=e.getBoundingClientRect(),s=e.querySelector("div");if(!s)return;const a=s.getBoundingClientRect(),c={left:o.left-i.left,top:a.top-i.top,width:o.width,height:a.height},l=Math.round(Math.max(c.left,r.left)),u=Math.round(Math.min(c.left+c.width,r.left+r.width)),p=Math.round(Math.max(c.top,r.top)),h=Math.round(Math.min(c.top+c.height,r.top+r.height)),d=document.querySelector("ide-haskell-tooltip");d&&(p<=h&&l<=u?d.classList.add("ide-haskell-tooltip-subdued"):d.classList.remove("ide-haskell-tooltip-subdued"))}}class Go{constructor(t,r){this.linter=t,this.resultDb=r,this.update=()=>{this.linter.clearMessages(),this.linter.setAllMessages(Array.from(this.messages()))},this.disposables=new e.CompositeDisposable,this.disposables.add(r.onDidUpdate(this.update))}destroy(){this.disposables.dispose(),this.linter.dispose()}*messages(){for(const t of this.resultDb.results())if(void 0!==t.uri&&t.position){let r;switch(t.severity){case"error":case"warning":r=t.severity;break;default:r="info"}yield{severity:r,excerpt:t.message.toPlain(),location:{file:t.uri,position:new e.Range(t.position,t.position.translate([0,1]))}}}}}class Ho{constructor(t){this.pluginManager=t,this.providers=[]}dispose(){this.providers=[]}register(t,r){const n=this.providers.findIndex(({priority:t})=>t<r.priority),i={pluginName:t,eventTypes:r.eventTypes?r.eventTypes:["selection","selection"],priority:r.priority,handler:r.handler};return-1===n?this.providers.push(i):this.providers.splice(n,0,i),new e.Disposable(()=>{const t=this.providers.indexOf(i);this.providers.splice(t,1)})}async showTooltip(t,r,n){const i=this.pluginManager.controller(t);if(!i)return;let o,s;if(n&&"function"!=typeof n.tooltip)s=n.tooltip,o=n.pluginName;else{const e=i.getEventRange(r);if(!e)return;if(n&&"function"==typeof n.tooltip){o=n.pluginName;const t=this.pluginManager.getAwaiter(o),r=n.tooltip,i=await t(()=>r(e.crange));if(void 0===i)return;s=i}else{const n=await this.defaultTooltipFunction(t,r,e.crange);if(!n)return void i.tooltips.hide(r,void 0,{persistent:!1});({pluginName:o,tooltipData:s}=n)}const a=i.getEventRange(r);if(!a||!e.crange.isEqual(a.crange))return}const{persistent:a=!1}=s;let c;c=Array.isArray(s.text)?s.text.map(Gn.fromObject):Gn.fromObject(s.text),i.tooltips.show(e.Range.fromObject(s.range),c,r,o,{persistent:a})}hideTooltip(t,e,r){const n=this.pluginManager.controller(t);n&&n.tooltips.hide(e,r)}async defaultTooltipFunction(t,e,r){for(const{pluginName:n,handler:i,eventTypes:o}of this.providers){if(!o.includes(e))continue;const s=this.pluginManager.getAwaiter(n),a=await s(()=>i(t,r,e));if(void 0!==a)return{pluginName:n,tooltipData:a}}}}class Wo{constructor(t,r){this.editor=t,this.updateResults=()=>{const t=this.editor.getPath(),e=Array.from(this.resultsDB.filter(e=>e.uri===t&&e.isValid())),r=this.markers.getMarkers(),n=e.filter(t=>r.every(e=>this.markerProps.get(e)!==t));r.filter(t=>{const r=this.markerProps.get(t);return!r||!e.includes(r)}).forEach(t=>t.destroy());for(const t of n)this.markerFromCheckResult(t)};const n=this.editor.gutterWithName("ide-haskell-check-results");this.gutter=n||this.editor.addGutter({name:"ide-haskell-check-results",priority:10}),this.gutterElement=atom.views.getView(this.gutter),this.resultsDB=r.resultsDB,this.tooltipRegistry=r.tooltipRegistry,this.disposables=new e.CompositeDisposable,this.markers=t.addMarkerLayer({maintainHistory:!0,persistent:!1}),this.markerProps=new WeakMap,this.disposables.add(this.resultsDB.onDidUpdate(this.updateResults)),this.updateResults(),this.registerGutterEvents()}static supportsGrammar(t){return["source.c2hs","source.hsc2hs","source.haskell","text.tex.latex.haskell","source.hsig"].includes(t)}destroy(){this.markers.destroy(),this.disposables.dispose();try{this.gutter.destroy()}catch(t){console.warn(t)}}getMessageAt(t,e){const r=this.find(t,e),n=[];for(const t of r){if(!t.isValid())continue;const e=this.markerProps.get(t);e&&n.push(e.message)}return n}registerGutterEvents(){this.disposables.add(Hn(this.gutterElement,"mouseover",".decoration",t=>{const r=Qn(this.editor,t);if(r){const t=this.getMessageAt(r,"gutter");t.length>0&&Kn(this.tooltipRegistry.showTooltip(this.editor,"mouse",{pluginName:"builtin:check-results",tooltip:{text:t,range:new e.Range(r,r)}}))}})),this.disposables.add(Hn(this.gutterElement,"mouseout",".decoration",()=>this.tooltipRegistry.hideTooltip(this.editor,"mouse","builtin:check-results")))}markerFromCheckResult(t){const{position:r}=t;if(!r)return;const n=new e.Range(r,e.Point.fromObject([r.row,r.column+1])),i=this.markers.markBufferRange(n,{invalidate:"inside"});this.markerProps.set(i,t);const o=new e.CompositeDisposable;o.add(i.onDidDestroy(()=>{this.markerProps.delete(i),o.dispose()}),i.onDidChange(({isValid:e})=>{t.setValid(e)})),this.decorateMarker(i,t)}decorateMarker(t,e){const r={class:"ide-haskell-"+e.severity};this.gutter.decorateMarker(t,{type:"line-number",...r}),this.editor.decorateMarker(t,{type:"highlight",...r})}find(t,e){switch(e){case"gutter":return this.markers.findMarkers({startBufferRow:t.row});case"keyboard":return this.markers.findMarkers({startBufferPosition:t});case"mouse":return this.markers.findMarkers({containsBufferPosition:t});default:throw new TypeError("Switch assertion failed")}}}class Qo{constructor(t){this.pluginManager=t,this.tooltipProvider=(t,e,r)=>{const n=this.pluginManager.controllerType(Wo,t);if(!n)return;if("keyboard"===r&&"Show Tooltip"!==atom.config.get("ide-haskell.onCursorMove",{scope:t.getRootScopeDescriptor()}))return;const i=n.getMessageAt(e.start,r);return i.length>0?{range:e,text:i}:void 0};const r=t.tooltipRegistry;this.disposables=new e.CompositeDisposable,this.disposables.add(r.register("builtin:check-results",{priority:1e3,handler:this.tooltipProvider,eventTypes:["mouse","keyboard"]}),t.addEditorController(Wo))}destroy(){this.disposables.dispose()}}class Ko{constructor(t,e){this.panel=t,this.bsc=e,this.didClick=()=>{Kn(this.panel.toggle())},Ui(this),this.disp=e.onDidUpdate(()=>{Kn(this.update())})}render(){return Bi("div",{class:"ide-haskell inline-block",on:{click:this.didClick}},Bi("span",null,Bi("ide-haskell-lambda",null),this.bsc.renderStatusIcon()))}async update(){return zi(this)}destroy(){this.disp.dispose(),Kn(qi(this))}}var Xo="win32"===process.platform,Yo=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function Zo(t){return"function"==typeof t?t:function(){var t;if(Yo){var e=new Error;t=function(t){t&&(e.message=t.message,r(t=e))}}else t=r;return t;function r(t){if(t){if(process.throwDeprecation)throw t;if(!process.noDeprecation){var e="fs: missing callback "+(t.stack||t.message);process.traceDeprecation?console.trace(e):console.error(e)}}}}()}i.normalize;if(Xo)var Jo=/(.*?)(?:[\/\\]+|$)/g;else Jo=/(.*?)(?:[\/]+|$)/g;if(Xo)var ts=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else ts=/^[\/]*/;var es=function(t,e){if(t=i.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return e[t];var r,n,o,s,c=t,l={},u={};function p(){var e=ts.exec(t);r=e[0].length,n=e[0],o=e[0],s="",Xo&&!u[o]&&(a.lstatSync(o),u[o]=!0)}for(p();r<t.length;){Jo.lastIndex=r;var h=Jo.exec(t);if(s=n,n+=h[0],o=s+h[1],r=Jo.lastIndex,!(u[o]||e&&e[o]===o)){var d;if(e&&Object.prototype.hasOwnProperty.call(e,o))d=e[o];else{var f=a.lstatSync(o);if(!f.isSymbolicLink()){u[o]=!0,e&&(e[o]=o);continue}var m=null;if(!Xo){var g=f.dev.toString(32)+":"+f.ino.toString(32);l.hasOwnProperty(g)&&(m=l[g])}null===m&&(a.statSync(o),m=a.readlinkSync(o)),d=i.resolve(s,m),e&&(e[o]=d),Xo||(l[g]=m)}t=i.resolve(d,t.slice(r)),p()}}return e&&(e[c]=t),t},rs=function(t,e,r){if("function"!=typeof r&&(r=Zo(e),e=null),t=i.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return process.nextTick(r.bind(null,null,e[t]));var n,o,s,c,l=t,u={},p={};function h(){var e=ts.exec(t);n=e[0].length,o=e[0],s=e[0],c="",Xo&&!p[s]?a.lstat(s,(function(t){if(t)return r(t);p[s]=!0,d()})):process.nextTick(d)}function d(){if(n>=t.length)return e&&(e[l]=t),r(null,t);Jo.lastIndex=n;var i=Jo.exec(t);return c=o,o+=i[0],s=c+i[1],n=Jo.lastIndex,p[s]||e&&e[s]===s?process.nextTick(d):e&&Object.prototype.hasOwnProperty.call(e,s)?g(e[s]):a.lstat(s,f)}function f(t,n){if(t)return r(t);if(!n.isSymbolicLink())return p[s]=!0,e&&(e[s]=s),process.nextTick(d);if(!Xo){var i=n.dev.toString(32)+":"+n.ino.toString(32);if(u.hasOwnProperty(i))return m(null,u[i],s)}a.stat(s,(function(t){if(t)return r(t);a.readlink(s,(function(t,e){Xo||(u[i]=e),m(t,e)}))}))}function m(t,n,o){if(t)return r(t);var s=i.resolve(c,n);e&&(e[o]=s),g(s)}function g(e){t=i.resolve(e,t.slice(n)),h()}h()},ns=ls;ls.realpath=ls,ls.sync=us,ls.realpathSync=us,ls.monkeypatch=function(){a.realpath=ls,a.realpathSync=us},ls.unmonkeypatch=function(){a.realpath=is,a.realpathSync=os};var is=a.realpath,os=a.realpathSync,ss=process.version,as=/^v[0-5]\./.test(ss);function cs(t){return t&&"realpath"===t.syscall&&("ELOOP"===t.code||"ENOMEM"===t.code||"ENAMETOOLONG"===t.code)}function ls(t,e,r){if(as)return is(t,e,r);"function"==typeof e&&(r=e,e=null),is(t,e,(function(n,i){cs(n)?rs(t,e,r):r(n,i)}))}function us(t,e){if(as)return os(t,e);try{return os(t,e)}catch(r){if(cs(r))return es(t,e);throw r}}var ps=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},hs=ds;function ds(t,e,r){t instanceof RegExp&&(t=fs(t,r)),e instanceof RegExp&&(e=fs(e,r));var n=ms(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}function fs(t,e){var r=e.match(t);return r?r[0]:null}function ms(t,e,r){var n,i,o,s,a,c=r.indexOf(t),l=r.indexOf(e,c+1),u=c;if(c>=0&&l>0){for(n=[],o=r.length;u>=0&&!a;)u==c?(n.push(u),c=r.indexOf(t,u+1)):1==n.length?a=[n.pop(),l]:((i=n.pop())<o&&(o=i,s=l),l=r.indexOf(e,u+1)),u=c<l&&c>=0?c:l;n.length&&(a=[o,s])}return a}ds.range=ms;var gs=function(t){if(!t)return[];"{}"===t.substr(0,2)&&(t="\\{\\}"+t.substr(2));return function t(e,r){var n=[],i=hs("{","}",e);if(!i||/\$$/.test(i.pre))return[e];var o,s=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),a=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),c=s||a,l=i.body.indexOf(",")>=0;if(!c&&!l)return i.post.match(/,.*\}/)?(e=i.pre+"{"+i.body+bs+i.post,t(e)):[e];if(c)o=i.body.split(/\.\./);else{if(1===(o=function t(e){if(!e)return[""];var r=[],n=hs("{","}",e);if(!n)return e.split(",");var i=n.pre,o=n.body,s=n.post,a=i.split(",");a[a.length-1]+="{"+o+"}";var c=t(s);s.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c));return r.push.apply(r,a),r}(i.body)).length)if(1===(o=t(o[0],!1).map(Ss)).length)return(h=i.post.length?t(i.post,!1):[""]).map((function(t){return i.pre+o[0]+t}))}var u,p=i.pre,h=i.post.length?t(i.post,!1):[""];if(c){var d=_s(o[0]),f=_s(o[1]),m=Math.max(o[0].length,o[1].length),g=3==o.length?Math.abs(_s(o[2])):1,v=Os;f<d&&(g*=-1,v=Ps);var y=o.some(Es);u=[];for(var b=d;v(b,f);b+=g){var w;if(a)"\\"===(w=String.fromCharCode(b))&&(w="");else if(w=String(b),y){var k=m-w.length;if(k>0){var _=new Array(k+1).join("0");w=b<0?"-"+_+w.slice(1):_+w}}u.push(w)}}else u=function(t,e){for(var r=[],n=0;n<t.length;n++){var i=e(t[n],n);ps(i)?r.push.apply(r,i):r.push(i)}return r}(o,(function(e){return t(e,!1)}));for(var x=0;x<u.length;x++)for(var S=0;S<h.length;S++){var E=p+u[x]+h[S];(!r||c||E)&&n.push(E)}return n}(function(t){return t.split("\\\\").join(vs).split("\\{").join(ys).split("\\}").join(bs).split("\\,").join(ws).split("\\.").join(ks)}(t),!0).map(xs)},vs="\0SLASH"+Math.random()+"\0",ys="\0OPEN"+Math.random()+"\0",bs="\0CLOSE"+Math.random()+"\0",ws="\0COMMA"+Math.random()+"\0",ks="\0PERIOD"+Math.random()+"\0";function _s(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function xs(t){return t.split(vs).join("\\").split(ys).join("{").split(bs).join("}").split(ws).join(",").split(ks).join(".")}function Ss(t){return"{"+t+"}"}function Es(t){return/^-?0\d/.test(t)}function Os(t,e){return t<=e}function Ps(t,e){return t>=e}var Ms=Ns;Ns.Minimatch=Rs;var As={sep:"/"};try{As=i}catch(t){}var js=Ns.GLOBSTAR=Rs.GLOBSTAR={},Ts={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Cs="().*{}+?[]^$\\!".split("").reduce((function(t,e){return t[e]=!0,t}),{});var Ds=/\/+/;function Is(t,e){t=t||{},e=e||{};var r={};return Object.keys(e).forEach((function(t){r[t]=e[t]})),Object.keys(t).forEach((function(e){r[e]=t[e]})),r}function Ns(t,e,r){if("string"!=typeof e)throw new TypeError("glob pattern string required");return r||(r={}),!(!r.nocomment&&"#"===e.charAt(0))&&(""===e.trim()?""===t:new Rs(e,r).match(t))}function Rs(t,e){if(!(this instanceof Rs))return new Rs(t,e);if("string"!=typeof t)throw new TypeError("glob pattern string required");e||(e={}),t=t.trim(),"/"!==As.sep&&(t=t.split(As.sep).join("/")),this.options=e,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function Ls(t,e){if(e||(e=this instanceof Rs?this.options:{}),void 0===(t=void 0===t?this.pattern:t))throw new TypeError("undefined pattern");return e.nobrace||!t.match(/\{.*\}/)?[t]:gs(t)}Ns.filter=function(t,e){return e=e||{},function(r,n,i){return Ns(r,t,e)}},Ns.defaults=function(t){if(!t||!Object.keys(t).length)return Ns;var e=Ns,r=function(r,n,i){return e.minimatch(r,n,Is(t,i))};return r.Minimatch=function(r,n){return new e.Minimatch(r,Is(t,n))},r},Rs.defaults=function(t){return t&&Object.keys(t).length?Ns.defaults(t).Minimatch:Rs},Rs.prototype.debug=function(){},Rs.prototype.make=function(){if(this._made)return;var t=this.pattern,e=this.options;if(!e.nocomment&&"#"===t.charAt(0))return void(this.comment=!0);if(!t)return void(this.empty=!0);this.parseNegate();var r=this.globSet=this.braceExpand();e.debug&&(this.debug=console.error);this.debug(this.pattern,r),r=this.globParts=r.map((function(t){return t.split(Ds)})),this.debug(this.pattern,r),r=r.map((function(t,e,r){return t.map(this.parse,this)}),this),this.debug(this.pattern,r),r=r.filter((function(t){return-1===t.indexOf(!1)})),this.debug(this.pattern,r),this.set=r},Rs.prototype.parseNegate=function(){var t=this.pattern,e=!1,r=this.options,n=0;if(r.nonegate)return;for(var i=0,o=t.length;i<o&&"!"===t.charAt(i);i++)e=!e,n++;n&&(this.pattern=t.substr(n));this.negate=e},Ns.braceExpand=function(t,e){return Ls(t,e)},Rs.prototype.braceExpand=Ls,Rs.prototype.parse=function(t,e){if(t.length>65536)throw new TypeError("pattern is too long");var r=this.options;if(!r.noglobstar&&"**"===t)return js;if(""===t)return"";var n,i="",o=!!r.nocase,s=!1,a=[],c=[],l=!1,u=-1,p=-1,h="."===t.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",d=this;function f(){if(n){switch(n){case"*":i+="[^/]*?",o=!0;break;case"?":i+="[^/]",o=!0;break;default:i+="\\"+n}d.debug("clearStateChar %j %j",n,i),n=!1}}for(var m,g=0,v=t.length;g<v&&(m=t.charAt(g));g++)if(this.debug("%s\t%s %s %j",t,g,i,m),s&&Cs[m])i+="\\"+m,s=!1;else switch(m){case"/":return!1;case"\\":f(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",t,g,i,m),l){this.debug("  in class"),"!"===m&&g===p+1&&(m="^"),i+=m;continue}d.debug("call clearStateChar %j",n),f(),n=m,r.noext&&f();continue;case"(":if(l){i+="(";continue}if(!n){i+="\\(";continue}a.push({type:n,start:g-1,reStart:i.length,open:Ts[n].open,close:Ts[n].close}),i+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,i),n=!1;continue;case")":if(l||!a.length){i+="\\)";continue}f(),o=!0;var y=a.pop();i+=y.close,"!"===y.type&&c.push(y),y.reEnd=i.length;continue;case"|":if(l||!a.length||s){i+="\\|",s=!1;continue}f(),i+="|";continue;case"[":if(f(),l){i+="\\"+m;continue}l=!0,p=g,u=i.length,i+=m;continue;case"]":if(g===p+1||!l){i+="\\"+m,s=!1;continue}if(l){var b=t.substring(p+1,g);try{RegExp("["+b+"]")}catch(t){var w=this.parse(b,Fs);i=i.substr(0,u)+"\\["+w[0]+"\\]",o=o||w[1],l=!1;continue}}o=!0,l=!1,i+=m;continue;default:f(),s?s=!1:!Cs[m]||"^"===m&&l||(i+="\\"),i+=m}l&&(b=t.substr(p+1),w=this.parse(b,Fs),i=i.substr(0,u)+"\\["+w[0],o=o||w[1]);for(y=a.pop();y;y=a.pop()){var k=i.slice(y.reStart+y.open.length);this.debug("setting tail",i,y),k=k.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(t,e,r){return r||(r="\\"),e+e+r+"|"})),this.debug("tail=%j\n   %s",k,k,y,i);var _="*"===y.type?"[^/]*?":"?"===y.type?"[^/]":"\\"+y.type;o=!0,i=i.slice(0,y.reStart)+_+"\\("+k}f(),s&&(i+="\\\\");var x=!1;switch(i.charAt(0)){case".":case"[":case"(":x=!0}for(var S=c.length-1;S>-1;S--){var E=c[S],O=i.slice(0,E.reStart),P=i.slice(E.reStart,E.reEnd-8),M=i.slice(E.reEnd-8,E.reEnd),A=i.slice(E.reEnd);M+=A;var j=O.split("(").length-1,T=A;for(g=0;g<j;g++)T=T.replace(/\)[+*?]?/,"");var C="";""===(A=T)&&e!==Fs&&(C="$"),i=O+P+A+C+M}""!==i&&o&&(i="(?=.)"+i);x&&(i=h+i);if(e===Fs)return[i,o];if(!o)return function(t){return t.replace(/\\(.)/g,"$1")}(t);var D=r.nocase?"i":"";try{var I=new RegExp("^"+i+"$",D)}catch(t){return new RegExp("$.")}return I._glob=t,I._src=i,I};var Fs={};Ns.makeRe=function(t,e){return new Rs(t,e||{}).makeRe()},Rs.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var e=this.options,r=e.noglobstar?"[^/]*?":e.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",n=e.nocase?"i":"",i=t.map((function(t){return t.map((function(t){return t===js?r:"string"==typeof t?function(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(t):t._src})).join("\\/")})).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,n)}catch(t){this.regexp=!1}return this.regexp},Ns.match=function(t,e,r){var n=new Rs(e,r=r||{});return t=t.filter((function(t){return n.match(t)})),n.options.nonull&&!t.length&&t.push(e),t},Rs.prototype.match=function(t,e){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return""===t;if("/"===t&&e)return!0;var r=this.options;"/"!==As.sep&&(t=t.split(As.sep).join("/"));t=t.split(Ds),this.debug(this.pattern,"split",t);var n,i,o=this.set;for(this.debug(this.pattern,"set",o),i=t.length-1;i>=0&&!(n=t[i]);i--);for(i=0;i<o.length;i++){var s=o[i],a=t;if(r.matchBase&&1===s.length&&(a=[n]),this.matchOne(a,s,e))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate},Rs.prototype.matchOne=function(t,e,r){var n=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var i=0,o=0,s=t.length,a=e.length;i<s&&o<a;i++,o++){this.debug("matchOne loop");var c,l=e[o],u=t[i];if(this.debug(e,l,u),!1===l)return!1;if(l===js){this.debug("GLOBSTAR",[e,l,u]);var p=i,h=o+1;if(h===a){for(this.debug("** at the end");i<s;i++)if("."===t[i]||".."===t[i]||!n.dot&&"."===t[i].charAt(0))return!1;return!0}for(;p<s;){var d=t[p];if(this.debug("\nglobstar while",t,p,e,h,d),this.matchOne(t.slice(p),e.slice(h),r))return this.debug("globstar found match!",p,s,d),!0;if("."===d||".."===d||!n.dot&&"."===d.charAt(0)){this.debug("dot detected!",t,p,e,h);break}this.debug("globstar swallow a segment, and continue"),p++}return!(!r||(this.debug("\n>>> no match, partial?",t,p,e,h),p!==s))}if("string"==typeof l?(c=n.nocase?u.toLowerCase()===l.toLowerCase():u===l,this.debug("string match",l,u,c)):(c=u.match(l),this.debug("pattern match",l,u,c)),!c)return!1}if(i===s&&o===a)return!0;if(i===s)return r;if(o===a)return i===s-1&&""===t[i];throw new Error("wtf?")};var Bs=S((function(t){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}})),Us=S((function(t){try{var e=u;if("function"!=typeof e.inherits)throw"";t.exports=e.inherits}catch(e){t.exports=Bs}}));function zs(t){return"/"===t.charAt(0)}function qs(t){var e=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(t),r=e[1]||"",n=Boolean(r&&":"!==r.charAt(1));return Boolean(e[2]||n)}var $s="win32"===process.platform?qs:zs,Vs=zs,Gs=qs;$s.posix=Vs,$s.win32=Gs;var Hs=ia,Ws=na,Qs=function(t,e,r){r||(r={});if(r.matchBase&&-1===e.indexOf("/")){if(r.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.silent=!!r.silent,t.pattern=e,t.strict=!1!==r.strict,t.realpath=!!r.realpath,t.realpathCache=r.realpathCache||Object.create(null),t.follow=!!r.follow,t.dot=!!r.dot,t.mark=!!r.mark,t.nodir=!!r.nodir,t.nodir&&(t.mark=!0);t.sync=!!r.sync,t.nounique=!!r.nounique,t.nonull=!!r.nonull,t.nosort=!!r.nosort,t.nocase=!!r.nocase,t.stat=!!r.stat,t.noprocess=!!r.noprocess,t.absolute=!!r.absolute,t.maxLength=r.maxLength||1/0,t.cache=r.cache||Object.create(null),t.statCache=r.statCache||Object.create(null),t.symlinks=r.symlinks||Object.create(null),function(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]);t.ignore.length&&(t.ignore=t.ignore.map(oa))}(t,r),t.changedCwd=!1;var n=process.cwd();ea(r,"cwd")?(t.cwd=i.resolve(r.cwd),t.changedCwd=t.cwd!==n):t.cwd=n;t.root=r.root||i.resolve(t.cwd,"/"),t.root=i.resolve(t.root),"win32"===process.platform&&(t.root=t.root.replace(/\\/g,"/"));t.cwdAbs=$s(t.cwd)?t.cwd:sa(t,t.cwd),"win32"===process.platform&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/"));t.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,t.minimatch=new ra(e,r),t.options=t.minimatch.options},Ks=ea,Xs=sa,Ys=function(t){for(var e=t.nounique,r=e?[]:Object.create(null),n=0,i=t.matches.length;n<i;n++){var o=t.matches[n];if(o&&0!==Object.keys(o).length){var s=Object.keys(o);e?r.push.apply(r,s):s.forEach((function(t){r[t]=!0}))}else if(t.nonull){var a=t.minimatch.globSet[n];e?r.push(a):r[a]=!0}}e||(r=Object.keys(r));t.nosort||(r=r.sort(t.nocase?na:ia));if(t.mark){for(n=0;n<r.length;n++)r[n]=t._mark(r[n]);t.nodir&&(r=r.filter((function(e){var r=!/\/$/.test(e),n=t.cache[e]||t.cache[sa(t,e)];return r&&n&&(r="DIR"!==n&&!Array.isArray(n)),r})))}t.ignore.length&&(r=r.filter((function(e){return!aa(t,e)})));t.found=r},Zs=function(t,e){var r=sa(t,e),n=t.cache[r],i=e;if(n){var o="DIR"===n||Array.isArray(n),s="/"===e.slice(-1);if(o&&!s?i+="/":!o&&s&&(i=i.slice(0,-1)),i!==e){var a=sa(t,i);t.statCache[a]=t.statCache[r],t.cache[a]=t.cache[r]}}return i},Js=aa,ta=function(t,e){return!!t.ignore.length&&t.ignore.some((function(t){return!(!t.gmatcher||!t.gmatcher.match(e))}))};function ea(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var ra=Ms.Minimatch;function na(t,e){return t.toLowerCase().localeCompare(e.toLowerCase())}function ia(t,e){return t.localeCompare(e)}function oa(t){var e=null;if("/**"===t.slice(-3)){var r=t.replace(/(\/\*\*)+$/,"");e=new ra(r,{dot:!0})}return{matcher:new ra(t,{dot:!0}),gmatcher:e}}function sa(t,e){var r=e;return r="/"===e.charAt(0)?i.join(t.root,e):$s(e)||""===e?e:t.changedCwd?i.resolve(t.cwd,e):i.resolve(e),"win32"===process.platform&&(r=r.replace(/\\/g,"/")),r}function aa(t,e){return!!t.ignore.length&&t.ignore.some((function(t){return t.matcher.match(e)||!(!t.gmatcher||!t.gmatcher.match(e))}))}var ca={alphasort:Hs,alphasorti:Ws,setopts:Qs,ownProp:Ks,makeAbs:Xs,finish:Ys,mark:Zs,isIgnored:Js,childrenIgnored:ta},la=fa;fa.GlobSync=ma;var ua=ca.setopts,pa=ca.ownProp,ha=ca.childrenIgnored,da=ca.isIgnored;function fa(t,e){if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new ma(t,e).found}function ma(t,e){if(!t)throw new Error("must provide pattern");if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof ma))return new ma(t,e);if(ua(this,t,e),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}ma.prototype._finish=function(){if(l(this instanceof ma),this.realpath){var t=this;this.matches.forEach((function(e,r){var n=t.matches[r]=Object.create(null);for(var i in e)try{i=t._makeAbs(i),n[ns.realpathSync(i,t.realpathCache)]=!0}catch(e){if("stat"!==e.syscall)throw e;n[t._makeAbs(i)]=!0}}))}ca.finish(this)},ma.prototype._process=function(t,e,r){l(this instanceof ma);for(var n,i=0;"string"==typeof t[i];)i++;switch(i){case t.length:return void this._processSimple(t.join("/"),e);case 0:n=null;break;default:n=t.slice(0,i).join("/")}var o,s=t.slice(i);null===n?o=".":$s(n)||$s(t.join("/"))?(n&&$s(n)||(n="/"+n),o=n):o=n;var a=this._makeAbs(o);ha(this,o)||(s[0]===Ms.GLOBSTAR?this._processGlobStar(n,o,a,s,e,r):this._processReaddir(n,o,a,s,e,r))},ma.prototype._processReaddir=function(t,e,r,n,o,s){var a=this._readdir(r,s);if(a){for(var c=n[0],l=!!this.minimatch.negate,u=c._glob,p=this.dot||"."===u.charAt(0),h=[],d=0;d<a.length;d++){if("."!==(g=a[d]).charAt(0)||p)(l&&!t?!g.match(c):g.match(c))&&h.push(g)}var f=h.length;if(0!==f)if(1!==n.length||this.mark||this.stat){n.shift();for(d=0;d<f;d++){var m;g=h[d];m=t?[t,g]:[g],this._process(m.concat(n),o,s)}}else{this.matches[o]||(this.matches[o]=Object.create(null));for(var d=0;d<f;d++){var g=h[d];t&&(g="/"!==t.slice(-1)?t+"/"+g:t+g),"/"!==g.charAt(0)||this.nomount||(g=i.join(this.root,g)),this._emitMatch(o,g)}}}},ma.prototype._emitMatch=function(t,e){if(!da(this,e)){var r=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}},ma.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,r;try{r=a.lstatSync(t)}catch(t){if("ENOENT"===t.code)return null}var n=r&&r.isSymbolicLink();return this.symlinks[t]=n,n||!r||r.isDirectory()?e=this._readdir(t,!1):this.cache[t]="FILE",e},ma.prototype._readdir=function(t,e){if(e&&!pa(this.symlinks,t))return this._readdirInGlobStar(t);if(pa(this.cache,t)){var r=this.cache[t];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(t,a.readdirSync(t))}catch(e){return this._readdirError(t,e),null}},ma.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var n=e[r];n="/"===t?t+n:t+"/"+n,this.cache[n]=!0}return this.cache[t]=e,e},ma.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(e.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=e.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e)}},ma.prototype._processGlobStar=function(t,e,r,n,i,o){var s=this._readdir(r,o);if(s){var a=n.slice(1),c=t?[t]:[],l=c.concat(a);this._process(l,i,!1);var u=s.length;if(!this.symlinks[r]||!o)for(var p=0;p<u;p++){if("."!==s[p].charAt(0)||this.dot){var h=c.concat(s[p],a);this._process(h,i,!0);var d=c.concat(s[p],n);this._process(d,i,!0)}}}},ma.prototype._processSimple=function(t,e){var r=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),r){if(t&&$s(t)&&!this.nomount){var n=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=i.join(this.root,t):(t=i.resolve(this.root,t),n&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}},ma.prototype._stat=function(t){var e=this._makeAbs(t),r="/"===t.slice(-1);if(t.length>this.maxLength)return!1;if(!this.stat&&pa(this.cache,e)){var n=this.cache[e];if(Array.isArray(n)&&(n="DIR"),!r||"DIR"===n)return n;if(r&&"FILE"===n)return!1}var i=this.statCache[e];if(!i){var o;try{o=a.lstatSync(e)}catch(t){if(t&&("ENOENT"===t.code||"ENOTDIR"===t.code))return this.statCache[e]=!1,!1}if(o&&o.isSymbolicLink())try{i=a.statSync(e)}catch(t){i=o}else i=o}this.statCache[e]=i;n=!0;return i&&(n=i.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||n,(!r||"FILE"!==n)&&n},ma.prototype._mark=function(t){return ca.mark(this,t)},ma.prototype._makeAbs=function(t){return ca.makeAbs(this,t)};var ga=function t(e,r){if(e&&r)return t(e)(r);if("function"!=typeof e)throw new TypeError("need wrapper function");return Object.keys(e).forEach((function(t){n[t]=e[t]})),n;function n(){for(var t=new Array(arguments.length),r=0;r<t.length;r++)t[r]=arguments[r];var n=e.apply(this,t),i=t[t.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach((function(t){n[t]=i[t]})),n}};var va=ga(ba),ya=ga(wa);function ba(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function wa(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}ba.proto=ba((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return ba(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return wa(this)},configurable:!0})})),va.strict=ya;var ka=Object.create(null),_a=ga((function(t,e){return ka[t]?(ka[t].push(e),null):(ka[t]=[e],function(t){return va((function e(){var r=ka[t],n=r.length,i=xa(arguments);try{for(var o=0;o<n;o++)r[o].apply(null,i)}finally{r.length>n?(r.splice(0,n),process.nextTick((function(){e.apply(null,i)}))):delete ka[t]}}))}(t))}));function xa(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n]=t[n];return r}var Sa=ja,Ea=p.EventEmitter,Oa=ca.setopts,Pa=ca.ownProp,Ma=ca.childrenIgnored,Aa=ca.isIgnored;function ja(t,e,r){if("function"==typeof e&&(r=e,e={}),e||(e={}),e.sync){if(r)throw new TypeError("callback provided to sync glob");return la(t,e)}return new Ca(t,e,r)}ja.sync=la;var Ta=ja.GlobSync=la.GlobSync;function Ca(t,e,r){if("function"==typeof e&&(r=e,e=null),e&&e.sync){if(r)throw new TypeError("callback provided to sync glob");return new Ta(t,e)}if(!(this instanceof Ca))return new Ca(t,e,r);Oa(this,t,e),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),"function"==typeof r&&(r=va(r),this.on("error",r),this.on("end",(function(t){r(null,t)})));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===n)return s();for(var o=0;o<n;o++)this._process(this.minimatch.set[o],o,!1,s);function s(){--i._processing,i._processing<=0&&i._finish()}}ja.glob=ja,ja.hasMagic=function(t,e){var r=function(t,e){if(null===e||"object"!=typeof e)return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}({},e);r.noprocess=!0;var n=new Ca(t,r).minimatch.set;if(!t)return!1;if(n.length>1)return!0;for(var i=0;i<n[0].length;i++)if("string"!=typeof n[0][i])return!0;return!1},ja.Glob=Ca,Us(Ca,Ea),Ca.prototype._finish=function(){if(l(this instanceof Ca),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();ca.finish(this),this.emit("end",this.found)}},Ca.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var t=this.matches.length;if(0===t)return this._finish();for(var e=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n)}function n(){0==--t&&e._finish()}},Ca.prototype._realpathSet=function(t,e){var r=this.matches[t];if(!r)return e();var n=Object.keys(r),i=this,o=n.length;if(0===o)return e();var s=this.matches[t]=Object.create(null);n.forEach((function(r,n){r=i._makeAbs(r),ns.realpath(r,i.realpathCache,(function(n,a){n?"stat"===n.syscall?s[r]=!0:i.emit("error",n):s[a]=!0,0==--o&&(i.matches[t]=s,e())}))}))},Ca.prototype._mark=function(t){return ca.mark(this,t)},Ca.prototype._makeAbs=function(t){return ca.makeAbs(this,t)},Ca.prototype.abort=function(){this.aborted=!0,this.emit("abort")},Ca.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},Ca.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var r=t[e];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(e=0;e<n.length;e++){var i=n[e];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},Ca.prototype._process=function(t,e,r,n){if(l(this instanceof Ca),l("function"==typeof n),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([t,e,r,n]);else{for(var i,o=0;"string"==typeof t[o];)o++;switch(o){case t.length:return void this._processSimple(t.join("/"),e,n);case 0:i=null;break;default:i=t.slice(0,o).join("/")}var s,a=t.slice(o);null===i?s=".":$s(i)||$s(t.join("/"))?(i&&$s(i)||(i="/"+i),s=i):s=i;var c=this._makeAbs(s);if(Ma(this,s))return n();a[0]===Ms.GLOBSTAR?this._processGlobStar(i,s,c,a,e,r,n):this._processReaddir(i,s,c,a,e,r,n)}},Ca.prototype._processReaddir=function(t,e,r,n,i,o,s){var a=this;this._readdir(r,o,(function(c,l){return a._processReaddir2(t,e,r,n,i,o,l,s)}))},Ca.prototype._processReaddir2=function(t,e,r,n,o,s,a,c){if(!a)return c();for(var l=n[0],u=!!this.minimatch.negate,p=l._glob,h=this.dot||"."===p.charAt(0),d=[],f=0;f<a.length;f++){if("."!==(g=a[f]).charAt(0)||h)(u&&!t?!g.match(l):g.match(l))&&d.push(g)}var m=d.length;if(0===m)return c();if(1===n.length&&!this.mark&&!this.stat){this.matches[o]||(this.matches[o]=Object.create(null));for(f=0;f<m;f++){var g=d[f];t&&(g="/"!==t?t+"/"+g:t+g),"/"!==g.charAt(0)||this.nomount||(g=i.join(this.root,g)),this._emitMatch(o,g)}return c()}n.shift();for(f=0;f<m;f++){g=d[f];t&&(g="/"!==t?t+"/"+g:t+g),this._process([g].concat(n),o,s,c)}c()},Ca.prototype._emitMatch=function(t,e){if(!this.aborted&&!Aa(this,e))if(this.paused)this._emitQueue.push([t,e]);else{var r=$s(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[t][e]=!0;var i=this.statCache[r];i&&this.emit("stat",e,i),this.emit("match",e)}}},Ca.prototype._readdirInGlobStar=function(t,e){if(!this.aborted){if(this.follow)return this._readdir(t,!1,e);var r=this,n=_a("lstat\0"+t,(function(n,i){if(n&&"ENOENT"===n.code)return e();var o=i&&i.isSymbolicLink();r.symlinks[t]=o,o||!i||i.isDirectory()?r._readdir(t,!1,e):(r.cache[t]="FILE",e())}));n&&a.lstat(t,n)}},Ca.prototype._readdir=function(t,e,r){if(!this.aborted&&(r=_a("readdir\0"+t+"\0"+e,r))){if(e&&!Pa(this.symlinks,t))return this._readdirInGlobStar(t,r);if(Pa(this.cache,t)){var n=this.cache[t];if(!n||"FILE"===n)return r();if(Array.isArray(n))return r(null,n)}a.readdir(t,function(t,e,r){return function(n,i){n?t._readdirError(e,n,r):t._readdirEntries(e,i,r)}}(this,t,r))}},Ca.prototype._readdirEntries=function(t,e,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<e.length;n++){var i=e[n];i="/"===t?t+i:t+"/"+i,this.cache[i]=!0}return this.cache[t]=e,r(null,e)}},Ca.prototype._readdirError=function(t,e,r){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(t);if(this.cache[n]="FILE",n===this.cwdAbs){var i=new Error(e.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=e.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e)}return r()}},Ca.prototype._processGlobStar=function(t,e,r,n,i,o,s){var a=this;this._readdir(r,o,(function(c,l){a._processGlobStar2(t,e,r,n,i,o,l,s)}))},Ca.prototype._processGlobStar2=function(t,e,r,n,i,o,s,a){if(!s)return a();var c=n.slice(1),l=t?[t]:[],u=l.concat(c);this._process(u,i,!1,a);var p=this.symlinks[r],h=s.length;if(p&&o)return a();for(var d=0;d<h;d++){if("."!==s[d].charAt(0)||this.dot){var f=l.concat(s[d],c);this._process(f,i,!0,a);var m=l.concat(s[d],n);this._process(m,i,!0,a)}}a()},Ca.prototype._processSimple=function(t,e,r){var n=this;this._stat(t,(function(i,o){n._processSimple2(t,e,i,o,r)}))},Ca.prototype._processSimple2=function(t,e,r,n,o){if(this.matches[e]||(this.matches[e]=Object.create(null)),!n)return o();if(t&&$s(t)&&!this.nomount){var s=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=i.join(this.root,t):(t=i.resolve(this.root,t),s&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),o()},Ca.prototype._stat=function(t,e){var r=this._makeAbs(t),n="/"===t.slice(-1);if(t.length>this.maxLength)return e();if(!this.stat&&Pa(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!n||"DIR"===i)return e(null,i);if(n&&"FILE"===i)return e()}var o=this.statCache[r];if(void 0!==o){if(!1===o)return e(null,o);var s=o.isDirectory()?"DIR":"FILE";return n&&"FILE"===s?e():e(null,s,o)}var c=this,l=_a("stat\0"+r,(function(n,i){if(i&&i.isSymbolicLink())return a.stat(r,(function(n,o){n?c._stat2(t,r,null,i,e):c._stat2(t,r,n,o,e)}));c._stat2(t,r,n,i,e)}));l&&a.lstat(r,l)},Ca.prototype._stat2=function(t,e,r,n,i){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[e]=!1,i();var o="/"===t.slice(-1);if(this.statCache[e]=n,"/"===e.slice(-1)&&n&&!n.isDirectory())return i(null,!1,n);var s=!0;return n&&(s=n.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||s,o&&"FILE"===s?i():i(null,s,n)};var Da=Ba;Ba.sync=Va;var Ia=parseInt("666",8),Na={nosort:!0,silent:!0},Ra=0,La="win32"===process.platform;function Fa(t){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach((function(e){t[e]=t[e]||a[e],t[e+="Sync"]=t[e]||a[e]})),t.maxBusyTries=t.maxBusyTries||3,t.emfileWait=t.emfileWait||1e3,!1===t.glob&&(t.disableGlob=!0),t.disableGlob=t.disableGlob||!1,t.glob=t.glob||Na}function Ba(t,e,r){"function"==typeof e&&(r=e,e={}),l(t,"rimraf: missing path"),l.equal(typeof t,"string","rimraf: path should be a string"),l.equal(typeof r,"function","rimraf: callback function required"),l(e,"rimraf: invalid options argument provided"),l.equal(typeof e,"object","rimraf: options should be object"),Fa(e);var n=0,i=null,o=0;if(e.disableGlob||!Sa.hasMagic(t))return s(null,[t]);function s(t,s){return t?r(t):0===(o=s.length)?r():void s.forEach((function(t){Ua(t,e,(function s(a){if(a){if(("EBUSY"===a.code||"ENOTEMPTY"===a.code||"EPERM"===a.code)&&n<e.maxBusyTries)return n++,setTimeout((function(){Ua(t,e,s)}),100*n);if("EMFILE"===a.code&&Ra<e.emfileWait)return setTimeout((function(){Ua(t,e,s)}),Ra++);"ENOENT"===a.code&&(a=null)}Ra=0,function(t){i=i||t,0==--o&&r(i)}(a)}))}))}e.lstat(t,(function(r,n){if(!r)return s(null,[t]);Sa(t,e.glob,s)}))}function Ua(t,e,r){l(t),l(e),l("function"==typeof r),e.lstat(t,(function(n,i){return n&&"ENOENT"===n.code?r(null):(n&&"EPERM"===n.code&&La&&za(t,e,n,r),i&&i.isDirectory()?$a(t,e,n,r):void e.unlink(t,(function(n){if(n){if("ENOENT"===n.code)return r(null);if("EPERM"===n.code)return La?za(t,e,n,r):$a(t,e,n,r);if("EISDIR"===n.code)return $a(t,e,n,r)}return r(n)})))}))}function za(t,e,r,n){l(t),l(e),l("function"==typeof n),r&&l(r instanceof Error),e.chmod(t,Ia,(function(i){i?n("ENOENT"===i.code?null:r):e.stat(t,(function(i,o){i?n("ENOENT"===i.code?null:r):o.isDirectory()?$a(t,e,r,n):e.unlink(t,n)}))}))}function qa(t,e,r){l(t),l(e),r&&l(r instanceof Error);try{e.chmodSync(t,Ia)}catch(t){if("ENOENT"===t.code)return;throw r}try{var n=e.statSync(t)}catch(t){if("ENOENT"===t.code)return;throw r}n.isDirectory()?Ga(t,e,r):e.unlinkSync(t)}function $a(t,e,r,n){l(t),l(e),r&&l(r instanceof Error),l("function"==typeof n),e.rmdir(t,(function(o){!o||"ENOTEMPTY"!==o.code&&"EEXIST"!==o.code&&"EPERM"!==o.code?o&&"ENOTDIR"===o.code?n(r):n(o):function(t,e,r){l(t),l(e),l("function"==typeof r),e.readdir(t,(function(n,o){if(n)return r(n);var s,a=o.length;if(0===a)return e.rmdir(t,r);o.forEach((function(n){Ba(i.join(t,n),e,(function(n){if(!s)return n?r(s=n):void(0==--a&&e.rmdir(t,r))}))}))}))}(t,e,n)}))}function Va(t,e){var r;if(Fa(e=e||{}),l(t,"rimraf: missing path"),l.equal(typeof t,"string","rimraf: path should be a string"),l(e,"rimraf: missing options"),l.equal(typeof e,"object","rimraf: options should be object"),e.disableGlob||!Sa.hasMagic(t))r=[t];else try{e.lstatSync(t),r=[t]}catch(n){r=Sa.sync(t,e.glob)}if(r.length)for(var n=0;n<r.length;n++){t=r[n];try{var i=e.lstatSync(t)}catch(r){if("ENOENT"===r.code)return;"EPERM"===r.code&&La&&qa(t,e,r)}try{i&&i.isDirectory()?Ga(t,e,null):e.unlinkSync(t)}catch(r){if("ENOENT"===r.code)return;if("EPERM"===r.code)return La?qa(t,e,r):Ga(t,e,r);if("EISDIR"!==r.code)throw r;Ga(t,e,r)}}}function Ga(t,e,r){l(t),l(e),r&&l(r instanceof Error);try{e.rmdirSync(t)}catch(n){if("ENOENT"===n.code)return;if("ENOTDIR"===n.code)throw r;"ENOTEMPTY"!==n.code&&"EEXIST"!==n.code&&"EPERM"!==n.code||function(t,e){l(t),l(e),e.readdirSync(t).forEach((function(r){Va(i.join(t,r),e)}));var r=La?100:1,n=0;for(;;){var o=!0;try{var s=e.rmdirSync(t,e);return o=!1,s}finally{if(++n<r&&o)continue}}}(t,e)}}var Ha=S((function(t,e){var r=Da.sync,n=i.resolve(h.tmpdir()),o=c.O_CREAT|c.O_TRUNC|c.O_RDWR|c.O_EXCL,s=function(t){return"function"==typeof t?[void 0,t]:[new Promise((function(t,r){e=function(){var e=Array.from(arguments),n=e.shift();process.nextTick((function(){n?r(n):1===e.length?t(e[0]):t(e)}))}})),e];var e},l=function(t,e){var r=u(t,e),o=new Date,s=[r.prefix,o.getFullYear(),o.getMonth(),o.getDate(),"-",process.pid,"-",(4294967296*Math.random()+1).toString(36),r.suffix].join("");return i.join(r.dir||n,s)},u=function(t,e){var r={prefix:null,suffix:null};if(t)switch(typeof t){case"string":r.prefix=t;break;case"object":r=t;break;default:throw new Error("Unknown affix declaration: "+r)}else r.prefix=e;return r},p=!1,d=!1,f=[],m=[];function g(t){if(!p)return!1;y(),f.push(t)}function v(t){if(!p)return!1;y(),m.push(t)}function y(){if(!p)return!1;d||(process.addListener("exit",b),d=!0)}function b(){return!!p&&{files:function(){if(!p)return!1;for(var t,e=0;void 0!==(t=f.shift());)r(t),e++;return e}(),dirs:function(){if(!p)return!1;for(var t,e=0;void 0!==(t=m.shift());)r(t),e++;return e}()}}e.dir=n,e.track=function(e){return p=!1!==e,t.exports},e.mkdir=function(t,e){var r=s(e),n=r[0];e=r[1];var i=l(t,"d-");return a.mkdir(i,parseInt("0700",8),(function(t){t||v(i),e(t,i)})),n},e.mkdirSync=function(t){var e=l(t,"d-");return a.mkdirSync(e,parseInt("0700",8)),v(e),e},e.open=function(t,e){var r=s(e),n=r[0];e=r[1];var i=l(t,"f-");return a.open(i,o,parseInt("0600",8),(function(t,r){t||g(i),e(t,{path:i,fd:r})})),n},e.openSync=function(t){var e=l(t,"f-"),r=a.openSync(e,o,parseInt("0600",8));return g(e),{path:e,fd:r}},e.path=l,e.cleanup=function(t){var e=s(t),r=e[0];return t=e[1],p?(function(t){var e=s(t),r=e[0];if(t=e[1],!p)return t(new Error("not tracking")),r;var n,i=0,o=f.length;if(!o)return t(null,i),r;for(var a=function(e){if(o){if(e)return t(e),void(o=0);i++,--o||t(null,i)}};void 0!==(n=f.shift());)Da(n,a)}((function(e,r){e?t(e,{files:r}):function(t){var e=s(t),r=e[0];if(t=e[1],!p)return t(new Error("not tracking")),r;var n,i=0,o=m.length;if(!o)return t(null,i),r;for(var a=function(e){if(o){if(e)return t(e,i),void(o=0);i++,--o||t(null,i)}};void 0!==(n=m.shift());)Da(n,a)}((function(e,n){t(e,{files:r,dirs:n})}))})),r):(t(new Error("not tracking")),r)},e.cleanupSync=b,e.createWriteStream=function(t){var e=l(t,"s-"),r=a.createWriteStream(e,{flags:o,mode:parseInt("0600",8)});return g(e),r}})),Wa=(Ha.dir,Ha.track,Ha.mkdir,Ha.mkdirSync,Ha.open);Ha.openSync,Ha.path,Ha.cleanup,Ha.cleanupSync,Ha.createWriteStream;async function Qa({command:t,args:e,cwd:r,stdin:n}){return new Promise((i,o)=>{try{const s=d.execFile(t,e,{cwd:r},(t,e,r)=>{t?o({error:t,stderr:r}):i({stdout:e,stderr:r})});void 0!==n&&(s.stdin.write(n),s.stdin.end())}catch(t){console.error(t),o(t)}})}async function Ka(t){return new Promise((e,r)=>{s.readFile(t,{encoding:"utf-8"},(t,n)=>{t?(console.error(t),r(t)):e(n)})})}async function Xa(t,e,r){const{path:n,fd:i}=await async function(t){return new Promise((e,r)=>{Wa({prefix:"ide-haskell",suffix:".cabal"},(n,i)=>{if(n)return console.error(n),r(n);s.writeSync(i.fd,t),e(i)})})}(t);try{const t=atom.config.get("ide-haskell.cabalPath",{scope:r}),{stderr:o}=await Qa({command:t,args:["format",n],cwd:e});return{stdout:await Ka(n),stderr:o}}finally{s.close(i,Ya),s.unlink(n,Ya)}}function Ya(t){t&&atom.notifications.addError(t.name,{detail:t.message,dismissable:!0})}async function Za(t,e,r){return Qa({command:atom.config.get("ide-haskell.stylishHaskellPath",{scope:r}),args:atom.config.get("ide-haskell.stylishHaskellArguments",{scope:r}),cwd:e,stdin:t})}async function Ja(t){const[e,...r]=t.getCursors().map(t=>t.getBufferPosition()),n="source.cabal"===t.getGrammar().scopeName?Xa:Za,i=(await o.getRootDir(t.getBuffer())).getPath();try{const{stdout:o,stderr:s}=await n(t.getText(),i,t.getRootScopeDescriptor());t.setText(o);const a=t.getLastCursor();a&&a.setBufferPosition(e,{autoscroll:!1}),r.forEach(e=>{t.addCursorAtBufferPosition(e,{autoscroll:!1})}),s.length>0&&atom.notifications.addWarning("Prettifier reported the following problems:",{detail:s,dismissable:!0})}catch(t){const e=t.error||t;let r=t.stderr?t.stderr.trim():"";e.message.includes(r)&&(r=""),atom.notifications.addError("Failed to prettify",{detail:`${r?r+"\n\n":""}${e.message}`,stack:e.stack,dismissable:!0})}}class tc{constructor(t){this.editor=t,this.disposables=new e.CompositeDisposable,this.prettify=async()=>{if(atom.config.get("ide-haskell.onSavePrettify",{scope:this.editor.getRootScopeDescriptor()})){const t=this.editor.getGrammar().scopeName.replace(/\./g,"*");if(!atom.config.get("ide-haskell.onSavePrettifyFormats",{scope:this.editor.getRootScopeDescriptor()})[t])return;await Ja(this.editor)}};const r=this.editor.getBuffer();this.disposables.add(r.onWillSave(this.prettify))}static supportsGrammar(t){return["source.c2hs","source.cabal","source.hsc2hs","source.haskell","text.tex.latex.haskell","source.hsig"].includes(t)}destroy(){this.disposables.dispose()}}class ec{constructor(t){this.editor=t,this.editorElement=atom.views.getView(this.editor),this.editorElement.classList.add("ide-haskell")}static supportsGrammar(t){return["source.c2hs","source.cabal","source.hsc2hs","source.haskell","text.tex.latex.haskell","source.hsig"].includes(t)}destroy(){this.editorElement.classList.remove("ide-haskell")}}class rc{constructor(t){this.props=t,this.disposables=new e.CompositeDisposable,Ui(this),this.disposables.add(atom.tooltips.add(this.element,{class:"ide-haskell-status-tooltip",title:()=>{const t=[];for(const[e,{status:r,detail:n}]of this.props.statusMap.entries())t.push(`\n          <ide-haskell-status-item>\n            <ide-haskell-status-icon data-status="${r}">${e}</ide-haskell-status-icon>\n            <ide-haskell-status-detail>${n||""}</ide-haskell-status-detail>\n          </ide-haskell-status-item>\n          `);return t.join("")}}))}render(){return Bi("ide-haskell-status-icon",{dataset:{status:this.calcCurrentStatus()}})}async update(t){return this.props.statusMap=t.statusMap,zi(this)}async destroy(){await qi(this),this.props.statusMap.clear()}calcCurrentStatus(){const t={progress:50,error:20,warning:10,ready:0},e=Array.from(this.props.statusMap.values());if(0===e.length)return"ready";const[r]=e.sort((e,r)=>t[r.status]-t[e.status]);return r.status}}class nc{constructor(t){this.props=t,Ui(this)}render(){const t=this.aveProgress();return isNaN(t)?Bi("progress",{style:{display:"none"}}):Bi("progress",0===t?null:{value:t.toString(),max:"1"})}async update(t){return this.props.progress!==t.progress?(this.props.progress=t.progress,zi(this)):Promise.resolve()}async destroy(){await qi(this)}aveProgress(){return this.props.progress.reduce((t,e)=>t+e,0)/this.props.progress.length}}class ic{constructor(){this.statusMap=new Map,this.awaiters=new Map,this.emitter=new e.Emitter}getAwaiter(t){let e=this.awaiters.get(t);void 0===e&&(e=new Set,this.awaiters.set(t,e));const r=e;return async e=>{let n;try{n=Promise.resolve().then(e),r.add(n),this.updateStatus(t,{status:"progress",detail:""});const i=await n;return r.delete(n),0===r.size&&this.updateStatus(t,{status:"ready",detail:""}),i}catch(e){return n&&r.delete(n),this.updateStatus(t,{status:"warning",detail:""+e}),void console.warn(e)}}}forceBackendStatus(t,e){this.updateStatus(t,e)}onDidUpdate(t){return this.emitter.on("did-update",t)}renderStatusIcon(){return Bi(rc,{statusMap:this.statusMap})}renderProgressBar(){const t=Array.from(this.statusMap.values()).reduce((t,e)=>("progress"===e.status&&void 0!==e.progress&&t.push(e.progress),t),[]);return Bi(nc,{progress:t})}updateStatus(t,e){this.statusMap.set(t,e),this.emitter.emit("did-update",{pluginName:t,status:e})}}class oc{constructor(t,r){this.outputPanel=r,this.disposables=new e.CompositeDisposable,this.emitter=new e.Emitter,this.willSaveHandlers=new Set,this.controllers=new Map,this.backendStatusController=new ic,this.onWillSaveBuffer=t=>(this.willSaveHandlers.add(t),new e.Disposable(()=>this.willSaveHandlers.delete(t))),this.onDidSaveBuffer=t=>this.emitter.on("did-save-buffer",t),this.onDidStopChanging=t=>this.emitter.on("did-stop-changing",t),this.disposables.add(this.emitter),this.resultsDB=new Zn,this.outputPanel.connectResults(this.resultsDB),this.outputPanel.connectBsc(this.backendStatusController),this.tooltipRegistry=new Ho(this),this.configParamManager=new Uo(this.outputPanel,t.configParams),this.disposables.add(this.addEditorController(Vo),this.addEditorController(tc),this.addEditorController(ec)),"builtin"===atom.config.get("ide-haskell.messageDisplayFrontend")&&(this.checkResultsProvider=new Qo(this)),this.subscribeEditorController()}deactivate(){this.resultsDB.destroy(),this.disposables.dispose(),this.checkResultsProvider&&this.checkResultsProvider.destroy(),Kn(this.outputPanel.reallyDestroy()),this.configParamManager.destroy(),this.removeStatusBar(),this.linterSupport&&(this.linterSupport.destroy(),this.linterSupport=void 0)}serialize(){return{configParams:this.configParamManager.serialize()}}async willSaveBuffer(t){return Promise.all(Array.from(this.willSaveHandlers.values()).map(e=>e(t)))}didSaveBuffer(t){return this.emitter.emit("did-save-buffer",t)}didStopChanging(t){return this.emitter.emit("did-stop-changing",t)}togglePanel(){Kn(atom.workspace.toggle(this.outputPanel))}controller(t){return this.controllerType(Vo,t)}controllerType(t,e){const r=this.controllers.get(t),n=r?r.get(e):void 0;return n?n.controller:void 0}setLinter(t){"linter"===atom.config.get("ide-haskell.messageDisplayFrontend")&&(this.linterSupport=new Go(t,this.resultsDB))}nextError(){"builtin"===atom.config.get("ide-haskell.messageDisplayFrontend")&&this.outputPanel.showNextError()}prevError(){"builtin"===atom.config.get("ide-haskell.messageDisplayFrontend")&&this.outputPanel.showPrevError()}forceBackendStatus(t,e){this.backendStatusController.forceBackendStatus(t,e)}getAwaiter(t){return this.backendStatusController.getAwaiter(t)}addEditorController(t){if(this.controllers.has(t))throw new Error("Duplicate controller factory "+t.toString());const r=new WeakMap;return this.controllers.set(t,r),new e.Disposable(()=>{this.controllers.delete(t);for(const t of atom.workspace.getTextEditors()){const e=r.get(t);e&&e.disposable.dispose()}})}setStatusBar(t){this.statusBarView=new Ko(this.outputPanel,this.backendStatusController),this.statusBarTile=t.addRightTile({item:this.statusBarView.element,priority:100})}removeStatusBar(){this.statusBarTile&&(this.statusBarTile.destroy(),this.statusBarTile=void 0),this.statusBarView&&(this.statusBarView.destroy(),this.statusBarView=void 0)}controllerOnGrammar(t,r){for(const[n,i]of this.controllers.entries()){const o=i.get(t);if(!o&&n.supportsGrammar(r.scopeName)){const r=new n(t,this),o=new e.CompositeDisposable;o.add(new e.Disposable(()=>{i.delete(t),r.destroy()}),t.onDidDestroy(()=>o.dispose())),i.set(t,{controller:r,disposable:o})}else o&&!n.supportsGrammar(r.scopeName)&&o.disposable.dispose()}}subscribeEditorController(){this.disposables.add(atom.workspace.observeTextEditors(t=>{const r=new e.CompositeDisposable;r.add(t.onDidChangeGrammar(e=>{this.controllerOnGrammar(t,e)}),t.onDidDestroy(()=>{r.dispose(),this.disposables.remove(r)})),this.disposables.add(r),this.controllerOnGrammar(t,t.getGrammar())}))}}function sc(t,r,n){const{name:i,menu:o,messageTypes:s,events:a,controls:c,params:l,tooltip:u,commands:p}=r,h=new e.CompositeDisposable;let d;function f(t,r){if(Array.isArray(t)){const n=new e.CompositeDisposable;for(const e of t)n.add(r(g(e)));return n}return r(g(t))}const m=t.getAwaiter(i);function g(t){return function(...e){Kn(m(()=>t(...e)).then(async t=>{if(d&&void 0!==t)if(Array.isArray(t))d.setMessages(t);else{const e=[];for await(const r of t)e.push(r),d.setMessages(e)}}))}}if(o){const t=atom.menu.add([{label:"Haskell IDE",submenu:[{label:o.label,submenu:o.menu}]}]);h.add(t)}if(s){n.eventsReturnResults&&(d=t.resultsDB.registerProvider(Object.keys(s)));for(const r of Object.keys(s)){const n=s[r];Kn(t.outputPanel.createTab(r,n)),h.add(new e.Disposable((function(){Kn(t.outputPanel.removeTab(r))})))}}if(a&&(a.onWillSaveBuffer&&h.add(f(a.onWillSaveBuffer,t.onWillSaveBuffer)),a.onDidSaveBuffer&&h.add(f(a.onDidSaveBuffer,t.onDidSaveBuffer)),a.onDidStopChanging&&h.add(f(a.onDidStopChanging,t.onDidStopChanging))),u){let e,r,n;"function"==typeof u?e=u:({handler:e,priority:r,eventTypes:n}=u),void 0===r&&(r=100),h.add(t.tooltipRegistry.register(i,{priority:r,handler:e,eventTypes:n}))}if(c)for(const e of c)h.add(t.outputPanel.addPanelControl(e));if(l)for(const e of Object.keys(l)){const r=l[e];h.add(t.configParamManager.add(i,e,r))}if(n.supportsCommands&&p)for(const[t,e]of Object.entries(p))if(void 0!==e)for(const[r,n]of Object.entries(e))h.add(atom.commands.add(t,r,(function(t){g(n)(t.currentTarget)})));return h}var ac=e.CompositeDisposable;function cc(t,e,r){const n=e.name,i=new ac,o=t.resultsDB.registerProvider(void 0!==e.messageTypes?Object.keys(e.messageTypes):[]);return i.add(o),i.add(sc(t,e,r)),{setMenu(t,e){const r=atom.menu.add([{label:"Haskell IDE",submenu:[{label:t,submenu:e}]}]);return i.add(r),r},setStatus:e=>t.forceBackendStatus(n,e),setMessages(t){o.setMessages(t)},addMessageTab:async(e,r)=>t.outputPanel.createTab(e,r),showTooltip:async({editor:e,eventType:r,detail:i,tooltip:o})=>(void 0===r&&(r=Wn(i)),t.tooltipRegistry.showTooltip(e,r,{pluginName:n,tooltip:o})),addPanelControl:e=>t.outputPanel.addPanelControl(e),addConfigParam:(e,r)=>t.configParamManager.add(n,e,r),getConfigParam:async e=>t.configParamManager.get(n,e),getOthersConfigParam:async(e,r)=>t.configParamManager.get(e,r),setConfigParam:async(e,r)=>t.configParamManager.set(n,e,r),getEventRange(e,r){let n;var i;n="string"==typeof(i=r)&&R.includes(i)?r:Wn(r);const o=t.controller(e);if(o)return o.getEventRange(n)},dispose(){i.dispose()}}}class lc{constructor(t){this.props=t,Ui(this)}render(){return Bi("ide-haskell-button",{class:this.props.active?"active":"",dataset:{caption:this.props.name,count:this.props.count},on:{click:this.props.onClick}})}async update(t){return this.props=t,zi(this)}async destroy(){await qi(this)}}class uc{constructor(t){this.props=t,Ui(this)}render(){return Bi("ide-haskell-panel-buttons",null,Array.from(this.renderButtons()))}async update(t){return this.props=t,zi(this)}*renderButtons(){for(const t of this.props.buttons)yield Bi(lc,{active:t.name===this.props.activeBtn,name:t.name,count:t.count,onClick:t.onClick})}}class pc{constructor(t){this.props=t,this.tooltipTitle=()=>this.props.state?this.props.enabledHint:this.props.disabledHint,this.disposables=new e.CompositeDisposable,Ui(this),this.disposables.add(atom.tooltips.add(this.element,{title:this.tooltipTitle}))}render(){return Bi("ide-haskell-checkbox",{class:`${this.props.class}${this.props.state?" enabled":""}`,on:{click:this.props.onSwitched}})}async update(t={}){return this.props={...this.props,...t},zi(this)}async destroy(){await qi(this),this.disposables.dispose()}}class hc{constructor(t){this.props=t,this.clickPosition=()=>{void 0!==this.props.model.uri&&Kn(atom.workspace.open(this.props.model.uri,{searchAllPanes:!0,initialLine:this.props.model.position&&this.props.model.position.row,initialColumn:this.props.model.position&&this.props.model.position.column}))},Ui(this)}render(){return Bi("ide-haskell-panel-item",{key:this.props.model.hash()},this.renderPosition(),this.renderContext(),Bi("ide-haskell-item-description",{innerHTML:this.props.model.message.toHtml()}))}async update(t){return this.props.model=t.model,zi(this)}async destroy(){await qi(this)}renderPosition(){if(void 0!==this.props.model.uri){const t=this.props.model.position?`${this.props.model.uri}: ${this.props.model.position.row+1}, ${this.props.model.position.column+1}`:this.props.model.uri;return Bi("ide-haskell-item-position",{on:{click:this.clickPosition}},t)}return""}renderContext(){return void 0!==this.props.model.context?Bi("ide-haskell-item-context",null,this.props.model.context):""}}class dc{constructor(t){this.props=t,this.itemMap=new WeakMap,Ui(this)}render(){return Bi("ide-haskell-panel-items",{class:"native-key-bindings",tabIndex:"-1"},this.renderItems())}async update(t){return this.props=t,zi(this)}async destroy(){await qi(this)}async showItem(t){await zi(this);const e=this.itemMap.get(t);e&&(e.component.clickPosition(),e.domNode.scrollIntoView({block:"start",behavior:"smooth"}))}async scrollToEnd(){await zi(this),this.element.scrollTop=this.element.scrollHeight}atEnd(){return this.element.scrollTop>=this.element.scrollHeight-this.element.clientHeight}renderItems(){const t=this.props.filter?this.props.model.filter(this.props.filter):this.props.model.results();return Array.from(t).map(t=>{const e=Bi(hc,{model:t});return this.itemMap.set(t,e),e})}}class fc{constructor(t={fileFilter:!1,activeTab:"error"}){if(this.state=t,this.elements=new Set,this.disposables=new e.CompositeDisposable,this.tabs=new Map,this.tabUsers=new Map,this.currentResult=0,this.switchFileFilter=()=>{this.state.fileFilter=!this.state.fileFilter,Kn(this.updateItems())},this.setButtonsClass(atom.config.get("ide-haskell.buttonsPosition")),Ui(this),atom.config.onDidChange("ide-haskell.buttonsPosition",({newValue:t})=>{this.setButtonsClass(t),Kn(this.update())}),"builtin"===atom.config.get("ide-haskell.messageDisplayFrontend"))for(const t of fc.defaultTabs)this.tabs.set(t,{name:t,count:0,onClick:()=>this.activateTab(t),uriFilter:!0,autoScroll:!1});Kn(this.update()),this.disposables.add(atom.workspace.onDidChangeActivePaneItem(()=>{this.state.fileFilter&&Kn(this.updateItems())})),setImmediate(async()=>{await this.show(),atom.config.get("ide-haskell.autoHideOutput")&&this.hide()})}connectBsc(t){if(this.bsc)throw new Error("BackendStatusController already connected!");this.bsc=t,this.disposables.add(this.bsc.onDidUpdate(()=>Kn(this.update()))),Kn(this.update())}connectResults(t){if(this.results)throw new Error("Results already connected!");this.results=t;let e=Date.now(),r=new Set;this.disposables.add(this.results.onDidUpdate(t=>{this.currentResult=0,Kn(this.updateItems());const n=Date.now();if(n-e<atom.config.get("ide-haskell.switchTabOnCheckInterval"))for(const e of t)r.add(e);else r=new Set(t);!atom.config.get("ide-haskell.autoHideOutput")||this.results&&!this.results.isEmpty(t)?atom.config.get("ide-haskell.switchTabOnCheck")&&this.activateFirstNonEmptyTab(r):this.hide(),e=n})),Kn(this.update())}render(){var t,e;return this.results?Bi("ide-haskell-panel",{class:this.buttonsClass},Bi("ide-haskell-panel-heading",null,(null===(t=this.bsc)||void 0===t?void 0:t.renderStatusIcon())||null,Bi(uc,{buttons:Array.from(this.tabs.values()),activeBtn:this.state.activeTab}),Bi(pc,{class:"ide-haskell-checkbox--uri-filter",state:this.state.fileFilter||!1,onSwitched:this.switchFileFilter,enabledHint:"Show current file messages",disabledHint:"Show all project messages"}),Array.from(this.elements.values()),(null===(e=this.bsc)||void 0===e?void 0:e.renderProgressBar())||null),Bi(dc,{model:this.results,filter:this.itemFilter,ref:"items"})):Bi("ide-haskell-panel",null)}async update(){return zi(this)}destroy(){this.hide()}async reallyDestroy(){await qi(this),this.disposables.dispose()}async toggle(){const t=atom.workspace.paneContainerForItem(this);return!t||I(t)&&!t.isVisible()?this.show():this.hide()}async show(){await atom.workspace.open(this,{searchAllPanes:!0,activatePane:!1});const t=atom.workspace.paneContainerForItem(this);t&&I(t)&&t.show()}hide(){const t=atom.workspace.paneContainerForItem(this);t&&I(t)&&atom.workspace.hide(this)}getTitle(){return"IDE-Haskell"}getURI(){return"ide-haskell://output-panel/"}getDefaultLocation(){return atom.config.get("ide-haskell.panelPosition")}addPanelControl(t){let r;if(function(t){return"string"==typeof t.element}(t)){const{events:e,classes:n,style:i,attrs:o}=t.opts,s={};n&&(s.class=n.join(" ")),i&&(s.style=i),o&&(s.attributes=o),e&&(s.on=e),r=Bi(t.element,s)}else r=Bi(t.element,t.opts);return this.elements.add(r),Kn(this.update()),new e.Disposable(()=>{this.elements.delete(r),Kn(this.update())})}async updateItems(){const t=this.getActiveTab();let e;if(this.state.fileFilter){const t=atom.workspace.getActiveTextEditor();e=t?t.getPath():void 0}let r=!1;if(t){const n=this.tabs.get(t);void 0!==e&&n&&n.uriFilter?this.itemFilter=({uri:r,severity:n})=>n===t&&r===e:this.itemFilter=({severity:e})=>e===t,r=n&&n.autoScroll&&this.refs.items&&this.refs.items.atEnd()||!1}if(this.results)for(const[t,e]of this.tabs.entries())e.count=Array.from(this.results.filter(({severity:e})=>e===t)).length;await this.update(),r&&this.refs.items&&await this.refs.items.scrollToEnd()}activateTab(t){this.state.activeTab=t,Kn(this.updateItems())}activateFirstNonEmptyTab(t){for(const e of this.tabs.values()){if(!t.has(e.name))continue;const r=e.count;if(r&&r>0){Kn(this.show()),this.activateTab(e.name);break}}}showItem(t){this.activateTab(t.severity),this.refs.items&&Kn(this.refs.items.showItem(t))}getActiveTab(){return this.state.activeTab}async createTab(t,{uriFilter:e=!0,autoScroll:r=!1}){if(!fc.defaultTabs.includes(t))return this.tabs.has(t)?this.tabUsers.set(t,this.tabUsers.get(t)+1):(this.tabUsers.set(t,1),this.tabs.set(t,{name:t,count:0,onClick:()=>this.activateTab(t),uriFilter:e,autoScroll:r}),this.state.activeTab&&this.activateTab(this.state.activeTab)),this.update()}async removeTab(t){if(!fc.defaultTabs.includes(t)){if(!this.tabUsers.has(t))throw new Error("Ide-Haskell: Removing nonexistent output panel tab "+t);{let e=this.tabUsers.get(t);if(e-=1,0===e)return this.tabUsers.delete(t),this.tabs.delete(t),this.state.activeTab===t&&(this.state.activeTab=fc.defaultTabs[0]),this.update();this.tabUsers.set(t,e)}}}serialize(){return{...this.state,deserializer:"ide-haskell/OutputPanel"}}showNextError(){if(!this.results)return;const t=Array.from(this.results.filter(({uri:t})=>void 0!==t));0!==t.length&&(this.currentResult++,this.currentResult>=t.length&&(this.currentResult=0),this.showItem(t[this.currentResult]))}showPrevError(){if(!this.results)return;const t=Array.from(this.results.filter(({uri:t})=>void 0!==t));0!==t.length&&(this.currentResult--,this.currentResult<0&&(this.currentResult=t.length-1),this.showItem(t[this.currentResult]))}setButtonsClass(t){switch(t){case"top":this.buttonsClass="buttons-top";break;case"left":this.buttonsClass="buttons-left"}}}fc.defaultTabs=["error","warning","lint"];var mc=e.CompositeDisposable,gc=e.Disposable;let vc,yc,bc,wc,kc=!1;function _c(t){return bc||(bc=new fc(t)),bc}function xc(t={}){return function(){return kc=!0,e=>{if(!yc)throw new Error("IDE-Haskell failed to provide UPI instance: pluginManager is undefined");return cc(yc,e,t)}}}const Sc=xc(),Ec=xc({eventsReturnResults:!0}),Oc=xc({eventsReturnResults:!0,supportsCommands:!0});function Pc(t={}){return function(e){if(kc=!0,yc)return sc(yc,e,t)}}const Mc=Pc({}),Ac=Pc({eventsReturnResults:!0}),jc=Pc({eventsReturnResults:!0,supportsCommands:!0});exports.activate=function(t){atom.views.getView(atom.workspace).classList.add("ide-haskell"),require("etch").setScheduler(atom.views),kc=!1,atom.config.get("ide-haskell.startupMessageIdeBackend")&&setTimeout(()=>{kc||atom.notifications.addWarning("Ide-Haskell needs backends that provide most of functionality.\n            Please refer to README for details",{dismissable:!0})},5e3),vc=new mc,yc=new oc(t,_c()),vc.add(atom.commands.add("atom-workspace",{"ide-haskell:toggle-output":()=>{yc&&yc.togglePanel()},"ide-haskell:next-error":()=>{yc&&yc.nextError()},"ide-haskell:prev-error":()=>{yc&&yc.prevError()}}),atom.commands.add("atom-text-editor.ide-haskell",{"ide-haskell:prettify-file":({currentTarget:t})=>{Kn(Ja(t.getModel()))}}),atom.commands.add("atom-text-editor.ide-haskell--has-tooltips",{"ide-haskell:close-tooltip":({currentTarget:t,abortKeyBinding:e})=>{const r=yc&&yc.controller(t.getModel());r&&r.tooltips.has()?r.tooltips.hide():e()}})),wc=new mc,wc.add(atom.menu.add([{label:"Haskell IDE",submenu:[{label:"Prettify",command:"ide-haskell:prettify-file"},{label:"Toggle Panel",command:"ide-haskell:toggle-output"}]}]))},exports.consumeLinter=function(t){if(!vc||!yc)return;const e=t({name:"IDE-Haskell"});return vc.add(e),yc.setLinter(e),e},exports.consumeStatusBar=function(t){if(yc)return yc.setStatusBar(t),new gc(()=>{yc&&yc.removeStatusBar()})},exports.consumeUpi3_0=Mc,exports.consumeUpi3_1=Ac,exports.consumeUpi3_2=jc,exports.deactivate=function(){yc&&yc.deactivate(),vc&&vc.dispose(),wc&&wc.dispose(),atom.menu.update(),vc=void 0,yc=void 0,wc=void 0,bc=void 0},exports.deserializeOutputPanel=_c,exports.provideUpi3_0=Sc,exports.provideUpi3_1=Ec,exports.provideUpi3_2=Oc,exports.serialize=function(){if(yc)return yc.serialize()};
//# sourceMappingURL=main.js.map
